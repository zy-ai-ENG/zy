
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{_ as e}from"../index/index.c9f6880f.js";import{A as a}from"../mj/mj.482967bc.js";import{d as l,r as t,G as s,C as r,y as o,j as i,U as d,o as u,c as p,f as n,g as c,h as m,w as f,e as g,J as y,b as _,t as h,au as w,V as b,W as v,O as V,P as U,$ as C,ae as P,p as k,k as x,q as j,s as q}from"../main-646ffc07.js";import{useUploader as z}from"../use/useUploader.89b089eb.js";const R=e=>(k("data-v-679db4e8"),e=e(),x(),e),F={class:"overflow-y-scroll w-full whitespace-nowrap"},L=R((()=>_("div",{style:{width:"250px"}}," 关闭当前提示词、用户端将不再展示！ ",-1))),O=R((()=>_("div",{style:{width:"250px"}}," 携带左侧参数将会对提示词的参数复写、不携带则以自定义提示词中的指令参数为准！ ",-1))),A={class:"flex justify-end mr-5"},G=l({__name:"prompts",setup(l){t(),t(0);const k=t(!1),x=t(!1),j=t(),q=t(0),R=s({isCarryParams:!0,status:!0,title:"",order:100,prompt:"",imageUrl:"",aspect:"16:9"}),G=t([{aspect:"1:1"},{aspect:"4:3"},{aspect:"3:4"},{aspect:"16:9"},{aspect:"9:16"}]),I=s({isCarryParams:[{required:!0,message:"请选择你是否需要携带参数",trigger:"change"}],status:[{required:!0,message:"请选择提示词开启状态",trigger:"change"}],title:[{required:!0,message:"请填写您的提示词信息",trigger:"blur"}],order:[{required:!0,message:"请填写您的排序id 越大越靠前",trigger:"blur"}],prompt:[{required:!0,message:"请填写提示词详细内容",trigger:"change"}],imageUrl:[{required:!0,message:"请输入图片URL或上传文件",trigger:"change"}],aspect:[{required:!0,message:"请选择图片比例",trigger:"change"}]});const D=t(!1),J=r((()=>q.value?"更新提示词":"新增提示词")),M=r((()=>q.value?"确认更新":"确认新增")),Q=t([]);async function W(){try{k.value=!0;const e=await a.queryPrompts();k.value=!1,Q.value=e.data}catch(e){k.value=!1}}const{selectFile:$,upload:B}=z(),E=async()=>{const e=await $(),a=await B({file:e}).then((e=>e.data));R.imageUrl=a,U({type:"success",message:"上传图片成功！"})};return o((()=>{W()})),(l,t)=>{const s=i("el-alert"),r=i("Plus"),o=i("el-icon"),z=i("el-button"),$=e,B=i("el-table-column"),H=i("el-image"),K=i("el-tag"),N=i("el-popconfirm"),S=i("el-table"),T=i("el-switch"),X=i("QuestionFilled"),Y=i("el-tooltip"),Z=i("el-form-item"),ee=i("el-input"),ae=i("el-option"),le=i("el-select"),te=i("el-form"),se=i("el-dialog"),re=d("loading");return u(),p("div",null,[n($,{class:"header",bottomPadding:"20px"},{default:c((()=>[n(s,{"show-icon":"",title:"Ai智能封面说明",closable:!1,description:"此处的封面图将会在用户端的展示出来、用户点击你给与的预设可以一键绘制！",type:"success"}),n(z,{type:"success",class:"ml-3",size:"large",onClick:t[0]||(t[0]=e=>D.value=!0)},{default:c((()=>[m(" 添加预设 "),n(o,{class:"ml-3"},{default:c((()=>[n(r)])),_:1})])),_:1})])),_:1}),n($,{bottomPadding:"20px",bottomMargin:"0px"},{default:c((()=>[f((u(),y(S,{border:"",data:g(Q),height:"69vh",style:{width:"100%"},size:"large"},{default:c((()=>[n(B,{prop:"title",label:"提示词名称",width:"180"}),n(B,{prop:"aspect",label:"图片比例",width:"180"}),n(B,{prop:"imageUrl",label:"图片",width:"180"},{default:c((e=>[n(H,{src:e.row.imageUrl,lazy:""},null,8,["src"])])),_:1}),n(B,{prop:"prompt",label:"提示词内容"},{default:c((e=>[_("div",F,h(e.row.prompt),1)])),_:1}),n(B,{prop:"status",align:"center",label:"提示词状态",width:"110"},{default:c((e=>[n(K,{type:e.row.status?"success":"danger"},{default:c((()=>[m(h(e.row.status?"开启中":"已关闭"),1)])),_:2},1032,["type"])])),_:1}),n(B,{prop:"isCarryParams",align:"center",label:"携带用户的参数",width:"150"},{default:c((e=>[n(K,{type:e.row.isCarryParams?"success":"warning"},{default:c((()=>[m(h(e.row.isCarryParams?"携带":"不携带"),1)])),_:2},1032,["type"])])),_:1}),n(B,{prop:"order",align:"center",label:"排序ID",width:"90"}),n(B,{fixed:"right",label:"操作",align:"center",width:"180"},{default:c((e=>[n(z,{link:"",type:"primary",size:"small",onClick:a=>function(e){q.value=e.id;const{status:a,title:l,prompt:t,order:s,imageUrl:r,isCarryParams:o,aspect:i}=e;C((()=>{Object.assign(R,{status:a,title:l,prompt:t,imageUrl:r,order:s,isCarryParams:o,aspect:i})})),D.value=!0}(e.row)},{default:c((()=>[m(" 变更 ")])),_:2},1032,["onClick"]),n(N,{title:"确认删除此提示词么?",width:"180","icon-color":"red",onConfirm:l=>async function(e){const{id:l}=e;await a.delPrompt({id:l}),U({type:"success",message:"操作完成！"}),W()}(e.row)},{reference:c((()=>[n(z,{link:"",type:"danger",size:"small"},{default:c((()=>[m(" 删除 ")])),_:1})])),_:2},1032,["onConfirm"])])),_:1})])),_:1},8,["data"])),[[re,g(k)]])])),_:1}),n(se,{modelValue:g(D),"onUpdate:modelValue":t[10]||(t[10]=e=>V(D)?D.value=e:null),"close-on-click-modal":!1,title:J.value,width:"770",onClose:t[11]||(t[11]=e=>{return a=g(j),q.value=0,void(null==a||a.resetFields());var a})},{footer:c((()=>[_("span",A,[n(z,{onClick:t[8]||(t[8]=e=>D.value=!1)},{default:c((()=>[m("取消")])),_:1}),n(z,{type:"primary",onClick:t[9]||(t[9]=e=>async function(e){null==e||e.validate((async e=>{if(e){const e=P(R);delete e.id,q.value&&(e.id=q.value),await a.setPrompt(e),U({type:"success",message:"操作成功！"}),q.value=0,D.value=!1,W()}}))}(g(j)))},{default:c((()=>[m(h(M.value),1)])),_:1})])])),default:c((()=>[f((u(),y(te,{ref_key:"formPackageRef",ref:j,"label-position":"right","label-width":"120px",model:R,rules:I},{default:c((()=>[n(Z,{label:"启用状态",prop:"status"},{default:c((()=>[n(T,{modelValue:R.status,"onUpdate:modelValue":t[1]||(t[1]=e=>R.status=e)},null,8,["modelValue"]),n(Y,{class:"box-item",effect:"dark",placement:"right"},{content:c((()=>[L])),default:c((()=>[n(o,{class:"ml-3 cursor-pointer"},{default:c((()=>[n(X)])),_:1})])),_:1})])),_:1}),n(Z,{label:"携带左侧参数",prop:"isCarryParams"},{default:c((()=>[n(T,{modelValue:R.isCarryParams,"onUpdate:modelValue":t[2]||(t[2]=e=>R.isCarryParams=e)},null,8,["modelValue"]),n(Y,{class:"box-item",effect:"dark",placement:"right"},{content:c((()=>[O])),default:c((()=>[n(o,{class:"ml-3 cursor-pointer"},{default:c((()=>[n(X)])),_:1})])),_:1})])),_:1}),n(Z,{label:"排序Order",prop:"order"},{default:c((()=>[n(ee,{modelValue:R.order,"onUpdate:modelValue":t[3]||(t[3]=e=>R.order=e),placeholder:"排序id越大越靠前"},null,8,["modelValue"])])),_:1}),n(Z,{label:"提示词名称",prop:"title"},{default:c((()=>[n(ee,{modelValue:R.title,"onUpdate:modelValue":t[4]||(t[4]=e=>R.title=e),placeholder:"请填写提示词名称（用户看到的名称）"},null,8,["modelValue"])])),_:1}),n(Z,{label:"图片URL",prop:"imageUrl"},{default:c((()=>[n(ee,{modelValue:R.imageUrl,"onUpdate:modelValue":t[5]||(t[5]=e=>R.imageUrl=e),placeholder:"请填写在线图片URL或上传本地图片"},{append:c((()=>[n(z,{icon:g(w),onClick:E},{default:c((()=>[m("上传图片")])),_:1},8,["icon"])])),_:1},8,["modelValue"])])),_:1}),n(Z,{label:"图片比例",prop:"aspect"},{default:c((()=>[n(le,{modelValue:R.aspect,"onUpdate:modelValue":t[6]||(t[6]=e=>R.aspect=e),placeholder:"请选择图片比例",style:{width:"100%"}},{default:c((()=>[(u(!0),p(b,null,v(g(G),(e=>(u(),y(ae,{key:e.aspect,label:e.aspect,value:e.aspect},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),n(Z,{label:"提示词内容",prop:"proxyUrl"},{default:c((()=>[n(ee,{type:"textarea",rows:4,modelValue:R.prompt,"onUpdate:modelValue":t[7]||(t[7]=e=>R.prompt=e),placeholder:"请填写提示词详细内容！"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])),[[re,g(x)]])])),_:1},8,["modelValue","title"])])}}});"function"==typeof q&&q(G);const I=j(G,[["__scopeId","data-v-679db4e8"]]);export{I as default};
