
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{_ as e}from"../index/index.c9f6880f.js";import a from"../components/mjManger.d2e6c705.js";import l from"../components/mjDetail.ee67cc67.js";import{A as t,U as n,k as o}from"../index/index.5ad1a92e.js";import{av as r,aw as i,ax as s,d,r as u,ay as m,G as p,y as c,j as _,U as f,o as y,c as b,f as g,g as h,V as Y,W as w,e as M,h as v,b as k,w as j,J as x,t as z,P as D,s as C}from"../main-646ffc07.js";import{A as L}from"../mj/mj.482967bc.js";!function(e){function a(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var l=a(e),t={name:"zh-cn",weekdays:"星期日_星期一_星期二_星期三_星期四_星期五_星期六".split("_"),weekdaysShort:"周日_周一_周二_周三_周四_周五_周六".split("_"),weekdaysMin:"日_一_二_三_四_五_六".split("_"),months:"一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),ordinal:function(e,a){return"W"===a?e+"周":e+"日"},weekStart:1,yearStart:4,formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYY年M月D日",LLL:"YYYY年M月D日Ah点mm分",LLLL:"YYYY年M月D日ddddAh点mm分",l:"YYYY/M/D",ll:"YYYY年M月D日",lll:"YYYY年M月D日 HH:mm",llll:"YYYY年M月D日dddd HH:mm"},relativeTime:{future:"%s内",past:"%s前",s:"几秒",m:"1 分钟",mm:"%d 分钟",h:"1 小时",hh:"%d 小时",d:"1 天",dd:"%d 天",M:"1 个月",MM:"%d 个月",y:"1 年",yy:"%d 年"},meridiem:function(e,a){var l=100*e+a;return l<600?"凌晨":l<900?"早上":l<1100?"上午":l<1300?"中午":l<1800?"下午":"晚上"}};l.default.locale(t,null,!0)}(r),s.locale("zh-cn");const I=e=>s(e).format("YYYY-MM-DD HH:mm:ss"),P={style:{float:"right"}},H=d({__name:"index",setup(r){const i=u(),s=u(),d=u(!1),C=u([]),H=u(0),V=m(o),S=m(t),A=p({account:"",channelId:"",enable:0,page:1,size:20}),U=u(),J=async()=>{try{d.value=!0;const e=await L.queryMjParamByPage(A),{rows:a,count:l}=e.data;d.value=!1,H.value=l,C.value=a.map((e=>({infoLoading:!1,...e})))}catch(e){d.value=!1}},R=async()=>{s.value.open()};return c((()=>{J()})),(o,r)=>{const u=_("el-input"),m=_("el-form-item"),p=_("el-option"),c=_("el-select"),T=_("el-button"),G=_("Plus"),W=_("el-icon"),q=_("el-form"),B=e,E=_("el-alert"),F=_("el-table-column"),O=_("el-tag"),$=_("el-popconfirm"),K=_("el-table"),N=_("el-pagination"),Q=_("el-row"),X=f("loading");return y(),b("div",null,[g(a,{ref_key:"mjManagerRef",ref:s,onFresh:J},null,512),g(l,{ref_key:"mjDetailRef",ref:i},null,512),g(B,null,{default:h((()=>[g(q,{ref_key:"formRef",ref:U,inline:!0,model:A},{default:h((()=>[g(m,{label:"账号名",prop:"account"},{default:h((()=>[g(u,{modelValue:A.account,"onUpdate:modelValue":r[0]||(r[0]=e=>A.account=e),width:"100%",placeholder:"账号名[模糊搜索]",clearable:""},null,8,["modelValue"])])),_:1}),g(m,{label:"通道ID(channelId)",prop:"channelId"},{default:h((()=>[g(u,{modelValue:A.channelId,"onUpdate:modelValue":r[1]||(r[1]=e=>A.channelId=e),placeholder:"频道ID[模糊搜索]",clearable:""},null,8,["modelValue"])])),_:1}),g(m,{label:"状态",prop:"enable",style:{width:"192px"}},{default:h((()=>[g(c,{modelValue:A.enable,"onUpdate:modelValue":r[2]||(r[2]=e=>A.enable=e)},{default:h((()=>[(y(!0),b(Y,null,w(M(t),(e=>(y(),x(p,{label:e.label,value:e.value},null,8,["label","value"])))),256))])),_:1},8,["modelValue"])])),_:1}),g(m,null,{default:h((()=>[g(T,{type:"primary",onClick:J},{default:h((()=>[v(" 查询 ")])),_:1}),g(T,{onClick:r[3]||(r[3]=e=>(U.value,Object.assign(A,{account:"",channelId:"",enable:0,page:1,size:20}),void J()))},{default:h((()=>[v(" 重置 ")])),_:1})])),_:1}),k("span",P,[g(T,{type:"success",onClick:R},{default:h((()=>[v(" 添加MJ账号 "),g(W,{class:"ml-3"},{default:h((()=>[g(G)])),_:1})])),_:1})])])),_:1},8,["model"])])),_:1}),g(B,{bottomPadding:"20px"},{default:h((()=>[g(E,{closable:!1,"show-icon":"",title:"MJ账号管理",description:"详细配置请参考说明文档，添加MJ账号参数！",type:"success"})])),_:1}),g(B,{bottomPadding:"20px",bottomMargin:"0px"},{default:h((()=>[j((y(),x(K,{border:"",data:C.value,height:"53vh",width:"100%",size:"large"},{default:h((()=>[g(F,{prop:"guildId",label:"服务器ID"}),g(F,{prop:"channelId",label:"频道ID"}),g(F,{prop:"account",label:"账户"}),g(F,{prop:"mode",label:"出图模式"},{default:h((({row:e})=>[g(O,{type:M(n)[e.mode]},{default:h((()=>[v(z(M(V)[e.mode]),1)])),_:2},1032,["type"])])),_:1}),g(F,{prop:"fastRemainTime",label:"快速时间剩余"}),g(F,{prop:"orderPlan",label:"订阅计划"},{default:h((e=>{return[v(z((a=e.row.orderPlan,1===a?"基本":2===a?"标准":3===a?"专业":"强大")),1)];var a})),_:1}),g(F,{prop:"enable",label:"状态"},{default:h((({row:e})=>[g(O,{type:M(n)[e.enable]},{default:h((()=>[v(z(M(S)[e.enable]),1)])),_:2},1032,["type"])])),_:1}),g(F,{prop:"createdAt",label:"创建时间"},{default:h((({row:e})=>[k("p",null,z(M(I)(e.createdAt)),1)])),_:1}),g(F,{fixed:"right",label:"操作",width:"280",align:"center"},{default:h((e=>[g(T,{link:"",type:"primary",size:"small",onClick:a=>(e=>{const{id:a}=e;i.value.open(a)})(e.row)},{default:h((()=>[v(" 详情 ")])),_:2},1032,["onClick"]),g(T,{link:"",type:"primary",size:"small",onClick:a=>(async e=>{s.value.open(e.id)})(e.row)},{default:h((()=>[v(" 更新并重连 ")])),_:2},1032,["onClick"]),g($,{width:"300px",title:"为了避免封号，程序每天同步一次，确认手动同步？","confirm-button-text":"确认",onConfirm:a=>(async e=>{e.infoLoading=!0,await L.updateMjSync({id:e.id}),D.success("同步MJ账号成功！"),e.infoLoading=!1,await J()})(e.row)},{reference:h((()=>[g(T,{link:"",type:"danger",loading:e.row.infoLoading,size:"small"},{default:h((()=>[v(" 同步 ")])),_:2},1032,["loading"])])),_:2},1032,["onConfirm"]),g(T,{link:"",type:"primary",size:"small",onClick:a=>(async e=>{const a={id:e.id,enable:1===e.enable?2:1};(await L.setMjParamEnable(a)).success&&D({type:"success",message:`账户${1===e.enable?"停用":"启用"}成功！`}),await J()})(e.row)},{default:h((()=>[v(z(1===e.row.enable?"停用":"启用"),1)])),_:2},1032,["onClick"]),g($,{width:"300px",title:"删除后不可找回，确定删除?","confirm-button-text":"确认",onConfirm:a=>(async e=>{await L.removeMjParam({id:e.id}),D.success("删除MJ账号成功！"),await J()})(e.row)},{reference:h((()=>[g(T,{link:"",type:"danger",size:"small"},{default:h((()=>[v(" 删除 ")])),_:1})])),_:2},1032,["onConfirm"])])),_:1})])),_:1},8,["data"])),[[X,d.value]]),g(Q,{class:"flex justify-end mt-5 pb-5"},{default:h((()=>[g(N,{"current-page":A.page,"onUpdate:currentPage":r[4]||(r[4]=e=>A.page=e),"page-size":A.size,"onUpdate:pageSize":r[5]||(r[5]=e=>A.size=e),class:"mr-5","page-sizes":[15,30,50,100],layout:"total, sizes, prev, pager, next, jumper",total:H.value,onSizeChange:J,onCurrentChange:J},null,8,["current-page","page-size","total"])])),_:1})])),_:1})])}}});"function"==typeof C&&C(H);export{H as default};
