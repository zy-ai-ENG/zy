
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{_ as e}from"../index/index.35ca4747.js";import{A as a}from"../mj/mj.7fbe74d8.js";import{d as l,r as t,Q as s,B as r,x as o,h as i,R as d,o as u,c as p,e as n,f as c,l as m,w as f,b as g,I as y,a as _,t as h,au as w,S as b,U as v,W as U,E as V,Z as C,ad as P,p as x,i as k,n as q,q as j}from"../main-78588ec5.js";import{useUploader as z}from"../use/useUploader.6d014fda.js";const R=e=>(x("data-v-679db4e8"),e=e(),k(),e),F={class:"overflow-y-scroll w-full whitespace-nowrap"},I=R((()=>_("div",{style:{width:"250px"}}," 关闭当前提示词、用户端将不再展示！ ",-1))),L=R((()=>_("div",{style:{width:"250px"}}," 携带左侧参数将会对提示词的参数复写、不携带则以自定义提示词中的指令参数为准！ ",-1))),A={class:"flex justify-end mr-5"},O=l({__name:"prompts",setup(l){t(),t(0);const x=t(!1),k=t(!1),q=t(),j=t(0),R=s({isCarryParams:!0,status:!0,title:"",order:100,prompt:"",imageUrl:"",aspect:"16:9"}),O=t([{aspect:"1:1"},{aspect:"4:3"},{aspect:"3:4"},{aspect:"16:9"},{aspect:"9:16"}]),Q=s({isCarryParams:[{required:!0,message:"请选择你是否需要携带参数",trigger:"change"}],status:[{required:!0,message:"请选择提示词开启状态",trigger:"change"}],title:[{required:!0,message:"请填写您的提示词信息",trigger:"blur"}],order:[{required:!0,message:"请填写您的排序id 越大越靠前",trigger:"blur"}],prompt:[{required:!0,message:"请填写提示词详细内容",trigger:"change"}],imageUrl:[{required:!0,message:"请输入图片URL或上传文件",trigger:"change"}],aspect:[{required:!0,message:"请选择图片比例",trigger:"change"}]});const B=t(!1),D=r((()=>j.value?"更新提示词":"新增提示词")),E=r((()=>j.value?"确认更新":"确认新增")),G=t([]);async function M(){try{x.value=!0;const e=await a.queryPrompts();x.value=!1,G.value=e.data}catch(e){x.value=!1}}const{selectFile:S,upload:W}=z(),Z=async()=>{const e=await S(),a=await W({file:e}).then((e=>e.data));R.imageUrl=a,V({type:"success",message:"上传图片成功！"})};return o((()=>{M()})),(l,t)=>{const s=i("el-alert"),r=i("Plus"),o=i("el-icon"),z=i("el-button"),S=e,W=i("el-table-column"),H=i("el-image"),J=i("el-tag"),K=i("el-popconfirm"),N=i("el-table"),T=i("el-switch"),X=i("QuestionFilled"),Y=i("el-tooltip"),$=i("el-form-item"),ee=i("el-input"),ae=i("el-option"),le=i("el-select"),te=i("el-form"),se=i("el-dialog"),re=d("loading");return u(),p("div",null,[n(S,{class:"header",bottomPadding:"20px"},{default:c((()=>[n(s,{"show-icon":"",title:"Ai智能封面说明",closable:!1,description:"此处的封面图将会在用户端的展示出来、用户点击你给与的预设可以一键绘制！",type:"success"}),n(z,{type:"success",class:"ml-3",size:"large",onClick:t[0]||(t[0]=e=>B.value=!0)},{default:c((()=>[m(" 添加预设 "),n(o,{class:"ml-3"},{default:c((()=>[n(r)])),_:1})])),_:1})])),_:1}),n(S,{bottomPadding:"20px",bottomMargin:"0px"},{default:c((()=>[f((u(),y(N,{border:"",data:g(G),height:"69vh",style:{width:"100%"},size:"large"},{default:c((()=>[n(W,{prop:"title",label:"提示词名称",width:"180"}),n(W,{prop:"aspect",label:"图片比例",width:"180"}),n(W,{prop:"imageUrl",label:"图片",width:"180"},{default:c((e=>[n(H,{src:e.row.imageUrl,lazy:""},null,8,["src"])])),_:1}),n(W,{prop:"prompt",label:"提示词内容"},{default:c((e=>[_("div",F,h(e.row.prompt),1)])),_:1}),n(W,{prop:"status",align:"center",label:"提示词状态",width:"110"},{default:c((e=>[n(J,{type:e.row.status?"success":"danger"},{default:c((()=>[m(h(e.row.status?"开启中":"已关闭"),1)])),_:2},1032,["type"])])),_:1}),n(W,{prop:"isCarryParams",align:"center",label:"携带用户的参数",width:"150"},{default:c((e=>[n(J,{type:e.row.isCarryParams?"success":"warning"},{default:c((()=>[m(h(e.row.isCarryParams?"携带":"不携带"),1)])),_:2},1032,["type"])])),_:1}),n(W,{prop:"order",align:"center",label:"排序ID",width:"90"}),n(W,{fixed:"right",label:"操作",align:"center",width:"180"},{default:c((e=>[n(z,{link:"",type:"primary",size:"small",onClick:a=>function(e){j.value=e.id;const{status:a,title:l,prompt:t,order:s,imageUrl:r,isCarryParams:o,aspect:i}=e;C((()=>{Object.assign(R,{status:a,title:l,prompt:t,imageUrl:r,order:s,isCarryParams:o,aspect:i})})),B.value=!0}(e.row)},{default:c((()=>[m(" 变更 ")])),_:2},1032,["onClick"]),n(K,{title:"确认删除此提示词么?",width:"180","icon-color":"red",onConfirm:l=>async function(e){const{id:l}=e;await a.delPrompt({id:l}),V({type:"success",message:"操作完成！"}),M()}(e.row)},{reference:c((()=>[n(z,{link:"",type:"danger",size:"small"},{default:c((()=>[m(" 删除 ")])),_:1})])),_:2},1032,["onConfirm"])])),_:1})])),_:1},8,["data"])),[[re,g(x)]])])),_:1}),n(se,{modelValue:g(B),"onUpdate:modelValue":t[10]||(t[10]=e=>U(B)?B.value=e:null),"close-on-click-modal":!1,title:D.value,width:"770",onClose:t[11]||(t[11]=e=>{return a=g(q),j.value=0,void(null==a||a.resetFields());var a})},{footer:c((()=>[_("span",A,[n(z,{onClick:t[8]||(t[8]=e=>B.value=!1)},{default:c((()=>[m("取消")])),_:1}),n(z,{type:"primary",onClick:t[9]||(t[9]=e=>async function(e){null==e||e.validate((async e=>{if(e){const e=P(R);delete e.id,j.value&&(e.id=j.value),await a.setPrompt(e),V({type:"success",message:"操作成功！"}),j.value=0,B.value=!1,M()}}))}(g(q)))},{default:c((()=>[m(h(E.value),1)])),_:1})])])),default:c((()=>[f((u(),y(te,{ref_key:"formPackageRef",ref:q,"label-position":"right","label-width":"120px",model:R,rules:Q},{default:c((()=>[n($,{label:"启用状态",prop:"status"},{default:c((()=>[n(T,{modelValue:R.status,"onUpdate:modelValue":t[1]||(t[1]=e=>R.status=e)},null,8,["modelValue"]),n(Y,{class:"box-item",effect:"dark",placement:"right"},{content:c((()=>[I])),default:c((()=>[n(o,{class:"ml-3 cursor-pointer"},{default:c((()=>[n(X)])),_:1})])),_:1})])),_:1}),n($,{label:"携带左侧参数",prop:"isCarryParams"},{default:c((()=>[n(T,{modelValue:R.isCarryParams,"onUpdate:modelValue":t[2]||(t[2]=e=>R.isCarryParams=e)},null,8,["modelValue"]),n(Y,{class:"box-item",effect:"dark",placement:"right"},{content:c((()=>[L])),default:c((()=>[n(o,{class:"ml-3 cursor-pointer"},{default:c((()=>[n(X)])),_:1})])),_:1})])),_:1}),n($,{label:"排序Order",prop:"order"},{default:c((()=>[n(ee,{modelValue:R.order,"onUpdate:modelValue":t[3]||(t[3]=e=>R.order=e),placeholder:"排序id越大越靠前"},null,8,["modelValue"])])),_:1}),n($,{label:"提示词名称",prop:"title"},{default:c((()=>[n(ee,{modelValue:R.title,"onUpdate:modelValue":t[4]||(t[4]=e=>R.title=e),placeholder:"请填写提示词名称（用户看到的名称）"},null,8,["modelValue"])])),_:1}),n($,{label:"图片URL",prop:"imageUrl"},{default:c((()=>[n(ee,{modelValue:R.imageUrl,"onUpdate:modelValue":t[5]||(t[5]=e=>R.imageUrl=e),placeholder:"请填写在线图片URL或上传本地图片"},{append:c((()=>[n(z,{icon:g(w),onClick:Z},{default:c((()=>[m("上传图片")])),_:1},8,["icon"])])),_:1},8,["modelValue"])])),_:1}),n($,{label:"图片比例",prop:"aspect"},{default:c((()=>[n(le,{modelValue:R.aspect,"onUpdate:modelValue":t[6]||(t[6]=e=>R.aspect=e),placeholder:"请选择图片比例",style:{width:"100%"}},{default:c((()=>[(u(!0),p(b,null,v(g(O),(e=>(u(),y(ae,{key:e.aspect,label:e.aspect,value:e.aspect},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),n($,{label:"提示词内容",prop:"proxyUrl"},{default:c((()=>[n(ee,{type:"textarea",rows:4,modelValue:R.prompt,"onUpdate:modelValue":t[7]||(t[7]=e=>R.prompt=e),placeholder:"请填写提示词详细内容！"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])),[[re,g(k)]])])),_:1},8,["modelValue","title"])])}}});"function"==typeof j&&j(O);const Q=q(O,[["__scopeId","data-v-679db4e8"]]);export{Q as default};
