
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{_ as e}from"../index/index.c9f6880f.js";import a from"../components/mjIncantation.bc7e0e00.js";import l from"../components/mjDetail.ee67cc67.js";import{A as t}from"../mj/mj.482967bc.js";import{u as o}from"../utcformatTime/utcformatTime.f6db2c52.js";import{d as n,r as s,G as i,y as r,j as p,U as u,o as d,c,f as m,g as f,V as y,W as g,h as w,b as _,w as b,J as v,t as h,e as j,P as k,q as x,s as z}from"../main-646ffc07.js";import"../system/system.a11a12d4.js";const C={style:{float:"right"}},M={key:1},V=n({__name:"incantation",setup(n){const x=s(),z=s(),V=s(!1),A=s([]),I=s(0),U=i({page:1,size:20,keyword:"",pid:""}),P=s(),q=async()=>{try{V.value=!0;const e=await t.queryMjIncantation(U),{rows:a,count:l}=e.data;V.value=!1,I.value=l,A.value=a.map((e=>{const a=D.get(e.pid);return e.type="text"===a.type?"普通":"style"===a.type?"风格":"",e.category=a.classifyName,e}))}catch(e){V.value=!1}},J=async()=>{z.value.open()},R=s([]),D=new Map;return r((async()=>{await(async()=>{const e=await t.queryAllMjIncantClassify({level:2}).then((e=>e.data));R.value=e,e.length&&e.forEach((e=>{D.set(e.id,e)}))})(),q()})),(n,s)=>{const i=p("el-input"),r=p("el-form-item"),D=p("el-option"),E=p("el-select"),G=p("el-button"),N=p("Plus"),S=p("el-icon"),T=p("el-form"),F=e,O=p("el-image"),W=p("el-table-column"),B=p("el-popconfirm"),H=p("el-table"),K=p("el-pagination"),L=p("el-row"),Q=u("loading");return d(),c("div",null,[m(a,{ref_key:"mjManagerRef",ref:z,list:R.value,onFresh:q},null,8,["list"]),m(l,{ref_key:"mjDetailRef",ref:x},null,512),m(F,null,{default:f((()=>[m(T,{ref_key:"formRef",ref:P,inline:!0,model:U},{default:f((()=>[m(r,{label:"关键字",prop:"keyword"},{default:f((()=>[m(i,{modelValue:U.keyword,"onUpdate:modelValue":s[0]||(s[0]=e=>U.keyword=e),style:{width:"192px"},placeholder:"分类关键字[模糊搜索]",clearable:""},null,8,["modelValue"])])),_:1}),m(r,{label:"所属分类",prop:"pid"},{default:f((()=>[m(E,{modelValue:U.pid,"onUpdate:modelValue":s[1]||(s[1]=e=>U.pid=e),style:{width:"192px"}},{default:f((()=>[(d(!0),c(y,null,g(R.value,(e=>(d(),v(D,{key:e.id,value:e.id,label:e.classifyName},null,8,["value","label"])))),128))])),_:1},8,["modelValue"])])),_:1}),m(r,null,{default:f((()=>[m(G,{type:"primary",onClick:q},{default:f((()=>[w(" 查询 ")])),_:1}),m(G,{onClick:s[2]||(s[2]=e=>(P.value,Object.assign(U,{keyword:"",pid:"",page:1,size:20}),void q()))},{default:f((()=>[w(" 重置 ")])),_:1})])),_:1}),_("span",C,[m(G,{type:"success",class:"ml-3",onClick:J},{default:f((()=>[w(" 添加咒语 "),m(S,{class:"ml-3"},{default:f((()=>[m(N)])),_:1})])),_:1})])])),_:1},8,["model"])])),_:1}),m(F,{bottomPadding:"20px",bottomMargin:"0px"},{default:f((()=>[b((d(),v(H,{border:"",data:A.value,height:"64vh",width:"100%",size:"large"},{default:f((()=>[m(W,{prop:"img",label:"图片"},{default:f((e=>[e.row.img?(d(),v(O,{key:0,style:{width:"100px",height:"100px"},src:e.row.img,fit:"fill"},null,8,["src"])):(d(),c("span",M,"--"))])),_:1}),m(W,{prop:"incantationCn",label:"名称"}),m(W,{prop:"incantationEn",label:"英文翻译"}),m(W,{prop:"type",label:"类型"}),m(W,{prop:"category",label:"分类"}),m(W,{prop:"createdAt",label:"创建时间"},{default:f((e=>[_("p",null,h(j(o)(e.row.createdAt)),1)])),_:1}),m(W,{prop:"updatedAt",label:"更新时间"},{default:f((e=>[_("p",null,h(j(o)(e.row.updatedAt)),1)])),_:1}),m(W,{fixed:"right",label:"操作",width:"280",align:"center"},{default:f((e=>[m(G,{link:"",type:"primary",size:"small",onClick:a=>(async e=>{z.value.open(e.id)})(e.row)},{default:f((()=>[w(" 编辑 ")])),_:2},1032,["onClick"]),m(B,{width:"300px",title:"删除后不可找回，确定删除?","confirm-button-text":"确认",onConfirm:a=>(async e=>{await t.removeMjIncantation({id:e.id}),k.success("删除MJ账号成功！"),await q()})(e.row)},{reference:f((()=>[m(G,{link:"",type:"danger",size:"small"},{default:f((()=>[w(" 删除 ")])),_:1})])),_:2},1032,["onConfirm"])])),_:1})])),_:1},8,["data"])),[[Q,V.value]]),m(L,{class:"flex justify-end mt-5 pb-5"},{default:f((()=>[m(K,{"current-page":U.page,"onUpdate:currentPage":s[3]||(s[3]=e=>U.page=e),"page-size":U.size,"onUpdate:pageSize":s[4]||(s[4]=e=>U.size=e),class:"mr-5","page-sizes":[15,30,50,100],layout:"total, sizes, prev, pager, next, jumper",total:I.value,onSizeChange:q,onCurrentChange:q},null,8,["current-page","page-size","total"])])),_:1})])),_:1})])}}});"function"==typeof z&&z(V);const A=x(V,[["__scopeId","data-v-121674a2"]]);export{A as default};
