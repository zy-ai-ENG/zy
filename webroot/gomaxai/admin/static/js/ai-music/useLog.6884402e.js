
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{_ as e}from"../index/index.c9f6880f.js";import{d as a,r as l,G as t,y as o,j as r,U as s,o as n,c as d,f as p,g as i,V as u,W as m,e as c,m as f,n as w,h as g,w as h,J as _,t as b,b as v,S as y,q as k,s as z}from"../main-646ffc07.js";import{m as T}from"../marked.esm/marked.esm.b7e5160c.js";import{A as x}from"../chat/chat.97153b6c.js";import{u as j}from"../utcformatTime/utcformatTime.f6db2c52.js";const A={class:"answer"},V=["innerHTML"],C=a({__name:"useLog",setup(a){const k=new T.Renderer;T.setOptions({renderer:k,gfm:!0,pedantic:!1,sanitize:!1});const z=l(!1),C=l([]),I=l(),U=l(0),M=t({userId:"",prompt:"",page:1,size:10,modelType:"music"}),L=l([]);async function Y(){z.value=!0;try{const e=await x.queryChatAll(M);z.value=!1;const{rows:a,count:l}=e.data;U.value=l,L.value=a}catch(e){z.value=!1}}async function q(e){const a=await y.queryAllUser({size:30,username:e});C.value=a.data.rows}return o((()=>{Y()})),(a,l)=>{const t=r("el-option"),o=r("el-select"),y=r("el-form-item"),k=r("el-input"),x=r("el-button"),K=r("el-form"),S=e,D=r("el-table-column"),G=r("el-popover"),H=r("el-table"),J=r("el-pagination"),P=r("el-row"),R=s("loading");return n(),d("div",null,[p(S,null,{default:i((()=>[p(K,{ref_key:"formRef",ref:I,inline:!0,model:M},{default:i((()=>[p(y,{label:"用户名称",prop:"userId"},{default:i((()=>[p(o,{modelValue:M.userId,"onUpdate:modelValue":l[0]||(l[0]=e=>M.userId=e),filterable:"",clearable:"",remote:"","reserve-keyword":"",placeholder:"用户姓名[模糊搜索]","remote-show-suffix":"","remote-method":q,style:{width:"192px"}},{default:i((()=>[(n(!0),d(u,null,m(c(C),(e=>(n(),_(t,{key:e.id,label:e.username,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),p(y,{label:"用户询问的问题",prop:"prompt"},{default:i((()=>[p(k,{modelValue:M.prompt,"onUpdate:modelValue":l[1]||(l[1]=e=>M.prompt=e),placeholder:"提问问题[模糊搜索]",onKeydown:f(w(Y,["prevent"]),["enter"])},null,8,["modelValue","onKeydown"])])),_:1}),p(y,null,{default:i((()=>[p(x,{type:"primary",onClick:Y},{default:i((()=>[g(" 查询 ")])),_:1}),p(x,{onClick:l[2]||(l[2]=e=>{return null==(a=c(I))||a.resetFields(),void Y();var a})},{default:i((()=>[g(" 重置 ")])),_:1})])),_:1})])),_:1},8,["model"])])),_:1}),p(S,{bottomPadding:"20px",bottomMargin:"0px"},{default:i((()=>[h((n(),_(H,{height:"66vh",border:"",data:c(L),style:{width:"100%"},size:"large","tooltip-options":{}},{default:i((()=>[p(D,{fixed:"",prop:"username",label:"用户名称",width:"150"}),p(D,{prop:"createdAt",label:"角色",width:"80"},{default:i((e=>[g(b("user"===e.row.role?"用户":"电脑"),1)])),_:1}),p(D,{prop:"email",label:"用户邮箱",width:"200"}),p(D,{prop:"answer",label:"用户询问/AI回复"},{default:i((e=>[p(G,{placement:"top",width:400,trigger:"click"},{reference:i((()=>[v("div",A,b("user"===e.row.role?e.row.prompt:e.row.answer),1)])),default:i((()=>[v("div",{class:"answer_container",innerHTML:c(T)("user"===e.row.role?e.row.prompt:e.row.answer||"")},null,8,V)])),_:2},1024)])),_:1}),p(D,{prop:"completionTokens",label:"提问/回答Token",width:"140",align:"center"},{default:i((e=>[g(b("user"===e.row.role?e.row.promptTokens:e.row.completionTokens),1)])),_:1}),p(D,{prop:"totalTokens",label:"总计Toekn",width:"110",align:"center"}),p(D,{prop:"model",label:"模型",width:"200"}),p(D,{prop:"createdAt",label:"提问时间",width:"200"},{default:i((e=>[g(b(c(j)(e.row.createdAt,"YYYY-MM-DD hh:mm:ss")),1)])),_:1})])),_:1},8,["data"])),[[R,c(z)]]),p(P,{class:"flex justify-end mt-5"},{default:i((()=>[p(J,{"current-page":M.page,"onUpdate:currentPage":l[3]||(l[3]=e=>M.page=e),"page-size":M.size,"onUpdate:pageSize":l[4]||(l[4]=e=>M.size=e),class:"mr-5","page-sizes":[10,20,30,50],layout:"total, sizes, prev, pager, next, jumper",total:c(U),onSizeChange:Y,onCurrentChange:Y},null,8,["current-page","page-size","total"])])),_:1})])),_:1})])}}});"function"==typeof z&&z(C);const I=k(C,[["__scopeId","data-v-b23d8731"]]);export{I as default};
