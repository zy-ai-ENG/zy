
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{_ as a}from"../index/index.3ad5ed39.js";import{a as e}from"../config/config.4e576922.js";import{d as l,Q as p,r as t,x as y,h as u,o as r,c as d,e as o,f as n,a as s,l as i,S as c,U as f,E as m,t as M,q as g}from"../main-01383ffb.js";const b={class:"flex justify-between"},_=s("b",null,"码支付参数设置",-1),x=l({__name:"mpay",setup(l){const g=p({payMpayStatus:"",payMpayPid:"",payMpaySecret:"",payMpayNotifyUrl:"",payMpayReturnUrl:"",payMpayApiPayUrl:"",payMpayRedirect:"",payMpayChannel:[]}),x=t({payMpayStatus:[{required:!0,trigger:"change",message:"请选择当前支付开启状态"}],payMpaySecret:[{required:!0,trigger:"blur",message:"请填写支付秘钥"}],payMpayPid:[{required:!0,trigger:"blur",message:"请填写商户PID"}],payMpayNotifyUrl:[{required:!0,trigger:"blur",message:"请填写支付通知地址"}],payMpayApiPayUrl:[{required:!0,trigger:"blur",message:"请填写平台支付API请求地址"}]}),h=t(),U=[{label:"微信支付",value:"wxpay"},{label:"支付宝支付",value:"alipay"}];async function V(){const a=await e.queryConfig({keys:["payMpaySecret","payMpayNotifyUrl","payMpayReturnUrl","payMpayPid","payMpayStatus","payMpayApiPayUrl","payMpayRedirect","payMpayChannel"]}),l=a.data.payMpayChannel?JSON.parse(a.data.payMpayChannel):[];Object.assign(g,a.data,{payMpayChannel:l})}function P(){var a;null==(a=h.value)||a.validate((async a=>{if(a){try{await e.setConfig({settings:(l=g,Object.keys(l).map((a=>({configKey:a,configVal:v(a,l[a])}))))}),m.success("变更配置信息成功")}catch(p){}V()}else m.error("请填写完整信息");var l}))}function v(a,e){return["payMpayChannel"].includes(a)?e?e?JSON.stringify(e):void 0:[]:e}return y((()=>{V()})),(e,l)=>{const p=u("el-alert"),t=a,y=u("el-button"),m=u("el-switch"),V=u("el-form-item"),v=u("el-col"),S=u("el-row"),C=u("el-input"),w=u("el-divider"),k=u("el-checkbox"),q=u("el-checkbox-group"),A=u("el-form"),N=u("el-card");return r(),d("div",null,[o(t,{bottomPadding:"20px"},{default:n((()=>[o(p,{closable:!1,"show-icon":"",title:"码支付参数说明",description:"码支付只能支持跳转登录、可同时开通多渠道、同时开启多种支付方式的情况优先级参照支付菜单排序、同时只能使用一种平台、所有的支付通知地址统一为 https://域名/api/pay/notify 将域名修改为您的域名即可！",type:"success"})])),_:1}),o(N,{style:{margin:"20px"}},{header:n((()=>[s("div",b,[_,o(y,{class:"button",onClick:P},{default:n((()=>[i(" 保存设置 ")])),_:1})])])),default:n((()=>[o(A,{ref_key:"formRef",ref:h,rules:x.value,model:g,"label-width":"120px"},{default:n((()=>[o(S,null,{default:n((()=>[o(v,{xs:24,md:20,lg:15,xl:12},{default:n((()=>[o(V,{label:"启用当前支付",prop:"payMpayPid"},{default:n((()=>[o(m,{modelValue:g.payMpayStatus,"onUpdate:modelValue":l[0]||(l[0]=a=>g.payMpayStatus=a),"active-value":"1","inactive-value":"0"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),o(S,null,{default:n((()=>[o(v,{xs:24,md:20,lg:15,xl:12},{default:n((()=>[o(V,{label:"商户PID",prop:"payMpayPid"},{default:n((()=>[o(C,{modelValue:g.payMpayPid,"onUpdate:modelValue":l[1]||(l[1]=a=>g.payMpayPid=a),placeholder:"请填写商户PID",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),o(S,null,{default:n((()=>[o(v,{xs:24,md:20,lg:15,xl:12},{default:n((()=>[o(V,{label:"商户秘钥",prop:"payMpaySecret"},{default:n((()=>[o(C,{modelValue:g.payMpaySecret,"onUpdate:modelValue":l[2]||(l[2]=a=>g.payMpaySecret=a),placeholder:"请填写商户秘钥",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),o(S,null,{default:n((()=>[o(v,{xs:24,md:20,lg:15,xl:12},{default:n((()=>[o(V,{label:"支付通知地址",prop:"payMpaySecret"},{default:n((()=>[o(C,{modelValue:g.payMpayNotifyUrl,"onUpdate:modelValue":l[3]||(l[3]=a=>g.payMpayNotifyUrl=a),placeholder:"请填写支付通知地址",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),o(S,null,{default:n((()=>[o(v,{xs:24,md:20,lg:15,xl:12},{default:n((()=>[o(V,{label:"支付回调地址",prop:"payMpaySecret"},{default:n((()=>[o(C,{modelValue:g.payMpayReturnUrl,"onUpdate:modelValue":l[4]||(l[4]=a=>g.payMpayReturnUrl=a),placeholder:"请填写支付成功后的回跳地址",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),o(w),o(S,null,{default:n((()=>[o(v,{xs:24,md:20,lg:15,xl:12},{default:n((()=>[o(V,{label:"支付请求地址",prop:"payMpayApiPayUrl"},{default:n((()=>[o(C,{modelValue:g.payMpayApiPayUrl,"onUpdate:modelValue":l[5]||(l[5]=a=>g.payMpayApiPayUrl=a),placeholder:"请填写平台支付请求地址",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),o(w),o(S,null,{default:n((()=>[o(v,{xs:24,md:24,lg:24,xl:24},{default:n((()=>[o(V,{label:"开启支付渠道",prop:"payMpayChannel"},{default:n((()=>[o(q,{modelValue:g.payMpayChannel,"onUpdate:modelValue":l[6]||(l[6]=a=>g.payMpayChannel=a),size:"small"},{default:n((()=>[(r(),d(c,null,f(U,(a=>o(k,{key:a.value,border:"",label:a.value},{default:n((()=>[i(M(a.label),1)])),_:2},1032,["label"]))),64))])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1},8,["rules","model"])])),_:1})])}}});"function"==typeof g&&g(x);export{x as default};
