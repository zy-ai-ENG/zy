
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{A as e}from"../mj/mj.34922543.js";import{d as l,r as a,Q as s,B as t,h as i,o as d,I as o,f as n,e as u,l as r,b as c,a as m,c as p,U as f,S as v,J as y,W as h,E as g,n as b}from"../main-0579ff80.js";const w={style:{height:"auto","overflow-y":"auto","overflow-x":"hidden"}},_=b(l({__name:"mjIncantationClassify",props:{list:{type:Array,required:!0,default:()=>[]}},emits:["fresh"],setup(l,{expose:b,emit:_}){const V=a(!1),j=a(""),x=a(0),N=a();a(!1);const C=s({classifyName:"",level:2,pid:void 0}),I=l,k=t((()=>I.list.filter((e=>1===e.level)))),U=_,q=s({name:[{required:!0,message:"咒语分类名称不能为空",trigger:"change"},{max:10,message:"最大长度10"}],level:[{required:!0,message:"咒语分类级别",trigger:"change"}],pid:[{required:!0,message:"父级必选",trigger:"change"}]});const M=async e=>{await(null==e?void 0:e.validate((async e=>{e&&(x.value?await z({id:x.value,...C}):await O(C),U("fresh",!0),V.value=!1,Object.assign(C,{}))})))},O=async l=>(await e.addMjIncantClassify(l),g.success("添加咒语分类成功！"),!0),A=async l=>await e.getMjIncantClassify(l).then((e=>e.data)),z=async l=>{await e.modifyMjIncantClassify(l),g.success("更新咒语分类成功！")};return b({open:function(e){V.value=!0,x.value=e||0,j.value=e?"编辑咒语分类":"添加咒语分类",e&&e>0?A({id:e}).then((e=>{const{classifyName:l,level:a,pid:s}=e;Object.assign(C,{classifyName:l,level:a,pid:s})})):Object.assign(C,{classifyName:"",level:2,pid:void 0})}}),(e,l)=>{const a=i("el-input"),s=i("el-form-item"),t=i("el-option"),g=i("el-select"),b=i("el-form"),_=i("el-button"),x=i("el-dialog");return d(),o(x,{modelValue:c(V),"onUpdate:modelValue":l[5]||(l[5]=e=>h(V)?V.value=e:null),"append-to-body":!0,"close-on-click-modal":!1,title:c(j),top:"80px",fullscreen:!1,width:"500px","z-index":2e3},{footer:n((()=>[u(_,{onClick:l[3]||(l[3]=e=>V.value=!1)},{default:n((()=>[r(" 取消 ")])),_:1}),u(_,{type:"primary",onClick:l[4]||(l[4]=e=>M(c(N)))},{default:n((()=>[r(" 确认 ")])),_:1})])),default:n((()=>[m("div",w,[u(b,{model:C,"label-position":"right",ref_key:"formRef",ref:N,rules:q,inline:!1,"label-width":"80px"},{default:n((()=>[u(s,{label:"分类名称",prop:"classifyName"},{default:n((()=>[u(a,{modelValue:C.classifyName,"onUpdate:modelValue":l[0]||(l[0]=e=>C.classifyName=e),placeholder:"输入分类名称",clearable:"",maxlength:"50"},null,8,["modelValue"])])),_:1}),u(s,{label:"分类级别",prop:"level"},{default:n((()=>[u(g,{modelValue:C.level,"onUpdate:modelValue":l[1]||(l[1]=e=>C.level=e),placeholder:"选择分类级别","fit-input-width":"",style:{width:"100%"}},{default:n((()=>[u(t,{value:1,label:"一级"}),u(t,{value:2,label:"二级"})])),_:1},8,["modelValue"])])),_:1}),2===C.level?(d(),o(s,{key:0,label:"父级",prop:"pid"},{default:n((()=>[u(g,{modelValue:C.pid,"onUpdate:modelValue":l[2]||(l[2]=e=>C.pid=e),placeholder:"选择分类级别","fit-input-width":"",style:{width:"100%"}},{default:n((()=>[(d(!0),p(v,null,f(c(k),(e=>(d(),o(t,{value:e.id,label:e.classifyName},null,8,["value","label"])))),256))])),_:1},8,["modelValue"])])),_:1})):y("",!0)])),_:1},8,["model","rules"])])])),_:1},8,["modelValue","title"])}}}),[["__scopeId","data-v-525ce095"]]);export{_ as default};
