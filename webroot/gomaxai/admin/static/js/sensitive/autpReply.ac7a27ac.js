
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{_ as e}from"../index/index.c9f6880f.js";import{Y as a,d as l,G as t,r as o,C as s,y as r,j as u,U as n,o as d,c as p,f as i,g as m,m as c,n as f,V as g,W as w,e as y,h as _,w as v,J as b,t as h,b as V,O as x,P as C,$ as k,s as z}from"../main-646ffc07.js";import{u as U}from"../utcformatTime/utcformatTime.f6db2c52.js";import{f as Y,Q as j}from"../index/index.5ad1a92e.js";const A=e=>a.get("autoreply/query",{params:e}),M=e=>a.post("autoreply/del",e),P=e=>a.post("autoreply/add",e),q=e=>a.post("autoreply/update",e),D={class:"dialog-footer"},R=l({__name:"autpReply",setup(a){const l=t({prompt:"",status:void 0,page:1,size:10}),z=o(!1),R=o(!1),F=o(0),G=o(0),J=o(),K=o(),O=t({status:0,prompt:"",answer:""}),S=t({status:[{required:!0,message:"请选择套餐类型",trigger:"change"}],prompt:[{required:!0,message:"请填写预设问题",trigger:"blur"}],answer:[{required:!0,message:"请填写回复答案",trigger:"blur"}]}),T=o([]);async function I(){try{R.value=!0;const e=await A(l),{rows:a,count:t}=e.data;R.value=!1,G.value=t,T.value=a}catch(e){R.value=!1}}const Q=s((()=>0!==F.value));return r((()=>{I()})),(a,t)=>{const o=u("el-alert"),s=e,r=u("el-input"),A=u("el-form-item"),W=u("el-option"),$=u("el-select"),B=u("el-button"),E=u("Plus"),H=u("el-icon"),L=u("el-form"),N=u("el-table-column"),X=u("el-tag"),Z=u("el-popconfirm"),ee=u("el-table"),ae=u("el-pagination"),le=u("el-row"),te=u("el-switch"),oe=u("el-dialog"),se=n("loading");return d(),p("div",null,[i(s,{bottomPadding:"20px"},{default:m((()=>[i(o,{closable:!1,"show-icon":"",title:"自定义回复说明",description:"当前可设置自定义回复、且可以多种关键词触发回复相同内容、可以开启精准匹配或模糊匹配用户设置自定义回复程度。",type:"success"})])),_:1}),i(s,null,{default:m((()=>[i(L,{ref_key:"formRef",ref:J,inline:!0,model:l},{default:m((()=>[i(A,{label:"自定义问题",prop:"prompt"},{default:m((()=>[i(r,{modelValue:l.prompt,"onUpdate:modelValue":t[0]||(t[0]=e=>l.prompt=e),placeholder:"自定义问题[模糊搜索]",onKeydown:c(f(I,["prevent"]),["enter"])},null,8,["modelValue","onKeydown"])])),_:1}),i(A,{label:"问题启用状态",prop:"status"},{default:m((()=>[i($,{modelValue:l.status,"onUpdate:modelValue":t[1]||(t[1]=e=>l.status=e),placeholder:"请选择问题启用状态",clearable:"",style:{width:"192px"}},{default:m((()=>[(d(!0),p(g,null,w(y(Y),(e=>(d(),b(W,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),i(A,null,{default:m((()=>[i(B,{type:"primary",onClick:I},{default:m((()=>[_(" 查询 ")])),_:1}),i(B,{onClick:t[2]||(t[2]=e=>{return null==(a=y(J))||a.resetFields(),void I();var a})},{default:m((()=>[_(" 重置 ")])),_:1})])),_:1}),i(B,{type:"success",style:{float:"right"},onClick:t[3]||(t[3]=e=>z.value=!0)},{default:m((()=>[_(" 添加新的自动回复 "),i(H,{class:"ml-3"},{default:m((()=>[i(E)])),_:1})])),_:1})])),_:1},8,["model"])])),_:1}),i(s,{bottomPadding:"20px",bottomMargin:"0px"},{default:m((()=>[v((d(),b(ee,{border:"",data:y(T),height:"54vh",style:{width:"100%"},size:"large"},{default:m((()=>[i(N,{prop:"prompt",label:"提问关键词"}),i(N,{prop:"answer",label:"回复答案"}),i(N,{prop:"status",label:"问题状态",width:"120"},{default:m((e=>[i(X,{type:1===e.row.status?"success":"daner"},{default:m((()=>[_(h(y(j)[e.row.status]),1)])),_:2},1032,["type"])])),_:1}),i(N,{prop:"createdAt",label:"创建时间",width:"200"},{default:m((e=>[_(h(y(U)(e.row.createdAt,"YYYY-MM-DD hh:mm:ss")),1)])),_:1}),i(N,{prop:"updatedAt",label:"最后修改时间",width:"200"},{default:m((e=>[_(h(y(U)(e.row.createdAt,"YYYY-MM-DD hh:mm:ss")),1)])),_:1}),i(N,{fixed:"right",label:"操作",width:"200"},{default:m((e=>[i(B,{link:"",type:"primary",size:"small",onClick:a=>function(e){F.value=e.id;const{status:a,prompt:l,answer:t}=e;z.value=!0,k((()=>{Object.assign(O,{status:a,prompt:l,answer:t})}))}(e.row)},{default:m((()=>[_(" 编辑 ")])),_:2},1032,["onClick"]),i(Z,{"confirm-button-text":"确认删除","cancel-button-text":"放弃",type:"danger",width:"230px","icon-color":"red",title:"确定删除本条自动回复问题么？",onConfirm:a=>async function(e){await M({id:e}),C.success("删除自定义问题成功"),await I()}(e.row.id)},{reference:m((()=>[i(B,{link:"",type:"danger",size:"small"},{default:m((()=>[_(" 删除 ")])),_:1})])),_:2},1032,["onConfirm"])])),_:1})])),_:1},8,["data"])),[[se,y(R)]]),i(le,{class:"flex justify-end mt-5"},{default:m((()=>[i(ae,{"current-page":l.page,"onUpdate:currentPage":t[4]||(t[4]=e=>l.page=e),"page-size":l.size,"onUpdate:pageSize":t[5]||(t[5]=e=>l.size=e),class:"mr-5","page-sizes":[10,20,30,50],layout:"total, sizes, prev, pager, next, jumper",total:y(G),onSizeChange:I,onCurrentChange:I},null,8,["current-page","page-size","total"])])),_:1})])),_:1}),i(oe,{modelValue:y(z),"onUpdate:modelValue":t[11]||(t[11]=e=>x(z)?z.value=e:null),title:(y(Q)?"编辑":"添加")+"自动回复问题",width:"480",onClose:t[12]||(t[12]=e=>{return null==(a=y(K))||a.resetFields(),void(F.value=0);var a})},{footer:m((()=>[V("span",D,[i(B,{onClick:t[9]||(t[9]=e=>z.value=!1)},{default:m((()=>[_("放弃生成")])),_:1}),i(B,{type:"primary",onClick:t[10]||(t[10]=e=>async function(e){null==e||e.validate((async e=>{if(!e)return C.warning("请按规则填写所有信息！");0===F.value?(await P(O),C.success("添加自定义问题成功")):(await q({id:F.value,...O}),C.success("更新自定义问题成功")),z.value=!1,I()}))}(y(K)))},{default:m((()=>[_(h((y(Q)?"更新":"新增")+"回复 "),1)])),_:1})])])),default:m((()=>[i(L,{ref_key:"formAutoReplyRef",ref:K,"label-position":"right","label-width":"80px",model:O,rules:S},{default:m((()=>[i(A,{label:"开启状态",prop:"status"},{default:m((()=>[i(te,{modelValue:O.status,"onUpdate:modelValue":t[6]||(t[6]=e=>O.status=e),"active-value":1,"inactive-value":0},null,8,["modelValue"])])),_:1}),i(A,{label:"提问问题",prop:"prompt"},{default:m((()=>[i(r,{modelValue:O.prompt,"onUpdate:modelValue":t[7]||(t[7]=e=>O.prompt=e),type:"textarea",rows:5,placeholder:"请填写预设提问问题"},null,8,["modelValue"])])),_:1}),i(A,{label:"回复问题",prop:"answer"},{default:m((()=>[i(r,{modelValue:O.answer,"onUpdate:modelValue":t[8]||(t[8]=e=>O.answer=e),type:"textarea",rows:5,placeholder:"请填写预设回复答案"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"])])}}});"function"==typeof z&&z(R);export{R as default};
