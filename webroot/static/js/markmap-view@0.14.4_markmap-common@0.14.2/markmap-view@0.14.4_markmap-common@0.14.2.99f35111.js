import{g as t,a as e,w as n,b as r,c as i,n as a,H as o}from"../markmap-common@0.14.2/markmap-common@0.14.2.bb7f57a5.js";import"../d3-transition@2.0.0_d3-selection@2.0.0/d3-transition@2.0.0_d3-selection@2.0.0.1a6d61d6.js";import{z as s,t as l,i as h}from"../d3-zoom@2.0.0/d3-zoom@2.0.0.36d7f337.js";import{o as c}from"../d3-scale@3.3.0/d3-scale@3.3.0.ebdf832d.js";import{m as d,a as u,b as p}from"../d3-array@2.12.1/d3-array@2.12.1.53235631.js";import{c as f}from"../d3-scale-chromatic@2.0.0/d3-scale-chromatic@2.0.0.97916aae.js";import{s as m}from"../d3-selection@2.0.0/d3-selection@2.0.0.eaad748b.js";import{l as g}from"../d3-shape@2.1.0/d3-shape@2.1.0.34187db3.js";
/*! markmap-view v0.14.4 | MIT License */function y(){return y=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},y.apply(this,arguments)}function x(t){var e=0,n=t.children,r=n&&n.length;if(r)for(;--r>=0;)e+=n[r].value;else e=1;t.value=e}function v(t,e){var n,r,i,a,o,s=new k(t),l=+t.value&&(s.value=t.value),h=[s];for(null==e&&(e=z);n=h.pop();)if(l&&(n.value=+n.data.value),(i=e(n.data))&&(o=i.length))for(n.children=new Array(o),a=o-1;a>=0;--a)h.push(r=n.children[a]=new k(i[a])),r.parent=n,r.depth=n.depth+1;return s.eachBefore(S)}function z(t){return t.children}function b(t){t.data=t.data.data}function S(t){var e=0;do{t.height=e}while((t=t.parent)&&t.height<++e)}function k(t){this.data=t,this.depth=this.height=0,this.parent=null}k.prototype=v.prototype={constructor:k,count:function(){return this.eachAfter(x)},each:function(t){var e,n,r,i,a=this,o=[a];do{for(e=o.reverse(),o=[];a=e.pop();)if(t(a),n=a.children)for(r=0,i=n.length;r<i;++r)o.push(n[r])}while(o.length);return this},eachAfter:function(t){for(var e,n,r,i=this,a=[i],o=[];i=a.pop();)if(o.push(i),e=i.children)for(n=0,r=e.length;n<r;++n)a.push(e[n]);for(;i=o.pop();)t(i);return this},eachBefore:function(t){for(var e,n,r=this,i=[r];r=i.pop();)if(t(r),e=r.children)for(n=e.length-1;n>=0;--n)i.push(e[n]);return this},sum:function(t){return this.eachAfter((function(e){for(var n=+t(e.data)||0,r=e.children,i=r&&r.length;--i>=0;)n+=r[i].value;e.value=n}))},sort:function(t){return this.eachBefore((function(e){e.children&&e.children.sort(t)}))},path:function(t){for(var e=this,n=function(t,e){if(t===e)return t;var n=t.ancestors(),r=e.ancestors(),i=null;t=n.pop(),e=r.pop();for(;t===e;)i=t,t=n.pop(),e=r.pop();return i}(e,t),r=[e];e!==n;)e=e.parent,r.push(e);for(var i=r.length;t!==n;)r.splice(i,0,t),t=t.parent;return r},ancestors:function(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e},descendants:function(){var t=[];return this.each((function(e){t.push(e)})),t},leaves:function(){var t=[];return this.eachBefore((function(e){e.children||t.push(e)})),t},links:function(){var t=this,e=[];return t.each((function(n){n!==t&&e.push({source:n.parent,target:n})})),e},copy:function(){return v(this).eachBefore(b)}};var w={name:"d3-flextree",version:"2.1.2",main:"build/d3-flextree.js",module:"index","jsnext:main":"index",author:{name:"Chris Maloney",url:"http://chrismaloney.org"},description:"Flexible tree layout algorithm that allows for variable node sizes.",keywords:["d3","d3-module","layout","tree","hierarchy","d3-hierarchy","plugin","d3-plugin","infovis","visualization","2d"],homepage:"https://github.com/klortho/d3-flextree",license:"WTFPL",repository:{type:"git",url:"https://github.com/klortho/d3-flextree.git"},scripts:{clean:"rm -rf build demo test","build:demo":"rollup -c --environment BUILD:demo","build:dev":"rollup -c --environment BUILD:dev","build:prod":"rollup -c --environment BUILD:prod","build:test":"rollup -c --environment BUILD:test",build:"rollup -c",lint:"eslint index.js src","test:main":"node test/bundle.js","test:browser":"node test/browser-tests.js",test:"npm-run-all test:*",prepare:"npm-run-all clean build lint test"},dependencies:{"d3-hierarchy":"^1.1.5"},devDependencies:{"babel-plugin-external-helpers":"^6.22.0","babel-preset-es2015-rollup":"^3.0.0",d3:"^4.13.0","d3-selection-multi":"^1.0.1",eslint:"^4.19.1",jsdom:"^11.6.2","npm-run-all":"^4.1.2",rollup:"^0.55.3","rollup-plugin-babel":"^2.7.1","rollup-plugin-commonjs":"^8.0.2","rollup-plugin-copy":"^0.2.3","rollup-plugin-json":"^2.3.0","rollup-plugin-node-resolve":"^3.0.2","rollup-plugin-uglify":"^3.0.0","uglify-es":"^3.3.9"}};const{version:E}=w,j=Object.freeze({children:t=>t.children,nodeSize:t=>t.data.size,spacing:0});function X(t){const e=Object.assign({},j,t);function n(t){const n=e[t];return"function"==typeof n?n:()=>n}function r(t){const e=a(function(){const t=i(),e=n("nodeSize"),r=n("spacing");return class extends t{constructor(t){super(t),Object.assign(this,{x:0,y:0,relX:0,prelim:0,shift:0,change:0,lExt:this,lExtRelX:0,lThr:null,rExt:this,rExtRelX:0,rThr:null})}get size(){return e(this.data)}spacing(t){return r(this.data,t.data)}get x(){return this.data.x}set x(t){this.data.x=t}get y(){return this.data.y}set y(t){this.data.y=t}update(){return C(this),I(this),this}}}(),t,(t=>t.children));return e.update(),e.data}function i(){const t=n("nodeSize"),e=n("spacing");return class n extends v.prototype.constructor{constructor(t){super(t)}copy(){const t=a(this.constructor,this,(t=>t.children));return t.each((t=>t.data=t.data.data)),t}get size(){return t(this)}spacing(t){return e(this,t)}get nodes(){return this.descendants()}get xSize(){return this.size[0]}get ySize(){return this.size[1]}get top(){return this.y}get bottom(){return this.y+this.ySize}get left(){return this.x-this.xSize/2}get right(){return this.x+this.xSize/2}get root(){const t=this.ancestors();return t[t.length-1]}get numChildren(){return this.hasChildren?this.children.length:0}get hasChildren(){return!this.noChildren}get noChildren(){return null===this.children}get firstChild(){return this.hasChildren?this.children[0]:null}get lastChild(){return this.hasChildren?this.children[this.numChildren-1]:null}get extents(){return(this.children||[]).reduce(((t,e)=>n.maxExtents(t,e.extents)),this.nodeExtents)}get nodeExtents(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}static maxExtents(t,e){return{top:Math.min(t.top,e.top),bottom:Math.max(t.bottom,e.bottom),left:Math.min(t.left,e.left),right:Math.max(t.right,e.right)}}}}function a(t,e,n){const r=(e,i)=>{const a=new t(e);Object.assign(a,{parent:i,depth:null===i?0:i.depth+1,height:0,length:1});const o=n(e)||[];return a.children=0===o.length?null:o.map((t=>r(t,a))),a.children&&Object.assign(a,a.children.reduce(((t,e)=>({height:Math.max(t.height,e.height+1),length:t.length+e.length})),a)),a};return r(e,null)}return Object.assign(r,{nodeSize(t){return arguments.length?(e.nodeSize=t,r):e.nodeSize},spacing(t){return arguments.length?(e.spacing=t,r):e.spacing},children(t){return arguments.length?(e.children=t,r):e.children},hierarchy(t,n){const r=void 0===n?e.children:n;return a(i(),t,r)},dump(t){const e=n("nodeSize"),r=t=>n=>{const i=t+"  ",a=t+"    ",{x:o,y:s}=n,l=e(n),h=n.children||[],c=0===h.length?" ":`,${i}children: [${a}${h.map(r(a)).join(a)}${i}],${t}`;return`{ size: [${l.join(", ")}],${i}x: ${o}, y: ${s}${c}},`};return r("\n")(t)}}),r}X.version=E;const C=(t,e=0)=>(t.y=e,(t.children||[]).reduce(((e,n)=>{const[r,i]=e;C(n,t.y+t.ySize);const a=(0===r?n.lExt:n.rExt).bottom;0!==r&&O(t,r,i);return[r+1,T(a,r,i)]}),[0,null]),M(t),H(t),t),I=(t,e,n)=>{void 0===e&&(e=-t.relX-t.prelim,n=0);const r=e+t.relX;return t.relX=r+t.prelim-n,t.prelim=0,t.x=n+t.relX,(t.children||[]).forEach((e=>I(e,r,t.x))),t},M=t=>{(t.children||[]).reduce(((t,e)=>{const[n,r]=t,i=n+e.shift,a=r+i+e.change;return e.relX+=a,[i,a]}),[0,0])},O=(t,e,n)=>{const r=t.children[e-1],i=t.children[e];let a=r,o=r.relX,s=i,l=i.relX,h=!0;for(;a&&s;){a.bottom>n.lowY&&(n=n.next);const r=o+a.prelim-(l+s.prelim)+a.xSize/2+s.xSize/2+a.spacing(s);(r>0||r<0&&h)&&(l+=r,A(i,r),R(t,e,n.index,r)),h=!1;const c=a.bottom,d=s.bottom;c<=d&&(a=B(a),a&&(o+=a.relX)),c>=d&&(s=$(s),s&&(l+=s.relX))}!a&&s?D(t,e,s,l):a&&!s&&N(t,e,a,o)},A=(t,e)=>{t.relX+=e,t.lExtRelX+=e,t.rExtRelX+=e},R=(t,e,n,r)=>{const i=t.children[e],a=e-n;if(a>1){const e=r/a;t.children[n+1].shift+=e,i.shift-=e,i.change-=r-e}},$=t=>t.hasChildren?t.firstChild:t.lThr,B=t=>t.hasChildren?t.lastChild:t.rThr,D=(t,e,n,r)=>{const i=t.firstChild,a=i.lExt,o=t.children[e];a.lThr=n;const s=r-n.relX-i.lExtRelX;a.relX+=s,a.prelim-=s,i.lExt=o.lExt,i.lExtRelX=o.lExtRelX},N=(t,e,n,r)=>{const i=t.children[e],a=i.rExt,o=t.children[e-1];a.rThr=n;const s=r-n.relX-i.rExtRelX;a.relX+=s,a.prelim-=s,i.rExt=o.rExt,i.rExtRelX=o.rExtRelX},H=t=>{if(t.hasChildren){const e=t.firstChild,n=t.lastChild,r=(e.prelim+e.relX-e.xSize/2+n.relX+n.prelim+n.xSize/2)/2;Object.assign(t,{prelim:r,lExt:e.lExt,lExtRelX:e.lExtRelX,rExt:n.rExt,rExtRelX:n.rExtRelX})}},T=(t,e,n)=>{for(;null!==n&&t>=n.lowY;)n=n.next;return{lowY:t,index:e,next:n}};
/*! @gera2ld/jsx-dom v2.1.1 | ISC License */
var L=1,F=4,P="http://www.w3.org/2000/svg",Y="http://www.w3.org/1999/xlink",V={show:Y,actuate:Y,href:Y},W=function(t){return"string"==typeof t||"number"==typeof t},_=function(t){return 1===(null==t?void 0:t.vtype)},U=function(t){return 2===(null==t?void 0:t.vtype)};function Z(t,e){var n;if("string"==typeof t)n=1;else{if("function"!=typeof t)throw new Error("Invalid VNode type");n=2}return{vtype:n,type:t,props:e}}function G(t){return t.children}var K={isSvg:!1};function J(t,e){if(e.type===L)null!=e.node&&t.append(e.node);else{if(e.type!==F)throw new Error("Unkown ref type "+JSON.stringify(e));e.children.forEach((function(e){J(t,e)}))}}var q={className:"class",labelFor:"for"};function Q(t,e,n,r){if(e=q[e]||e,!0===n)t.setAttribute(e,"");else if(!1===n)t.removeAttribute(e);else{var i=r?V[e]:void 0;void 0!==i?t.setAttributeNS(i,e,n):t.setAttribute(e,n)}}function tt(t,e){if(void 0===e&&(e=K),null==t||"boolean"==typeof t)return{type:L,node:null};if(t instanceof Node)return{type:L,node:t};if(U(t)){var n=t,r=n.type,i=n.props;if(r===G){var a=document.createDocumentFragment();if(i.children)J(a,tt(i.children,e));return{type:L,node:a}}return tt(r(i),e)}if(W(t))return{type:L,node:document.createTextNode(""+t)};if(_(t)){var o,s,l=t,h=l.type,c=l.props;if(e.isSvg||"svg"!==h||(e=Object.assign({},e,{isSvg:!0})),function(t,e,n){for(var r in e)"key"!==r&&"children"!==r&&"ref"!==r&&("dangerouslySetInnerHTML"===r?t.innerHTML=e[r].__html:"innerHTML"===r||"textContent"===r||"innerText"===r?t[r]=e[r]:r.startsWith("on")?t[r.toLowerCase()]=e[r]:Q(t,r,e[r],n.isSvg))}(o=e.isSvg?document.createElementNS(P,h):document.createElement(h),c,e),c.children){var d=e;e.isSvg&&"foreignObject"===h&&(d=Object.assign({},d,{isSvg:!1})),s=tt(c.children,d)}null!=s&&J(o,s);var u=c.ref;return"function"==typeof u&&u(o),{type:L,node:o}}if(Array.isArray(t))return{type:F,children:t.map((function(t){return tt(t,e)}))};throw new Error("mount: Invalid Vnode!")}function et(t){for(var e=[],n=0;n<t.length;n+=1){var r=t[n];Array.isArray(r)?e=e.concat(et(r)):null!=r&&e.push(r)}return e}function nt(t){return t.type===L?t.node:t.children.map(nt)}function rt(t){return Array.isArray(t)?et(t.map(rt)):nt(tt(t))}var it=".markmap-container{height:0;left:-100px;overflow:hidden;position:absolute;top:-100px;width:0}.markmap-container>.markmap-foreign{display:inline-block}.markmap-container>.markmap-foreign>div:last-child{white-space:nowrap}";function at(t){const e=t.data;return Math.max(4-2*e.depth,1.5)}function ot(t,e){return t[p(t,e)]}function st(t){t.stopPropagation()}const lt=new o,ht=c(f),ct="undefined"!=typeof navigator&&navigator.userAgent.includes("Macintosh");class dt{constructor(e,n){this.revokers=[],["handleZoom","handleClick","handlePan"].forEach((t=>{this[t]=this[t].bind(this)})),this.viewHooks={transformHtml:new o},this.svg=e.datum?e:m(e),this.styleNode=this.svg.append("style"),this.zoom=s().filter((t=>this.options.scrollForPan&&"wheel"===t.type?t.ctrlKey&&!t.button:!(t.ctrlKey&&"wheel"!==t.type||t.button))).on("zoom",this.handleZoom),this.setOptions(n),this.state={id:this.options.id||this.svg.attr("id")||t()},this.g=this.svg.append("g"),this.revokers.push(lt.tap((()=>{this.setData()})))}getStyleContent(){const{style:t}=this.options,{id:e}=this.state,n="function"==typeof t?t(e):"";return[this.options.embedGlobalCSS&&".markmap{font:300 16px/20px sans-serif}.markmap-link{fill:none}.markmap-node>circle{cursor:pointer}.markmap-foreign{display:inline-block}.markmap-foreign a{color:#0097e6}.markmap-foreign a:hover{color:#00a8ff}.markmap-foreign code{background-color:#f0f0f0;border-radius:2px;color:#555;font-size:calc(1em - 2px)}.markmap-foreign :not(pre)>code{padding:.2em .4em}.markmap-foreign del{text-decoration:line-through}.markmap-foreign em{font-style:italic}.markmap-foreign strong{font-weight:bolder}.markmap-foreign mark{background:#ffeaa7}.markmap-foreign pre,.markmap-foreign pre[class*=language-]{margin:0;padding:.2em .4em}",n].filter(Boolean).join("\n")}updateStyle(){this.svg.attr("class",e(this.svg.attr("class"),"markmap",this.state.id));const t=this.getStyleContent();this.styleNode.text(t)}handleZoom(t){const{transform:e}=t;this.g.attr("transform",e)}handlePan(t){t.preventDefault();const e=l(this.svg.node()),n=e.translate(-t.deltaX/e.k,-t.deltaY/e.k);this.svg.call(this.zoom.transform,n)}handleClick(t,e){var n;const{data:r}=e;r.payload=y({},r.payload,{fold:null!=(n=r.payload)&&n.fold?0:1}),this.renderData(e.data)}initializeData(t){let e=0;const{color:i,nodeMinHeight:a,maxWidth:o,initialExpandLevel:s}=this.options,{id:l}=this.state,h=rt(Z("div",{className:`markmap-container markmap ${l}-g`})),c=rt(Z("style",{children:[this.getStyleContent(),it].join("\n")}));document.body.append(h,c);const d=o?`max-width: ${o}px`:"";let u=0;n(t,((t,n,r)=>{var a,o,l;t.children=null==(a=t.children)?void 0:a.map((t=>y({},t))),e+=1;const c=rt(Z("div",{className:"markmap-foreign",style:d,children:Z("div",{dangerouslySetInnerHTML:{__html:t.content}})}));h.append(c),t.state=y({},t.state,{id:e,el:c.firstChild}),t.state.path=[null==r||null==(o=r.state)?void 0:o.path,t.state.id].filter(Boolean).join("."),i(t);const p=2===(null==(l=t.payload)?void 0:l.fold);p?u+=1:(u||s>=0&&t.depth>=s)&&(t.payload=y({},t.payload,{fold:1})),n(),p&&(u-=1)}));const p=r(h.childNodes).map((t=>t.firstChild));this.viewHooks.transformHtml.call(this,p),p.forEach((t=>{t.parentNode.append(t.cloneNode(!0))})),n(t,((t,e,n)=>{var r;const i=t.state.el.getBoundingClientRect();t.content=t.state.el.innerHTML,t.state.size=[Math.ceil(i.width)+1,Math.max(Math.ceil(i.height),a)],t.state.key=[null==n||null==(r=n.state)?void 0:r.id,t.state.id].filter(Boolean).join(".")+t.content,e()})),h.remove(),c.remove()}setOptions(t){this.options=y({},dt.defaultOptions,t),this.options.zoom?this.svg.call(this.zoom):this.svg.on(".zoom",null),this.svg.on("wheel",this.options.pan?this.handlePan:null)}setData(t,e){t&&(this.state.data=t),e&&this.setOptions(e),this.initializeData(this.state.data),this.updateStyle(),this.renderData()}renderData(t){var e,r;if(!this.state.data)return;const{spacingHorizontal:a,paddingX:o,spacingVertical:s,autoFit:l,color:h}=this.options,c=X().children((t=>{var e;return!(null!=(e=t.payload)&&e.fold)&&t.children})).nodeSize((t=>{const[e,n]=t.data.state.size;return[n,e+(e?2*o:0)+a]})).spacing(((t,e)=>t.parent===e.parent?s:2*s)),p=c.hierarchy(this.state.data);c(p),function(t,e){n(t,((t,n)=>{t.ySizeInner=t.ySize-e,t.y+=e,n()}),"children")}(p,a);const f=p.descendants().reverse(),m=p.links(),y=g(),x=d(f,(t=>t.x-t.xSize/2)),v=u(f,(t=>t.x+t.xSize/2)),z=d(f,(t=>t.y)),b=u(f,(t=>t.y+t.ySizeInner));Object.assign(this.state,{minX:x,maxX:v,minY:z,maxY:b}),l&&this.fit();const S=t&&f.find((e=>e.data===t))||p,k=null!=(e=S.data.state.x0)?e:S.x,w=null!=(r=S.data.state.y0)?r:S.y,E=this.g.selectAll(i("g")).data(f,(t=>t.data.state.key)),j=E.enter().append("g").attr("data-depth",(t=>t.data.depth)).attr("data-path",(t=>t.data.state.path)).attr("transform",(t=>`translate(${w+S.ySizeInner-t.ySizeInner},${k+S.xSize/2-t.xSize})`)),C=this.transition(E.exit());C.select("line").attr("x1",(t=>t.ySizeInner)).attr("x2",(t=>t.ySizeInner)),C.select("foreignObject").style("opacity",0),C.attr("transform",(t=>`translate(${S.y+S.ySizeInner-t.ySizeInner},${S.x+S.xSize/2-t.xSize})`)).remove();const I=E.merge(j).attr("class",(t=>{var e;return["markmap-node",(null==(e=t.data.payload)?void 0:e.fold)&&"markmap-fold"].filter(Boolean).join(" ")}));this.transition(I).attr("transform",(t=>`translate(${t.y},${t.x-t.xSize/2})`));const M=I.selectAll(i("line")).data((t=>[t]),(t=>t.data.state.key)).join((t=>t.append("line").attr("x1",(t=>t.ySizeInner)).attr("x2",(t=>t.ySizeInner))),(t=>t),(t=>t.remove()));this.transition(M).attr("x1",-1).attr("x2",(t=>t.ySizeInner+2)).attr("y1",(t=>t.xSize)).attr("y2",(t=>t.xSize)).attr("stroke",(t=>h(t.data))).attr("stroke-width",at);const O=I.selectAll(i("circle")).data((t=>t.data.children?[t]:[]),(t=>t.data.state.key)).join((t=>t.append("circle").attr("stroke-width","1.5").attr("cx",(t=>t.ySizeInner)).attr("cy",(t=>t.xSize)).attr("r",0).on("click",((t,e)=>this.handleClick(t,e)))),(t=>t),(t=>t.remove()));this.transition(O).attr("r",6).attr("cx",(t=>t.ySizeInner)).attr("cy",(t=>t.xSize)).attr("stroke",(t=>h(t.data))).attr("fill",(t=>{var e;return null!=(e=t.data.payload)&&e.fold&&t.data.children?h(t.data):"#fff"}));const A=I.selectAll(i("foreignObject")).data((t=>[t]),(t=>t.data.state.key)).join((t=>{const e=t.append("foreignObject").attr("class","markmap-foreign").attr("x",o).attr("y",0).style("opacity",0).on("mousedown",st).on("dblclick",st);return e.append("xhtml:div").select((function(t){const e=t.data.state.el.cloneNode(!0);return this.replaceWith(e),e})).attr("xmlns","http://www.w3.org/1999/xhtml"),e}),(t=>t),(t=>t.remove())).attr("width",(t=>Math.max(0,t.ySizeInner-2*o))).attr("height",(t=>t.xSize));this.transition(A).style("opacity",1);const R=this.g.selectAll(i("path")).data(m,(t=>t.target.data.state.key)).join((t=>{const e=[w+S.ySizeInner,k+S.xSize/2];return t.insert("path","g").attr("class","markmap-link").attr("data-depth",(t=>t.target.data.depth)).attr("data-path",(t=>t.target.data.state.path)).attr("d",y({source:e,target:e}))}),(t=>t),(t=>{const e=[S.y+S.ySizeInner,S.x+S.xSize/2];return this.transition(t).attr("d",y({source:e,target:e})).remove()}));this.transition(R).attr("stroke",(t=>h(t.target.data))).attr("stroke-width",(t=>at(t.target))).attr("d",(t=>{const e=[t.source.y+t.source.ySizeInner,t.source.x+t.source.xSize/2],n=[t.target.y,t.target.x+t.target.xSize/2];return y({source:e,target:n})})),f.forEach((t=>{t.data.state.x0=t.x,t.data.state.y0=t.y}))}transition(t){const{duration:e}=this.options;return t.transition().duration(e)}async fit(){const t=this.svg.node(),{width:e,height:n}=t.getBoundingClientRect(),{fitRatio:r}=this.options,{minX:i,maxX:o,minY:s,maxY:l}=this.state,c=l-s,d=o-i,u=Math.min(e/c*r,n/d*r,2),p=h.translate((e-c*u)/2-s*u,(n-d*u)/2-i*u).scale(u);return this.transition(this.svg).call(this.zoom.transform,p).end().catch(a)}async ensureView(t,e){let n,r;if(this.g.selectAll(i("g")).each((function(e){e.data===t&&(n=this,r=e)})),!n||!r)return;const o=this.svg.node(),s=o.getBoundingClientRect(),h=l(o),[c,d]=[r.y,r.y+r.ySizeInner+2].map((t=>t*h.k+h.x)),[u,p]=[r.x-r.xSize/2,r.x+r.xSize/2].map((t=>t*h.k+h.y)),f=y({left:0,right:0,top:0,bottom:0},e),m=[f.left-c,s.width-f.right-d],g=[f.top-u,s.height-f.bottom-p],x=m[0]*m[1]>0?ot(m,Math.abs)/h.k:0,v=g[0]*g[1]>0?ot(g,Math.abs)/h.k:0;if(x||v){const t=h.translate(x,v);return this.transition(this.svg).call(this.zoom.transform,t).end().catch(a)}}async rescale(t){const e=this.svg.node(),{width:n,height:r}=e.getBoundingClientRect(),i=n/2,o=r/2,s=l(e),h=s.translate((i-s.x)*(1-t)/s.k,(o-s.y)*(1-t)/s.k).scale(t);return this.transition(this.svg).call(this.zoom.transform,h).end().catch(a)}destroy(){this.svg.on(".zoom",null),this.svg.html(null),this.revokers.forEach((t=>{t()}))}static create(t,e,n){const r=new dt(t,e);return n&&(r.setData(n),r.fit()),r}}dt.defaultOptions={autoFit:!1,color:t=>ht(`${t.state.path}`),duration:500,embedGlobalCSS:!0,fitRatio:.95,maxWidth:0,nodeMinHeight:16,paddingX:8,scrollForPan:ct,spacingHorizontal:80,spacingVertical:5,initialExpandLevel:-1,zoom:!0,pan:!0};export{dt as M};
