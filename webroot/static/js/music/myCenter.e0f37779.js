import{_ as e,a as l,b as t,c as a}from"../end/end.08128031.js";import{_ as i,a as s,b as o,c as n,d as c}from"../unthumbs1/unthumbs1.60163221.js";import{S as r}from"../index/index.003f58b7.js";import{d,u,v as p,g,y as m,i as v,l as f,j as h,n as x,h as y,k,F as b,r as C,Z as I,m as A,o as E,_ as w,C as F,D as j,aC as O,H as N}from"../main-83ca6c6a.js";import{j as B,a as U,i as _,b as L,k as T}from"./music.dcec3151.js";const R=e=>(F("data-v-ee23815f"),e=e(),j(),e),H={class:"bg-[#f4f4f4] dark:bg-[#020104] musicBody"},M={key:1,class:"videoBox"},D=R((()=>h("div",{style:{width:"504px",height:"756px","border-radius":"8px",position:"relative",display:"flex","justify-content":"center","align-items":"center"},class:"bg-[#E5EDFE] dark:bg-[#0A182F]"},[h("div",{style:{width:"50px",height:"50px"}},[h("div",{class:"loader"})])],-1))),S=["src"],z={class:"control"},J={class:"myCreate bg-[#fff] dark:bg-[#15171A]"},V={class:"myCreateTop"},Z=R((()=>h("div",{style:{"margin-left":"4px"}},"我的创作",-1))),q=R((()=>h("div",{style:{width:"100%",height:"2px"},class:"bg-[#fff] dark:bg-[#010102]"},null,-1))),G={class:"mainLeft"},K=["onClick","src"],P={key:1,style:{width:"108px",height:"108px","border-radius":"8px"},src:c,alt:""},Q={class:"itemInfo"},W={class:"info"},X=R((()=>h("div",{style:{width:"30px",height:"18px","border-radius":"16px","text-align":"center",color:"#34C759"},class:"bg-[#EBF9EE] dark:bg-[#175A28]"},"V3",-1))),Y={style:{margin:"6px 0"}},$={class:"operation"},ee=["onClick"],le=["onClick"],te=["onClick"],ae=["onClick"],ie={class:"iconBox",style:{position:"relative"}},se={key:0,class:"operationBox bg-[#fff] dark:bg-[#15171A]"},oe=["onClick"],ne=R((()=>h("div",null,"下载视频",-1))),ce=["onClick"],re=R((()=>h("div",null,"下载音频",-1))),de=["onClick"],ue=R((()=>h("div",null,"删除",-1))),pe={class:"end text-[#A3A5A6] dark:text-[#76777A]"},ge=["href"],me=["href"],ve=N(d({__name:"myCenter",setup(c){let d=null;const F=u();p();const{isMobile:j}=g(),N=m([]),R=m(1),ve=m();function fe(){d||(d=F.loading("数据加载中",{duration:0})),B({page:R.value,size:40}).then((e=>{Ee(),ve.value=e.data.count;const{records:l}=e.data;let t=l.filter((e=>e.text)).filter((e=>-1!=e.text.indexOf("http")&&-1!=e.text.indexOf("####")&&-1!=e.text.indexOf("Chorus")||-1!=e.text.indexOf("生成中")));for(let a=0;a<t.length;a++)if(-1!=t[a].text.indexOf("http")&&-1!=t[a].text.indexOf("Chorus")){let e=t[a].text.split("🎵")[1].split("\n")[0],l=t[a].text.split("🎵")[1].split("[Chorus]")[1].split("[")[0];-1!=l.indexOf("mv")&&(l=l.split("mv")[0]);let i=t[a].text.split("🎵").pop().split("!")[1];t[a].image=i.split("](")[1].split(")")[0],t[a].mp3=i.split("](")[2].split(")")[0],t[a].mp4=i.split("](")[3].split(")")[0],t[a].title=e,t[a].intro=l,t[a].operation=!1}else t[a].image=null,t[a].mp3=null,t[a].mp4=null;N.value=[...N.value,...t]})).catch((e=>{Ee(),fe()}))}fe();const he=m(""),xe=m(""),ye=m(""),ke=m(""),be=m("");U({keys:["copyrightTitle","icpNumber","policeFilingNumber","icpUrl","policeFilingUrl"]}).then((e=>{he.value=e.data.copyrightTitle,xe.value=e.data.icpNumber,ye.value=e.data.policeFilingNumber,ke.value=e.data.icpUrl,be.value=e.data.policeFilingUrl}));const Ce=m(1);function Ie(e,l){if(0==l){let l={chatLogId:e.chatId,action:"agree",type:"music"};if(0==Ce.value)return;Ce.value=0,_(l).then((l=>{"agree"==e.agree?N.value.forEach((l=>{l.chatId==e.chatId&&(l.agree=null,l.agreeNum--)})):(null==e.agree||"disAgree"==e.agree)&&N.value.forEach((l=>{l.chatId==e.chatId&&(l.agree="agree",l.agreeNum++)})),Ce.value=1}))}else if(1==l){let l={chatLogId:e.chatId,action:"disAgree",type:"music"};if(0==Ce.value)return;Ce.value=0,_(l).then((l=>{console.log(N.value),"agree"==e.agree?N.value.forEach((l=>{l.chatId==e.chatId&&(l.agree="disAgree",l.agreeNum--)})):null==e.agree?N.value.forEach((l=>{l.chatId==e.chatId&&(l.agree="disAgree")})):"disAgree"==e.agree&&N.value.forEach((l=>{l.chatId==e.chatId&&(l.agree="null")})),Ce.value=1}))}}const Ae=m(!1);function Ee(){d&&(d.destroy(),d=null)}function we(e,l){let t="/api";if(d||(d=F.loading("下载中，请稍等",{duration:0})),"mp4"==l){let l=e.mp4.split("/").pop();Be(),O.get(t+"/proxy/down",{responseType:"blob",params:{url:e.mp4}}).then((e=>{const t=window.URL.createObjectURL(new Blob([e.data])),a=document.createElement("a");a.href=t,a.setAttribute("download",l),a.click(),Ee(),F.success("下载成功")}))}else if("mp3"==l){let l=e.mp3.split("/").pop();Be(),O.get(t+"/proxy/down",{responseType:"blob",params:{url:e.mp3}}).then((e=>{const t=window.URL.createObjectURL(new Blob([e.data])),a=document.createElement("a");a.href=t,a.setAttribute("download",l),a.click(),Ee(),F.success("下载成功")}))}}const Fe=m(""),je=m(!0);function Oe(){const e=document.getElementById("video");je.value?(je.value=!1,e.pause()):(je.value=!0,e.play())}function Ne(e){let l=[];N.value.filter((e=>null!=e.mp4)).forEach((e=>{l=[...l,e.mp4]}));let t=l.indexOf(Fe.value);if(0==e){if(0==t)return;t--,Fe.value=l[t]}else if(1==e){if(t==l.length-1)return;t++,Fe.value=l[t]}console.log(t)}function Be(){Ae.value=!1,N.value.forEach((e=>{e.operation=!1}))}const Ue=m(null);function _e(){const e=Ue.value;if(e.scrollTop+e.clientHeight+1>=e.scrollHeight){if(20*R.value>=ve.value)return void F.error("没有更多数据了");R.value++,fe()}}return(c,d)=>(E(),v("div",H,[Ae.value?(E(),v("div",{key:0,class:"mask",onClick:Be})):f("",!0),Fe.value?(E(),v("div",M,[D,h("video",{class:"video",autoplay:"",id:"video",loop:"",src:Fe.value},null,8,S),x(y(w),{icon:"icon-park-solid:close-one",class:"text-xl text-[#fff] text-center icon",onClick:d[0]||(d[0]=e=>Fe.value="")}),h("div",z,[h("img",{class:"controlItem",style:{cursor:"pointer"},src:e,alt:"",onClick:d[1]||(d[1]=e=>Ne(0))}),je.value?(E(),v("img",{key:0,class:"controlItem",src:l,style:{margin:"0 50px",cursor:"pointer"},alt:"",onClick:Oe})):f("",!0),je.value?f("",!0):(E(),v("img",{key:1,class:"controlItem",src:t,style:{margin:"0 50px",cursor:"pointer"},alt:"",onClick:Oe})),h("img",{class:"controlItem",style:{cursor:"pointer"},src:a,alt:"",onClick:d[2]||(d[2]=e=>Ne(1))})])])):f("",!0),y(j)?f("",!0):(E(),k(r,{key:2,sideType:1})),h("div",J,[h("div",V,[x(y(w),{icon:"icomoon-free:file-music",class:"text-xl text-center"}),Z]),q,h("div",{class:"myCreateMain",ref_key:"container",ref:Ue,onScroll:_e},[h("div",G,[(E(!0),v(b,null,C(N.value,((e,l)=>(E(),v("div",{class:"mainItem dark:bg-[#0A182F] bg-[#F5F8FE]",key:l},[e.image?(E(),v("img",{key:0,style:{width:"108px",height:"108px","border-radius":"8px"},onClick:l=>function(e){Fe.value=e.mp4;let l={recoredId:e.chatId};e.playNum++,L(l).then((e=>{console.log(e)}))}(e),src:e.image,alt:""},null,8,K)):f("",!0),e.image?f("",!0):(E(),v("img",P)),h("div",Q,[h("div",W,[X,h("div",Y,A(e.title?e.title:"匿名"),1),h("div",null,A(e.intro),1)]),h("div",$,["agree"!=e.agree?(E(),v("img",{key:0,class:"icon",onClick:l=>Ie(e,0),src:i,alt:""},null,8,ee)):f("",!0),"agree"==e.agree?(E(),v("img",{key:1,class:"icon",onClick:l=>Ie(e,0),src:s,alt:""},null,8,le)):f("",!0),"disAgree"!=e.agree?(E(),v("img",{key:2,class:"icon",onClick:l=>Ie(e,1),src:o,alt:""},null,8,te)):f("",!0),"disAgree"==e.agree?(E(),v("img",{key:3,class:"icon",onClick:l=>Ie(e,1),src:n,alt:""},null,8,ae)):f("",!0),h("div",ie,[x(y(w),{icon:"ri:more-line",class:"text-xl text-center icon",onClick:l=>function(e){e.operation=!0,Ae.value=!0}(e)},null,8,["onClick"]),e.operation?(E(),v("div",se,[h("div",{class:"operationItem",style:{display:"flex"},onClick:l=>we(e,"mp4")},[x(y(w),{icon:"gravity-ui:video",style:{"margin-right":"5px"},class:"text-xl text-center"}),ne],8,oe),h("div",{class:"operationItem",style:{display:"flex"},onClick:l=>we(e,"mp3")},[x(y(w),{icon:"fluent:headphones-sound-wave-24-filled",style:{"margin-right":"5px"},class:"text-xl text-center"}),re],8,ce),h("div",{class:"operationItem",style:{display:"flex",color:"#FF5E55"},onClick:l=>function(e){let l={id:e.chatId};Be(),T(l).then((l=>{F.success("删除成功"),N.value=N.value.filter((l=>l.chatId!=e.chatId))}))}(e)},[x(y(w),{icon:"mi:delete",style:{"margin-right":"5px"},class:"text-xl text-center"}),ue],8,de)])):f("",!0)])])])])))),128))])],544),h("div",pe,[I("版权所有 © "+A(he.value)+" ",1),h("a",{href:ke.value||"#"},[h("a",{href:be.value||"#"},A(ye.value),9,me),I(A(xe.value),1)],8,ge)])])]))}}),[["__scopeId","data-v-ee23815f"]]);export{ve as default};
