import{_ as e,a as l,b as t,c as a}from"../end/end.08128031.js";import{_ as i,a as s,b as o,c as n,d as c}from"../unthumbs1/unthumbs1.60163221.js";import{S as r}from"../index/index.9db8dd62.js";import{d,u,v as p,g,y as m,i as v,l as f,j as h,n as x,h as y,k,F as b,r as C,X as I,m as E,o as A,b9 as w,_ as F,C as O,D as j,aB as B,E as N}from"../main-4e4d4648.js";import{j as U,a as _,i as L,b as T,k as R}from"./music.ba78f089.js";const M=e=>(O("data-v-ed584a02"),e=e(),j(),e),D={class:"bg-[#f4f4f4] dark:bg-[#020104] musicBody"},H={key:1,class:"videoBox"},S={style:{width:"504px",height:"756px","border-radius":"8px",position:"relative"},class:"bg-[#E5EDFE] dark:bg-[#0A182F]"},z=["src"],J={class:"control"},V={class:"myCreate bg-[#fff] dark:bg-[#15171A]"},X={class:"myCreateTop"},q=M((()=>h("div",{style:{"margin-left":"4px"}},"我的创作",-1))),G=M((()=>h("div",{style:{width:"100%",height:"2px"},class:"bg-[#fff] dark:bg-[#010102]"},null,-1))),K={class:"mainLeft"},P=["onClick","src"],Q={key:1,style:{width:"108px",height:"108px","border-radius":"8px"},src:c,alt:""},W={class:"itemInfo"},Y={class:"info"},Z=M((()=>h("div",{style:{width:"30px",height:"18px","border-radius":"16px","text-align":"center",color:"#34C759"},class:"bg-[#EBF9EE] dark:bg-[#175A28]"},"V3",-1))),$={style:{margin:"6px 0"}},ee={class:"operation"},le=["onClick"],te=["onClick"],ae=["onClick"],ie=["onClick"],se={class:"iconBox",style:{position:"relative"}},oe={key:0,class:"operationBox bg-[#fff] dark:bg-[#15171A]"},ne=["onClick"],ce=M((()=>h("div",null,"下载视频",-1))),re=["onClick"],de=M((()=>h("div",null,"下载音频",-1))),ue=["onClick"],pe=M((()=>h("div",null,"删除",-1))),ge={class:"end text-[#A3A5A6] dark:text-[#76777A]"},me=["href"],ve=["href"],fe=N(d({__name:"myCenter",setup(c){let d=null;const O=u();p();const{isMobile:j}=g(),N=m([]),M=m(1),fe=m();function he(){d||(d=O.loading("数据加载中",{duration:0})),U({page:M.value,size:40}).then((e=>{we(),fe.value=e.data.count;const{records:l}=e.data;let t=l.filter((e=>e.text)).filter((e=>-1!=e.text.indexOf("http")&&-1!=e.text.indexOf("####")&&-1!=e.text.indexOf("Chorus")||-1!=e.text.indexOf("生成中")));for(let a=0;a<t.length;a++)if(-1!=t[a].text.indexOf("http")&&-1!=t[a].text.indexOf("Chorus")){let e=t[a].text.split("🎵")[1].split("\n")[0],l=t[a].text.split("🎵")[1].split("[Chorus]")[1].split("[")[0];-1!=l.indexOf("mv")&&(l=l.split("mv")[0]);let i=t[a].text.split("🎵").pop().split("!")[1];t[a].image=i.split("](")[1].split(")")[0],t[a].mp3=i.split("](")[2].split(")")[0],t[a].mp4=i.split("](")[3].split(")")[0],t[a].title=e,t[a].intro=l,t[a].operation=!1}else t[a].image=null,t[a].mp3=null,t[a].mp4=null;N.value=[...N.value,...t]})).catch((e=>{we(),he()}))}he();const xe=m(""),ye=m(""),ke=m(""),be=m(""),Ce=m("");_({keys:["copyrightTitle","icpNumber","policeFilingNumber","icpUrl","policeFilingUrl"]}).then((e=>{xe.value=e.data.copyrightTitle,ye.value=e.data.icpNumber,ke.value=e.data.policeFilingNumber,be.value=e.data.icpUrl,Ce.value=e.data.policeFilingUrl}));const Ie=m(1);function Ee(e,l){if(0==l){let l={chatLogId:e.chatId,action:"agree",type:"music"};if(0==Ie.value)return;Ie.value=0,L(l).then((l=>{"agree"==e.agree?N.value.forEach((l=>{l.chatId==e.chatId&&(l.agree=null,l.agreeNum--)})):(null==e.agree||"disAgree"==e.agree)&&N.value.forEach((l=>{l.chatId==e.chatId&&(l.agree="agree",l.agreeNum++)})),Ie.value=1}))}else if(1==l){let l={chatLogId:e.chatId,action:"disAgree",type:"music"};if(0==Ie.value)return;Ie.value=0,L(l).then((l=>{console.log(N.value),"agree"==e.agree?N.value.forEach((l=>{l.chatId==e.chatId&&(l.agree="disAgree",l.agreeNum--)})):null==e.agree?N.value.forEach((l=>{l.chatId==e.chatId&&(l.agree="disAgree")})):"disAgree"==e.agree&&N.value.forEach((l=>{l.chatId==e.chatId&&(l.agree="null")})),Ie.value=1}))}}const Ae=m(!1);function we(){d&&(d.destroy(),d=null)}function Fe(e,l){let t="/api";if(d||(d=O.loading("下载中，请稍等",{duration:0})),"mp4"==l){let l=e.mp4.split("/").pop();Ue(),B.get(t+"/proxy/down",{responseType:"blob",params:{url:e.mp4}}).then((e=>{const t=window.URL.createObjectURL(new Blob([e.data])),a=document.createElement("a");a.href=t,a.setAttribute("download",l),a.click(),we(),O.success("下载成功")}))}else if("mp3"==l){let l=e.mp3.split("/").pop();Ue(),B.get(t+"/proxy/down",{responseType:"blob",params:{url:e.mp3}}).then((e=>{const t=window.URL.createObjectURL(new Blob([e.data])),a=document.createElement("a");a.href=t,a.setAttribute("download",l),a.click(),we(),O.success("下载成功")}))}}const Oe=m(""),je=m(!0);function Be(){const e=document.getElementById("video");je.value?(je.value=!1,e.pause()):(je.value=!0,e.play())}function Ne(e){let l=[];N.value.filter((e=>null!=e.mp4)).forEach((e=>{l=[...l,e.mp4]}));let t=l.indexOf(Oe.value);if(0==e){if(0==t)return;t--,Oe.value=l[t]}else if(1==e){if(t==l.length-1)return;t++,Oe.value=l[t]}console.log(t)}function Ue(){Ae.value=!1,N.value.forEach((e=>{e.operation=!1}))}const _e=m(null);function Le(){const e=_e.value;if(e.scrollTop+e.clientHeight+1>=e.scrollHeight){if(20*M.value>=fe.value)return void O.error("没有更多数据了");M.value++,he()}}return(c,d)=>(A(),v("div",D,[Ae.value?(A(),v("div",{key:0,class:"mask",onClick:Ue})):f("",!0),Oe.value?(A(),v("div",H,[h("div",S,[x(w)]),h("video",{class:"video",autoplay:"",id:"video",loop:"",src:Oe.value},null,8,z),x(y(F),{icon:"icon-park-solid:close-one",class:"text-xl text-[#fff] text-center icon",onClick:d[0]||(d[0]=e=>Oe.value="")}),h("div",J,[h("img",{class:"controlItem",style:{cursor:"pointer"},src:e,alt:"",onClick:d[1]||(d[1]=e=>Ne(0))}),je.value?(A(),v("img",{key:0,class:"controlItem",src:l,style:{margin:"0 50px",cursor:"pointer"},alt:"",onClick:Be})):f("",!0),je.value?f("",!0):(A(),v("img",{key:1,class:"controlItem",src:t,style:{margin:"0 50px",cursor:"pointer"},alt:"",onClick:Be})),h("img",{class:"controlItem",style:{cursor:"pointer"},src:a,alt:"",onClick:d[2]||(d[2]=e=>Ne(1))})])])):f("",!0),y(j)?f("",!0):(A(),k(r,{key:2,sideType:1})),h("div",V,[h("div",X,[x(y(F),{icon:"icomoon-free:file-music",class:"text-xl text-center"}),q]),G,h("div",{class:"myCreateMain",ref_key:"container",ref:_e,onScroll:Le},[h("div",K,[(A(!0),v(b,null,C(N.value,((e,l)=>(A(),v("div",{class:"mainItem dark:bg-[#0A182F] bg-[#F5F8FE]",key:l},[e.image?(A(),v("img",{key:0,style:{width:"108px",height:"108px","border-radius":"8px"},onClick:l=>function(e){Oe.value=e.mp4;let l={recoredId:e.chatId};e.playNum++,T(l).then((e=>{console.log(e)}))}(e),src:e.image,alt:""},null,8,P)):f("",!0),e.image?f("",!0):(A(),v("img",Q)),h("div",W,[h("div",Y,[Z,h("div",$,E(e.title?e.title:"匿名"),1),h("div",null,E(e.intro),1)]),h("div",ee,["agree"!=e.agree?(A(),v("img",{key:0,class:"icon",onClick:l=>Ee(e,0),src:i,alt:""},null,8,le)):f("",!0),"agree"==e.agree?(A(),v("img",{key:1,class:"icon",onClick:l=>Ee(e,0),src:s,alt:""},null,8,te)):f("",!0),"disAgree"!=e.agree?(A(),v("img",{key:2,class:"icon",onClick:l=>Ee(e,1),src:o,alt:""},null,8,ae)):f("",!0),"disAgree"==e.agree?(A(),v("img",{key:3,class:"icon",onClick:l=>Ee(e,1),src:n,alt:""},null,8,ie)):f("",!0),h("div",se,[x(y(F),{icon:"ri:more-line",class:"text-xl text-center icon",onClick:l=>function(e){e.operation=!0,Ae.value=!0}(e)},null,8,["onClick"]),e.operation?(A(),v("div",oe,[h("div",{class:"operationItem",style:{display:"flex"},onClick:l=>Fe(e,"mp4")},[x(y(F),{icon:"gravity-ui:video",style:{"margin-right":"5px"},class:"text-xl text-center"}),ce],8,ne),h("div",{class:"operationItem",style:{display:"flex"},onClick:l=>Fe(e,"mp3")},[x(y(F),{icon:"fluent:headphones-sound-wave-24-filled",style:{"margin-right":"5px"},class:"text-xl text-center"}),de],8,re),h("div",{class:"operationItem",style:{display:"flex",color:"#FF5E55"},onClick:l=>function(e){let l={id:e.chatId};Ue(),R(l).then((l=>{O.success("删除成功"),N.value=N.value.filter((l=>l.chatId!=e.chatId))}))}(e)},[x(y(F),{icon:"mi:delete",style:{"margin-right":"5px"},class:"text-xl text-center"}),pe],8,ue)])):f("",!0)])])])])))),128))])],544),h("div",ge,[I("版权所有 © "+E(xe.value)+" ",1),h("a",{href:be.value||"#"},[h("a",{href:Ce.value||"#"},E(ke.value),9,ve),I(E(ye.value),1)],8,me)])])]))}}),[["__scopeId","data-v-ed584a02"]]);export{fe as default};
