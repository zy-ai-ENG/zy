import{T as e,b as s}from"../@vue_runtime-dom@3.2.47/@vue_runtime-dom@3.2.47.298398d5.js";import{a as t,A as i,_ as r}from"../main-bb4220d0.js";import{t as o}from"../throttle/throttle.33f09de3.js";import{c as a}from"../index/index.a4f65e28.js";import{F as l}from"../@vicons_ionicons5@0.12.0/@vicons_ionicons5@0.12.0.5fe57882.js";import{d as u,g as n,n as v,m as p,p as c,J as m,a as d,b as _,c as f,N as j,F as h,Q as x,o as y,t as g,R as b}from"../@vue_runtime-core@3.2.47/@vue_runtime-core@3.2.47.e62b9a68.js";import{e as w,I as k,A as E,r as C}from"../naive-ui@2.34.3_vue@3.2.47/naive-ui@2.34.3_vue@3.2.47.d79924d9.js";import{r as I,x as $}from"../@vue_reactivity@3.2.47/@vue_reactivity@3.2.47.859737a0.js";import{o as z,J as q}from"../@vue_shared@3.2.47/@vue_shared@3.2.47.9d8e617e.js";import"../v-viewer@3.0.11_vue@3.2.47/v-viewer@3.0.11_vue@3.2.47.a81e5850.js";import"../viewerjs@1.11.3/viewerjs@1.11.3.a76d4126.js";import"../vue-router@4.1.6_vue@3.2.47/vue-router@4.1.6_vue@3.2.47.018c715a.js";import"../clientjs@0.2.1/clientjs@0.2.1.7f53d864.js";import"../@babel_runtime@7.21.5/@babel_runtime@7.21.5.35f69bd2.js";import"../crypto-js@4.1.1/crypto-js@4.1.1.7142fa56.js";import"../@iconify_vue@4.1.1_vue@3.2.47/@iconify_vue@4.1.1_vue@3.2.47.612da1cd.js";import"../pinia@2.0.35_typescript@4.9.5_vue@3.2.47/pinia@2.0.35_typescript@4.9.5_vue@3.2.47.1425f1b3.js";import"../vue-demi@0.14.7_vue@3.2.47/vue-demi@0.14.7_vue@3.2.47.71ba0ef2.js";import"../axios@1.4.0/axios@1.4.0.5ae1da96.js";import"../vue-i18n@9.2.2_vue@3.2.47/vue-i18n@9.2.2_vue@3.2.47.f7da0a53.js";import"../@intlify_shared@9.2.2/@intlify_shared@9.2.2.76c1dc14.js";import"../@intlify_core-base@9.2.2/@intlify_core-base@9.2.2.72ca16dd.js";import"../@intlify_message-compiler@9.2.2/@intlify_message-compiler@9.2.2.9b2b247d.js";import"../@intlify_devtools-if@9.2.2/@intlify_devtools-if@9.2.2.1be0989c.js";import"../vooks@0.2.12_vue@3.2.47/vooks@0.2.12_vue@3.2.47.89d56bd5.js";import"../evtd@0.2.4/evtd@0.2.4.2789e4a1.js";import"../katex@0.16.7/katex@0.16.7.43835b5c.js";import"../@vueuse_core@9.13.0_vue@3.2.47/@vueuse_core@9.13.0_vue@3.2.47.770e5818.js";import"../@vueuse_shared@9.13.0_vue@3.2.47/@vueuse_shared@9.13.0_vue@3.2.47.58cbe97f.js";import"../mitt@3.0.1/mitt@3.0.1.f0e54764.js";import"../marked@4.3.0/marked@4.3.0.cb1ff4ec.js";import"../date-fns@2.30.0/date-fns@2.30.0.bcce45e8.js";import"../vue-clipboard3@2.0.0/vue-clipboard3@2.0.0.ebf9d56c.js";import"../clipboard@2.0.11/clipboard@2.0.11.6a7b8915.js";import"../@vueuse_integrations@10.2.0_axios@1.4.0_qrcode@1.5.3_vue@3.2.47/@vueuse_integrations@10.2.0_axios@1.4.0_qrcode@1.5.3_vue@3.2.47.a70167c7.js";import"../@vueuse_shared@10.2.0_vue@3.2.47/@vueuse_shared@10.2.0_vue@3.2.47.3d57d69b.js";import"../qrcode@1.5.3/qrcode@1.5.3.ae99ec0a.js";import"../encode-utf8@1.0.3/encode-utf8@1.0.3.2ec93547.js";import"../dijkstrajs@1.0.3/dijkstrajs@1.0.3.38d0b2a1.js";import"../seemly@0.3.6/seemly@0.3.6.21da59ee.js";import"../vueuc@0.4.51_vue@3.2.47/vueuc@0.4.51_vue@3.2.47.ce1cbfa6.js";import"../@css-render_vue3-ssr@0.15.12_vue@3.2.47/@css-render_vue3-ssr@0.15.12_vue@3.2.47.e49104bd.js";import"../vdirs@0.1.8_vue@3.2.47/vdirs@0.1.8_vue@3.2.47.bf970686.js";import"../@juggle_resize-observer@3.4.0/@juggle_resize-observer@3.4.0.80d14552.js";import"../css-render@0.15.12/css-render@0.15.12.af3f05a4.js";import"../@emotion_hash@0.8.0/@emotion_hash@0.8.0.b17c1a96.js";import"../lodash-es@4.17.21/lodash-es@4.17.21.6a776102.js";import"../treemate@0.3.11/treemate@0.3.11.05d63ee5.js";import"../async-validator@4.2.5/async-validator@4.2.5.8d480e59.js";import"../@css-render_plugin-bem@0.15.12_css-render@0.15.12/@css-render_plugin-bem@0.15.12_css-render@0.15.12.0c2c3e5c.js";const A={class:"bg-[#E7ECF6] h-[100vh] overflow-hidden h-full p-4 pr-0 dark:bg-[#18181c] flex flex-col"},L={class:"p-4 flex pr-6 justify-between items-center"},F=_("div",{class:"font-bold text-xl"},"AI绘画广场",-1),M={class:"w-[200px] sm:w-[300px] flex justify-between"},T=_("span",{class:"hidden sm:block"},"尺寸调整",-1),U={class:"flex-1 ml-5"},D={class:"px-4 mb-6 pr-5"},J={class:"market overflow-y-scroll flex-1 min-h-screen bg-[#E7ECF6] p-4 dark:bg-[#18181c] relative"},N=["id"],P=["id","src","onLoad","onError","onClick"],R={class:"menu p-2 text-[#cbd5e1]"},B={class:"prompt"},O={class:"flex justify-between items-end"},Q=["onClick"],W={class:"text-sm dark:text-slate-400"},G=u({__name:"index",setup(u){var G;const H=t(),K=null==(G=n())?void 0:G.appContext.config.globalProperties.$viewerApi,S=w(),V=I([]),X=I({}),Y=I(0),Z=I(160),ee=I(0),se=I(10),te=I(10),ie=I([]),re=I(null),oe=I(0),ae=v((()=>H.isLogin)),le=I(30),ue=I(""),ne=v((()=>le.value+se.value+150));function ve(){!function(){const{showName:e=0,showOther:s=0}={};Y.value=15*[e,s].filter((e=>e)).length}(),function(){if(!re.value)return;const e=re.value.clientWidth;ee.value=Math.floor(e/ne.value);const s=e-ee.value*ne.value,t=(ee.value-1)*se.value;s-t<0&&(ee.value-=1);Z.value=Math.floor((e-t)/ee.value)}();const e=ee.value,s=Z.value,t=[];pe.value.forEach(((i,r)=>{const{width:o,height:a}=i.fileInfo,l=a*(s/o)+te.value+Y.value,u=X.value[i.id];if(t.length<e)u.style.top="0px",u.style.left=(s+se.value)*r+"px",t.push(l);else{const e=Math.min.apply(null,t),s=t.findIndex((s=>s===e));u.style.top=`${e+0}px`,u.style.left=s*(Z.value+se.value)+"px",t[s]+=l}})),oe.value=Math.max(...t)+130}const pe=v((()=>ue.value?V.value.filter((e=>{const{prompt:s}=e;return s.includes(ue.value)})):V.value));p(le,(()=>{ve()}));let ce=null;p(pe,(()=>{pe.value.length&&(clearTimeout(ce),ce=setTimeout((()=>{ve()}),300))}));const me=v((()=>e=>{const{fileInfo:s}=e,{width:t,height:i}=s;return i/(t/Z.value)})),de=o((function(){ve()}),200);return c((async()=>{await async function(){const e=await i({size:999,rec:1});V.value=e.data.rows}(),ve(),window.addEventListener("resize",de)})),m((()=>{window.removeEventListener("resize",de)})),(t,i)=>(y(),d("div",A,[_("div",L,[F,_("div",M,[T,_("div",U,[f($(k),{value:le.value,"onUpdate:value":i[0]||(i[0]=e=>le.value=e),step:10},null,8,["value"])])])]),_("div",D,[f($(C),{value:ue.value,"onUpdate:value":i[1]||(i[1]=e=>ue.value=e),placeholder:"prompt关键词搜索"},{prefix:j((()=>[f($(E),{component:$(l)},null,8,["component"])])),_:1},8,["value"])]),_("div",J,[_("div",{id:"wapper",ref_key:"wapperRef",ref:re,class:"wapper",style:z({height:`${oe.value}px`})},[(y(!0),d(h,null,x($(pe),((t,i)=>(y(),d("div",{id:t.id,key:i,ref_for:!0,ref:e=>function(e,s){e&&s&&(X.value[s.id]=e)}(e,t),class:"wapper-item",style:z({width:`${Z.value}px`})},[f(e,{name:"img",css:!0},{default:j((()=>[_("img",{id:t.id,class:"item-file rounded-sm",style:z({width:`${Z.value}px`,height:`${$(me)(t)}px`}),src:t.fileInfo.thumbImg,loading:"lazy",onLoad:e=>function(e,s){ie.value.push(s.id)}(0,t),onError:e=>function(e,s){ie.value.push(s.id)}(0,t),onClick:e=>function(e){const{fileInfo:s}=e,{cosUrl:t}=s;K({options:{},images:[t]})}(t)},null,44,P)])),_:2},1024),_("div",R,[_("div",B,q(t.fullPrompt),1),_("div",O,[g(q(t.createdAt)+" ",1),_("button",{class:"flex h-5 w-8 items-center justify-center rounded border transition hover:bg-[#666161] dark:border-neutral-700 dark:hover:bg-[#33373c]",onClick:s((e=>function(e){if(!ae.value)return H.setLoginDialog(!0);const{prompt:s}=e;a({text:s}),S.success("复制prompt成功")}(t)),["stop"])},[_("span",W,[f($(r),{icon:"tabler:copy",class:"text-sm"})])],8,Q)])]),ie.value.includes(t.id)?b("",!0):(y(),d("div",{key:0,class:"item-loading",style:z({width:`${Z.value}px`,height:`${$(me)(t)}px`})},null,4))],12,N)))),128))],4)])]))}});export{G as default};
