import{R as e}from"../index/index.aa9008ea.js";import{u as t,a as l,c as a,t as s,d as o,b as n,e as i,f as r,g as c,h as d,o as u,i as p,j as v,k as g,_ as f,l as m,m as h,n as x,w as k,F as y,r as b,N as w,p as C,q as A,s as _,v as L,x as F,y as j,z as T,A as I,B as z,C as B,D,E as M,G as E,H as $,I as S,J as R,K as N,L as V,M as q,O,P as U,Q as W,R as G,S as H,T as Z,U as P,V as J,W as K,X as Q,Y as X,Z as Y,$ as ee,a0 as te,a1 as le,a2 as ae,a3 as se,a4 as oe,a5 as ne,a6 as ie,a7 as re,a8 as ce}from"../main-b75778ed.js";import{M as de,H as ue,m as pe,a as ve,V as ge,p as fe,w as me,e as he,b as xe,v as ke,f as ye,_ as be,C as we,h as Ce,c as Ae}from"../file/file.e8b56299.js";import{c as _e}from"../index/index.a4f65e28.js";import"../Popconfirm/Popconfirm.23de069d.js";import"../LayoutSider/LayoutSider.9b96e2bc.js";import"../punycode@2.3.0/punycode@2.3.0.8a62a219.js";import"../katex/katex.19601d0c.js";function Le(){const e=t(),o=l(),n=a((()=>o.usingContext));return{usingContext:n,toggleUsingContext:function(){o.setUsingContext(!n.value),n.value?e.success(s("chat.turnOnContext")):e.warning(s("chat.turnOffContext"))}}}const Fe={key:0,class:"sticky top-0 left-0 right-0 z-30 border-b dark:border-neutral-800 bg-white/80 dark:bg-black/20 backdrop-blur"},je={class:"relative flex items-center justify-center min-w-0 overflow-hidden h-14"},Te={class:"max-w-screen-2xl flex w-full items-center px-4"},Ie={key:0,class:"flex items-center"},ze=v("div",{class:"flex-1 py-4 ele-drag"},null,-1),Be={key:1,class:"flex-1"},De=v("span",{class:"mr-0"},"新对话",-1),Me={class:"flex h-8 w-8 items-center justify-center rounded border transition hover:bg-[#eef0f3] dark:border-neutral-700 dark:hover:bg-[#33373c]"},Ee={class:"text-base text-slate-500 dark:text-slate-400"},$e={class:"flex items-center gap-4"},Se=o({__name:"index",props:{usingContext:{type:Boolean}},emits:["export","toggleUsingContext","clear","scrollBtn"],setup(e,{emit:s}){const o=n();Le(),t();const _=[{label:"Light",key:"light",icon:"ri:sun-foggy-line"},{label:"Dark",key:"dark",icon:"ri:moon-foggy-line"}];a((()=>{if(!F.activeConfig)return;const{modelTypeInfo:e,modelInfo:t}=F.activeConfig;return e&&t?`${null==e?void 0:e.label} / ${t.modelName}`:void 0}));const L=i(),F=l();r();const j=a((()=>L.siderCollapsed)),T=a((()=>F.getChatByGroupInfo())),{isMobile:I}=c(),z=a((()=>L.theme));function B(){L.setSiderCollapsed(!j.value)}async function D(){try{await F.updateChatTab("history"),await F.addNewChatGroup(),await F.queryMyGroup(),I.value&&L.setSiderCollapsed(!0)}catch(e){}}function M(){const e=document.querySelector("#scrollRef");e&&A((()=>e.scrollTop=0))}return a((()=>o.isLogin)),(e,t)=>{var l;return d(I)?(u(),p("header",Fe,[v("div",je,[v("div",Te,[d(I)?(u(),p("div",Ie,[v("button",{class:"flex items-center justify-center w-11 h-11",onClick:B},[j.value?(u(),g(d(f),{key:0,class:"text-2xl",icon:"ri:align-justify"})):(u(),g(d(f),{key:1,class:"text-2xl",icon:"ri:align-right"}))])])):m("",!0),v("h1",{class:"flex-1 px-4 ele-drag font-bold pr-6 overflow-hidden cursor-pointer select-none text-ellipsis whitespace-nowrap",onDblclick:M},h((null==(l=T.value)?void 0:l.title)??""),33),ze,d(I)?(u(),p("div",Be,[v("button",{class:"rounded w-full flex justify-center items-center",onClick:D},[x(d(f),{icon:"mingcute:add-line",class:"text-sm mr-0.5"}),De])])):m("",!0),d(I)?(u(),g(d(C),{key:2,trigger:"click"},{trigger:k((()=>[v("button",Me,[v("span",Ee,[x(d(f),{icon:"fluent:dark-theme-24-regular"})])])])),default:k((()=>[v("div",null,[v("div",$e,[(u(),p(y,null,b(_,(e=>x(d(w),{key:e.key,size:"small",type:e.key===z.value?"info":void 0,onClick:t=>d(L).setTheme(e.key)},{icon:k((()=>[x(d(f),{icon:e.icon},null,8,["icon"])])),_:2},1032,["type","onClick"]))),64))])])])),_:1})):m("",!0)])])])):m("",!0)}}}),Re=["onClick"],Ne={style:{"margin-right":"20px"}},Ve=["src"],qe={style:{"margin-bottom":"10px","font-weight":"bold"}},Oe={style:{height:"40px","font-size":"12px",color:"#9F9F9F",overflow:"hidden","text-overflow":"ellipsis"}},Ue=(e=>(B("data-v-1f86fa47"),e=e(),D(),e))((()=>v("div",{class:"recommend"},"推荐",-1))),We=M(o({__name:"index",setup(e){const l=_();c(),t();const s=L(),o=n(),i=F(),r=j([]);return T((()=>{!async function(){const e=await I({page:1,size:12,modelName:"",modelId:"",groupId:""});r.value=e.data.rows,console.log(e)}()})),a((()=>l.mineApps)),(e,t)=>(u(!0),p(y,null,b(r.value,(l=>(u(),p("div",{class:"list_item dark:bg-[#2E2E4C] bg-[#fff]",key:l.id,onRunApp:t[0]||(t[0]=(...t)=>e.handleChat&&e.handleChat(...t)),onClick:z((e=>async function(e){await i.addNewChat(e.id),i.updateGptsStore(!1),s.push("/gpts"),o.setSelectSiderIndex(o.appListIndex),o.selectSiderIndex=1}(l)),["stop"])},[v("div",Ne,[v("img",{src:l.logo},null,8,Ve)]),v("div",null,[v("div",qe,h(l.modelName),1),v("div",Oe,h(l.desc),1)]),Ue],40,Re)))),128))}}),[["__scopeId","data-v-1f86fa47"]]),Ge={class:"w-full"},He={class:"grid grid-cols-3 lg:grid-cols-3 xl:grid-cols-3 2xl:grid-cols-3 gap-4"},Ze=["onClick"],Pe={class:"mb-4"},Je=["onClick"],Ke={class:"line-clamp-2"},Qe=o({__name:"mobile",emits:["run"],setup(e,{emit:a}){l(),n(),t(),j(!1);const{isMobile:s}=c(),o=E({page:1,size:s.value?3:8});const i=a,r=j([]),g=e=>{i("run",e)};return T((()=>{!async function(){var e;const t=await S(o);r.value=null==(e=null==t?void 0:t.data)?void 0:e.rows.map((e=>{var t;return e.loading=!1,e.demoData=null==(t=e.demoData)?void 0:t.split("\n").slice(0,3),e}))}()})),(e,t)=>(u(),p("div",Ge,[v("ul",He,[(u(!0),p(y,null,b(r.value,(e=>(u(),p("li",null,[v("div",{class:"cursor-pointer",onClick:t=>g(e)},[x(d($),{round:"",size:42,src:e.coverImg},null,8,["src"]),v("p",Pe,h(e.name),1)],8,Ze),(u(!0),p(y,null,b(e.demoData,(t=>(u(),p("p",{class:"px-1 py-2 dark:bg-[#42425F] bg-[#f5f5f5] my-3 rounded cursor-pointer",onClick:l=>g({id:e.id,demoData:t})},[v("span",Ke,h(t),1)],8,Je)))),256))])))),256))])]))}}),Xe={style:{height:"100%"},class:"w-full"},Ye={style:{display:"flex","flex-wrap":"wrap","justify-content":"space-between",height:"100%","overflow-y":"scroll","background-color":"transparent"},class:"w-full overflow-hidden"},et={key:0},tt={class:"mt-4 grid grid-cols-1 sm:grid-cols-1 md:grid-cols-1 lg:grid-cols-1 xl:grid-cols-2 2xl:grid-cols-4 gap-6"},lt={class:"flex justify-start items-center"},at={class:"flex justify-between"},st=o({__name:"index",emits:["run"],setup(e,{emit:a}){l(),n(),t(),j(!1),R();const{isMobile:s}=c(),o=E({page:1,size:s.value?3:12});const i=a,r=j([]),f=e=>{i("run",e)};return T((()=>{!async function(){var e;const t=await S(o);r.value=null==(e=null==t?void 0:t.data)?void 0:e.rows.map((e=>(e.loading=!1,e)))}()})),(e,t)=>(u(),p("div",Xe,[v("div",{style:{padding:"10px 0 0 0",height:"100%"},class:q(["suggest-container w-full max-w-screen-2xl dark:bg-[#1A1D21] bg-[#fff]",[d(s)?"":"bg-[#F7F7F7] dark:bg-[#313155] pt-4 px-6 pb-6 rounded-xl"]])},[v("div",Ye,[r.value.length?m("",!0):(u(),p("div",et,[v("div",tt,[(u(),p(y,null,b(12,(e=>x(d(V),{vertical:"",class:"border border-gray-200 dark:border-gray-600 rounded hover:bg-neutral-100 dark:bg-[#3A3A5E] dark:hover:bg-[#24272e] px-4 py-2 pb-4"},{default:k((()=>[v("div",lt,[x(d(N),{round:"",height:"50px",width:"20%",class:"mt-1",sharp:!1}),x(d(N),{height:"20px",width:"20%",class:"mt-1 ml-4",sharp:!1})]),x(d(N),{height:"40px",width:"100%",class:"mt-1",sharp:!1}),v("div",at,[x(d(N),{height:"20px",width:"30%",class:"mt-1",sharp:!1}),x(d(N),{height:"20px",width:"10%",class:"mt-1",sharp:!1})])])),_:1}))),64))])])),d(s)?(u(),g(Qe,{key:2,onRunApp:f,list:r.value},null,8,["list"])):(u(),g(We,{key:1,onRunApp:f,list:r.value},null,8,["list"]))])],2)]))}}),ot={style:{height:"100%"},class:"w-full md:min-w-[450px]"},nt=o({__name:"index",emits:["run-app"],setup(e,{emit:t}){const l=t;function a(e){l("run-app",e)}n();const{isMobile:s}=c();return(e,t)=>(u(),p("div",{style:{padding:"0",margin:"0",height:"100%"},class:q([[d(s)?"mt-2":""],"w-full px-4 py-4"])},[v("div",ot,[x(st,{onRun:a})])],2))}}),it={key:1,class:"text-[28px] dark:text-white"},rt={key:1,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32","aria-hidden":"true",width:"1em",height:"1em"},ct=[v("path",{d:"M29.71,13.09A8.09,8.09,0,0,0,20.34,2.68a8.08,8.08,0,0,0-13.7,2.9A8.08,8.08,0,0,0,2.3,18.9,8,8,0,0,0,3,25.45a8.08,8.08,0,0,0,8.69,3.87,8,8,0,0,0,6,2.68,8.09,8.09,0,0,0,7.7-5.61,8,8,0,0,0,5.33-3.86A8.09,8.09,0,0,0,29.71,13.09Zm-12,16.82a6,6,0,0,1-3.84-1.39l.19-.11,6.37-3.68a1,1,0,0,0,.53-.91v-9l2.69,1.56a.08.08,0,0,1,.05.07v7.44A6,6,0,0,1,17.68,29.91ZM4.8,24.41a6,6,0,0,1-.71-4l.19.11,6.37,3.68a1,1,0,0,0,1,0l7.79-4.49V22.8a.09.09,0,0,1,0,.08L13,26.6A6,6,0,0,1,4.8,24.41ZM3.12,10.53A6,6,0,0,1,6.28,7.9v7.57a1,1,0,0,0,.51.9l7.75,4.47L11.85,22.4a.14.14,0,0,1-.09,0L5.32,18.68a6,6,0,0,1-2.2-8.18Zm22.13,5.14-7.78-4.52L20.16,9.6a.08.08,0,0,1,.09,0l6.44,3.72a6,6,0,0,1-.9,10.81V16.56A1.06,1.06,0,0,0,25.25,15.67Zm2.68-4-.19-.12-6.36-3.7a1,1,0,0,0-1.05,0l-7.78,4.49V9.2a.09.09,0,0,1,0-.09L19,5.4a6,6,0,0,1,8.91,6.21ZM11.08,17.15,8.38,15.6a.14.14,0,0,1-.05-.08V8.1a6,6,0,0,1,9.84-4.61L18,3.6,11.61,7.28a1,1,0,0,0-.53.91ZM12.54,14,16,12l3.47,2v4L16,20l-3.47-2Z",fill:"currentColor"},null,-1)],dt=o({__name:"Avatar",props:{image:{type:Boolean}},setup(e){const{isMobile:t}=c(),l=n(),s=a((()=>l.userInfo.avatar)),o=a((()=>l.globalConfig.robotAvatar));return(e,l)=>e.image?(u(),p(y,{key:0},[d(O)(s.value)&&s.value.length>0?(u(),g(d($),{key:0,round:"",size:d(t)?32:42,src:s.value,"fallback-src":d(U)},null,8,["size","src","fallback-src"])):(u(),g(d($),{key:1,round:"",size:d(t)?32:42,src:d(U)},null,8,["size","src"]))],64)):(u(),p("span",it,[d(O)(o.value)&&o.value.length>0?(u(),g(d($),{key:0,style:{"background-color":"transparent"},rounded:"",size:d(t)?32:42,src:o.value,"fallback-src":d(U)},null,8,["size","src","fallback-src"])):(u(),p("svg",rt,ct))]))}});var ut={size:"1em",strokeWidth:4,strokeLinecap:"round",strokeLinejoin:"round",rtl:!1,theme:"outline",colors:{outline:{fill:"#333",background:"transparent"},filled:{fill:"#333",background:"#FFF"},twoTone:{fill:"#333",twoTone:"#2F88FF"},multiColor:{outStrokeColor:"#333",outFillColor:"#2F88FF",innerStrokeColor:"#FFF",innerFillColor:"#43CCF8"}},prefix:"i"};var pt=Symbol("icon-context");function vt(e,t,l){return{name:"icon-"+e,props:["size","strokeWidth","strokeLinecap","strokeLinejoin","theme","fill","spin"],setup:function(a){var s="icon-"+(4294967296*(1+Math.random())|0).toString(16).substring(1),o=W(pt,ut);return function(){var n=a.size,i=a.strokeWidth,r=a.strokeLinecap,c=a.strokeLinejoin,d=a.theme,u=a.fill,p=a.spin,v=function(e,t,l){var a="string"==typeof t.fill?[t.fill]:t.fill||[],s=[];switch(t.theme||l.theme){case"outline":s.push("string"==typeof a[0]?a[0]:"currentColor"),s.push("none"),s.push("string"==typeof a[0]?a[0]:"currentColor"),s.push("none");break;case"filled":s.push("string"==typeof a[0]?a[0]:"currentColor"),s.push("string"==typeof a[0]?a[0]:"currentColor"),s.push("#FFF"),s.push("#FFF");break;case"two-tone":s.push("string"==typeof a[0]?a[0]:"currentColor"),s.push("string"==typeof a[1]?a[1]:l.colors.twoTone.twoTone),s.push("string"==typeof a[0]?a[0]:"currentColor"),s.push("string"==typeof a[1]?a[1]:l.colors.twoTone.twoTone);break;case"multi-color":s.push("string"==typeof a[0]?a[0]:"currentColor"),s.push("string"==typeof a[1]?a[1]:l.colors.multiColor.outFillColor),s.push("string"==typeof a[2]?a[2]:l.colors.multiColor.innerStrokeColor),s.push("string"==typeof a[3]?a[3]:l.colors.multiColor.innerFillColor)}return{size:t.size||l.size,strokeWidth:t.strokeWidth||l.strokeWidth,strokeLinecap:t.strokeLinecap||l.strokeLinecap,strokeLinejoin:t.strokeLinejoin||l.strokeLinejoin,colors:s,id:e}}(s,{size:n,strokeWidth:i,strokeLinecap:r,strokeLinejoin:c,theme:d,fill:u},o),g=[o.prefix+"-icon"];return g.push(o.prefix+"-icon-"+e),t&&o.rtl&&g.push(o.prefix+"-icon-rtl"),p&&g.push(o.prefix+"-icon-spin"),x("span",{class:g.join(" ")},[l(v)])}}}}const gt=vt("comment",!0,(function(e){return x("svg",{width:e.size,height:e.size,viewBox:"0 0 48 48",fill:"none"},[x("path",{d:"M44 6H4V36H13V41L23 36H44V6Z",fill:e.colors[1],stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),x("path",{d:"M14 19.5V22.5",stroke:e.colors[2],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),x("path",{d:"M24 19.5V22.5",stroke:e.colors[2],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),x("path",{d:"M34 19.5V22.5",stroke:e.colors[2],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null)])})),ft=vt("copy",!0,(function(e){return x("svg",{width:e.size,height:e.size,viewBox:"0 0 48 48",fill:"none"},[x("path",{d:"M13 12.4316V7.8125C13 6.2592 14.2592 5 15.8125 5H40.1875C41.7408 5 43 6.2592 43 7.8125V32.1875C43 33.7408 41.7408 35 40.1875 35H35.5163",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),x("path",{d:"M32.1875 13H7.8125C6.2592 13 5 14.2592 5 15.8125V40.1875C5 41.7408 6.2592 43 7.8125 43H32.1875C33.7408 43 35 41.7408 35 40.1875V15.8125C35 14.2592 33.7408 13 32.1875 13Z",fill:e.colors[1],stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linejoin":e.strokeLinejoin},null)])})),mt=vt("delete",!1,(function(e){return x("svg",{width:e.size,height:e.size,viewBox:"0 0 48 48",fill:"none"},[x("path",{d:"M9 10V44H39V10H9Z",fill:e.colors[1],stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linejoin":e.strokeLinejoin},null),x("path",{d:"M20 20V33",stroke:e.colors[2],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),x("path",{d:"M28 20V33",stroke:e.colors[2],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),x("path",{d:"M4 10H44",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),x("path",{d:"M16 10L19.289 4H28.7771L32 10H16Z",fill:e.colors[1],stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linejoin":e.strokeLinejoin},null)])})),ht=vt("refresh",!0,(function(e){return x("svg",{width:e.size,height:e.size,viewBox:"0 0 48 48",fill:"none"},[x("path",{d:"M42 8V24",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),x("path",{d:"M6 24L6 40",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),x("path",{d:"M42 24C42 14.0589 33.9411 6 24 6C18.9145 6 14.3216 8.10896 11.0481 11.5M6 24C6 33.9411 14.0589 42 24 42C28.8556 42 33.2622 40.0774 36.5 36.9519",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null)])})),xt={key:0,class:"flex flex-col items-start",style:{width:"100%"}},kt={class:"w-full"},yt={class:"dark:bg-[#1C2635] bg-[#F5F8FE] p-2 rounded-md dark:text-[#ffffff] text-[#3378ED]"},bt=["innerHTML"],wt=["textContent"],Ct={style:{display:"flex","justify-content":"space-between","align-items":"center"}},At={class:"mt-4 flex items-center"},_t={class:"text-xs text-[#888]"},Lt={class:"flex"},Ft={class:"bg-[#f4f4f4] dark:bg-[#15171A]",style:{"margin-top":"12px","border-radius":"5px",padding:"0 10px"}},jt=v("span",{class:"text-xs leading-none mt-0.5"},"重新回答",-1),Tt=v("span",{class:"ml-4"},null,-1),It={class:"bg-[#f4f4f4] dark:bg-[#15171A]",style:{"margin-top":"12px","border-radius":"5px",padding:"0 10px"}},zt=v("span",{class:"text-xs leading-none mt-0.5"},"复制",-1),Bt=v("span",{class:"ml-4"},null,-1),Dt={class:"bg-[#f4f4f4] dark:bg-[#15171A]",style:{"margin-top":"12px","border-radius":"5px",padding:"0 10px"}},Mt=v("span",{class:"text-xs leading-none mt-0.5"},"删除",-1),Et={class:"dark:text-[#484A4D] text-[#A3A5A6]"},$t={key:1},St=["innerHTML"],Rt=["textContent"],Nt={style:{display:"flex","justify-content":"space-between","align-items":"center"}},Vt={class:"flex"},qt={class:"bg-[#f4f4f4] dark:bg-[#15171A]",style:{"margin-top":"12px","border-radius":"5px",padding:"0 10px"}},Ot=v("span",{class:"text-xs leading-none mt-0.5"},"重新提问",-1),Ut=v("span",{class:"ml-4"},null,-1),Wt={class:"bg-[#f4f4f4] dark:bg-[#15171A]",style:{"margin-top":"12px","border-radius":"5px",padding:"0 10px"}},Gt=v("span",{class:"text-xs leading-none mt-0.5"},"复制",-1),Ht=v("span",{class:"ml-4"},null,-1),Zt={class:"bg-[#f4f4f4] dark:bg-[#15171A]",style:{"margin-top":"12px","border-radius":"5px",padding:"0 10px"}},Pt=v("span",{class:"text-xs leading-none mt-0.5"},"删除",-1),Jt={class:"dark:text-[#484A4D] text-[#A3A5A6]"},Kt=o({__name:"Text",props:{inversion:{type:Boolean},error:{type:Boolean},text:{},loading:{type:Boolean},asRawText:{type:Boolean},dateTime:{},chatTail:{}},emits:["regenerate","delete","copy"],setup(e,{expose:t,emit:l}){const o=e,n=l,{isMobile:i}=c(),r=j(),g=new de({linkify:!0,html:!0,highlight(e,t){if(!(!t||!ue.getLanguage(t))){const l=t??"";return y(ue.highlight(e,{language:l}).value,l)}return y(ue.highlightAuto(e).value,"")}}).enable("image");g.use(pe,{attrs:{target:"_blank",rel:"noopener"}}),g.use(ve,{blockClass:"katexmath-block rounded-md p-[10px]",errorColor:" #cc0000"});const f=a((()=>["text-wrap","rounded-md",i.value?"p-2":"px-3 py-2",o.inversion?"dark:text-[#fff]":"dark:text-[#000]",o.inversion?"message-request":"message-reply",{"text-red-500":o.error}])),m=a((()=>{const e=o.text??"";if(!o.asRawText){if(e.includes("uploaded")){const t=(e=>{const t=e.match(/(https?|http|ftp|file):\/\/[-A-Za-z0-9+&@#/%?=~_|!:,.;]+[-A-Za-z0-9+&@#/%=~_|]/g);return t&&t.length>0?t[0]:""})(e);if(ge.isImg(e)){const l=e.replace(` ${t}`,`[![${t}](${t})](${t})`);return g.render(l)}if(ge.isPdf(e)){const l=e.replace(` ${t}`,`[![${t}](${fe})](${t})`);return g.render(l)}if(ge.isWord(e)){const l=e.replace(` ${t}`,`[![${t}](${me})](${t})`);return g.render(l)}if(ge.isExcel(e)){const l=e.replace(` ${t}`,`[![${t}](${he})](${t})`);return g.render(l)}if(ge.isPPt(e)){const l=e.replace(` ${t}`,`[![${t}](${xe})](${t})`);return g.render(l)}if(ge.isVoice(e)){const l=e.replace(` ${t}`,`<audio id="audio" controls  controlslist="noplaybackrate nodownload" poster="${ke}" preload="none"> <source id="mp3" src="${t}"></audio>\n `);return g.render(l)}const l=e.replace(` ${t}`,`[![${t}](${ye})](${t})`);return g.render(l)}return g.render(e)}return e}));function y(e,t){return`<pre class="code-block-wrapper"><div class="code-block-header"><span class="code-block-header__lang">${t}</span><span class="code-block-header__copy">${s("chat.copyCode")}</span></div><code class="hljs code-block-body ${t}">${e}</code></pre>`}function b(){n("regenerate")}function C(){n("copy")}function A(){n("delete")}function _(e){var t=36e5,l=24*t,a=30*l;var s=(new Date).getTime()-Date.parse(e.replace(/-/gi,"-")),o=s/a,n=s/(7*l),i=s/l,r=s/t,c=s/6e4;return o>=1?parseInt(o)+"个月前":n>=1?"发表于"+parseInt(n)+"周前":i>=1?parseInt(i)+"天前":r>=1?parseInt(r)+"个小时前":c>=1?parseInt(c)+"分钟前":"刚刚"}return t({textRef:r}),(e,t)=>(u(),p("div",{class:q([f.value,"w-full"])},[v("div",{ref_key:"textRef",ref:r,class:"leading-relaxed break-words",style:{width:"100%"}},[e.inversion?(u(),p("div",$t,[v("div",null,[v("div",{class:q([o.inversion?"bg-[#F1F5F1]  dark:bg-[#15171A]":"bg-[#FBFBFB] dark:bg-[#33334D]","p-2 rounded-md"])},[e.asRawText?(u(),p("div",{key:1,class:"w-full whitespace-pre-wrap",textContent:h(m.value)},null,8,Rt)):(u(),p("div",{key:0,class:q(["w-full markdown-body",{"markdown-body-generate":e.loading}]),innerHTML:m.value},null,10,St))],2),v("div",Nt,[v("div",Vt,[v("div",qt,[x(d(w),{text:"",onClick:b},{icon:k((()=>[x(d(G),{size:10,component:d(ht)},null,8,["component"])])),default:k((()=>[Ot])),_:1})]),Ut,v("div",Wt,[x(d(w),{class:"ml-2",text:"",onClick:C},{icon:k((()=>[x(d(G),{size:10,component:d(ft)},null,8,["component"])])),default:k((()=>[Gt])),_:1})]),Ht,v("div",Zt,[x(d(w),{text:"",onClick:A},{icon:k((()=>[x(d(G),{size:10,component:d(mt)},null,8,["component"])])),default:k((()=>[Pt])),_:1})])]),v("div",Jt,h(_(e.dateTime)),1)])])])):(u(),p("div",xt,[v("div",kt,[v("div",yt,[e.asRawText?(u(),p("div",{key:1,class:"w-full whitespace-pre-wrap",textContent:h(m.value)},null,8,wt)):(u(),p("div",{key:0,class:q(["w-full",{"markdown-body-generate":e.loading}]),innerHTML:m.value},null,10,bt))]),v("div",Ct,[v("div",null,[v("div",At,[x(d(G),{size:12,component:d(gt),class:"mr-1.5 text-[#2F88FF]"},null,8,["component"]),v("p",_t,h(e.chatTail),1)]),v("div",Lt,[v("div",Ft,[x(d(w),{text:"",onClick:b},{icon:k((()=>[x(d(G),{size:10,component:d(ht)},null,8,["component"])])),default:k((()=>[jt])),_:1})]),Tt,v("div",It,[x(d(w),{class:"ml-2",text:"",onClick:C},{icon:k((()=>[x(d(G),{size:10,component:d(ft)},null,8,["component"])])),default:k((()=>[zt])),_:1})]),Bt,v("div",Dt,[x(d(w),{text:"",onClick:A},{icon:k((()=>[x(d(G),{size:10,component:d(mt)},null,8,["component"])])),default:k((()=>[Mt])),_:1})])])]),v("div",Et,h(_(e.dateTime)),1)])])]))],512)],2))}}),Qt={class:"flex items-center justify-center flex-shrink-0 mt-1 mr-2"},Xt=o({__name:"index",props:{dateTime:{},text:{},inversion:{type:Boolean},error:{type:Boolean},loading:{type:Boolean},chatTail:{}},emits:["regenerate","delete"],setup(e,{emit:l}){var a;const s=e,o=l,n=t();c();const i=j(),r=j(s.inversion&&!(null==(a=s.text)?void 0:a.includes("https://"))&&!((d=null==s?void 0:s.text)&&/(.*)\.(jpg|bmp|gif|ico|pcx|jpeg|tif|png)$/.test(d)));var d;const g=j();function f(){o("delete")}function m(){_e({text:s.text??""}),s.text&&n.success("复制成功！")}function h(){var e;null==(e=g.value)||e.scrollIntoView(!1,{behavior:"smooth"}),o("regenerate")}return(e,t)=>(u(),p("div",{ref_key:"messageRef",ref:g,class:"flex max-w-full mb-6 overflow-hidden items-start"},[v("div",Qt,[x(dt,{image:e.inversion},null,8,["image"])]),v("div",{class:q(["text-sm",[e.inversion?"items-end":"items-start"]]),style:{width:"100%"}},[v("div",{class:q(["flex items-end gap-1 mt-2",[e.inversion?"flex-row-reverse":"flex-row"]])},[x(Kt,{ref_key:"textRef",ref:i,chatTail:e.chatTail,dateTime:e.dateTime,inversion:e.inversion,error:e.error,text:e.text,loading:e.loading,"as-raw-text":r.value,onRegenerate:h,onCopy:m,onDelete:f},null,8,["chatTail","dateTime","inversion","error","text","loading","as-raw-text"])],2)],2)],512))}});const Yt=e=>(B("data-v-9a0ffd80"),e=e(),D(),e),el={class:"flex-1 overflow-hidden"},tl={key:0,class:"main_content"},ll=Yt((()=>v("div",{class:"main_title"},[v("div",{style:{"font-size":"35px"},class:"text-[#000] dark:text-[#fff]"},[ee("欢迎使用 "),v("span",{style:{color:"#7ABBFF"}},"聊一聊")]),v("div",{style:{"font-size":"14px"},class:"text-[#818181] dark:text-[#A1A1A1]"},"由最先进AI支持的人类助手")],-1))),al={class:"type"},sl=Yt((()=>v("div",{class:"dark:text-[#E6E6E6] text-[#7F7F7F]"},"选择开始的方式",-1))),ol={class:"type_item dark:bg-[#010102] bg-[#F4F4F4]"},nl=Yt((()=>v("div",null,"直接开始",-1))),il=Yt((()=>v("div",null,"其他应用",-1))),rl={key:0,class:"session_type"},cl=Yt((()=>v("div",{class:"session_type_title"},"高级对话",-1))),dl={class:"item_card"},ul={class:"item dark:bg-[#202B3A] bg-[#F5F8FE]"},pl=Yt((()=>v("div",{style:{"font-size":"17px","font-weight":"bold"},class:"text-[#03060C] dark:text-[#fff]"}," PDF 问答/数据分析（基础版） ",-1))),vl=Yt((()=>v("div",{style:{"font-size":"14px","padding-top":"20px"},class:"dark:text-[#76777A] text-[#A3A5A6]"},"支持常见文件类型，最大25M",-1))),gl={class:"img_card dark:text-[#76777A] text-[#A3A5A6]"},fl={key:0},ml=[Yt((()=>v("div",{style:{"font-size":"17px","font-weight":"bold"},class:"text-[#03060C] dark:text-[#fff]"}," Dall-E绘画 ",-1))),Yt((()=>v("div",{class:"item_btn border-[2px] border-[#3378ED] text-[#3378ED] dark:text-[#2960BE]"}," 开始画图 ",-1))),Yt((()=>v("div",{class:"dark:text-[#76777A] text-[#A3A5A6]",style:{"font-size":"14px","padding-top":"20px"}},"支持常见文件类型，最大25M",-1))),Yt((()=>v("div",{class:"img_card dark:text-[#76777A] text-[#A3A5A6]"},[v("div",null,"dall-e-3模型")],-1)))],hl={class:"item dark:bg-[#202B3A] bg-[#F5F8FE]"},xl=Yt((()=>v("div",{style:{"font-size":"17px","font-weight":"bold"},class:"text-[#03060C] dark:text-[#fff]"}," 图片对话 ",-1))),kl=Yt((()=>v("div",{style:{"font-size":"14px","padding-top":"20px"},class:"dark:text-[#76777A] text-[#A3A5A6]"},"支持常见文件类型，最大25M",-1))),yl={class:"img_card dark:text-[#76777A] text-[#A3A5A6]"},bl={key:0},wl={key:1,class:"apply_card"},Cl=Yt((()=>v("div",{class:"tips_tag"},[v("div",{class:"tag_item"},"多模型场景"),v("div",{class:"tag_item"},"场景方案"),v("div",{class:"tag_item"},"工作流")],-1))),Al={class:"title_card"},_l=Yt((()=>v("div",null,"从收藏和创建的AI应用中选择",-1))),Ll={class:"right_tag"},Fl=Yt((()=>v("div",null,"应用中心",-1))),jl=Yt((()=>v("div",null,"创建应用",-1))),Tl={class:"apply_list"},Il={class:"sticky bottom-0 left-0 flex justify-center"},zl={key:0,class:"footer-dialog bg-[#fff] dark:bg-[#1A1D21] ml-6 mr-3",style:{"border-radius":"0 0 10px 10px"}},Bl={class:"flex justify-between"},Dl={class:"flex justify-center items-center"},Ml={key:0},El={class:"flex justify-center items-center"},$l={key:0},Sl={class:"flex justify-center items-center"},Rl={class:"text-white mr-0.5"},Nl={class:"mb-2"},Vl={class:"flex justify-center items-center"},ql=Yt((()=>v("span",{class:"dark:text-[#A3A5A6] text-[#76777A]"},"清空",-1))),Ol={class:"flex items-stretch space-x-2"},Ul={style:{"border-radius":"8px",position:"relative","padding-bottom":"10px","margin-top":"10px"},class:"relative flex-1 bg-[#f4f4f4] dark:bg-[#15171A]"},Wl={class:"absolute bottom-6 right-2"},Gl={class:"flex items-center justify-between"},Hl={class:"flex justify-between items-center"},Zl=Yt((()=>v("div",{style:{"margin-right":"10px"}},"发送",-1))),Pl=M(o({__name:"chatBase",setup(e){const o=r(),C=R(),_=n(),L=Z();let F=new AbortController;R();const I=P(),z=t(),B=i(),D=j(),M=l(),E=j(!1),$=j(!0),S=j(0),{addGroupChat:N,updateGroupChat:V,updateGroupChatSome:O}=function(){const e=l();return{addGroupChat:t=>{e.addGroupChat(t)},updateGroupChat:(t,l)=>{e.updateGroupChat(t,l)},updateGroupChatSome:(t,l)=>{e.updateGroupChatSome(t,l)}}}(),U=a((()=>L.query.appId)),W=a((()=>L.query.trade_status)),G=a((()=>L.query.token)),ce=a((()=>C.runApp));!function(){function e(){document.querySelectorAll(".code-block-wrapper").forEach((e=>{const t=e.querySelector(".code-block-header__copy"),l=e.querySelector(".code-block-body");t&&l&&t.addEventListener("click",(()=>{var e;(null==(e=navigator.clipboard)?void 0:e.writeText)?navigator.clipboard.writeText(l.textContent??""):_e({text:l.textContent??"",origin:!0})}))}))}T((()=>e())),H((()=>e()))}();const{isMobile:de}=c(),{scrollRef:ue,scrollToBottom:pe,scrollToBottomIfAtBottom:ve}=function(){const e=j(null);return{scrollRef:e,scrollToBottom:async()=>{await A(),e.value&&(e.value.scrollTop=e.value.scrollHeight)},scrollToTop:async()=>{await A(),e.value&&(e.value.scrollTop=0)},scrollToBottomIfAtBottom:async()=>{if(await A(),e.value){const t=150;e.value.scrollHeight-e.value.scrollTop-e.value.clientHeight<=t&&(e.value.scrollTop=e.value.scrollHeight)}}}}(),{usingContext:ge,toggleUsingContext:fe}=Le(),{usingNetwork:me}=function(){const e=t(),s=l(),o=a((()=>s.usingNetwork));return{usingNetwork:o,toggleUsingNetwork:function(){s.setUsingNetwork(!o.value),o.value?e.success("已开启联网模式、上下文状态失效！"):e.warning("已关闭联网模式！")}}}(),he=a((()=>M.chatList)),xe=a((()=>M.canUpload)),ke=a((()=>M.canAudio)),{selectFile:ye,upload:Fe}=J(),je=a((()=>he.value.filter((e=>!e.inversion&&!e.error)))),Te=j(""),Ie=j(!1),ze=j(null),Be=j(!0),De=j(""),Me=a((()=>M.active)),Ee=a((()=>M.groupList.find((e=>e.uuid===Me.value)))),$e=a((()=>Number(null==M?void 0:M.activeModelKeyType))),Re=a((()=>Ie.value||!Te.value||""===Te.value.trim()||!$.value));async function Ne(){o.updateRecordDialog(!0)}async function Ve(e=1){let t;if(1===e){if(t=await ye(),!t)return void z.error("选择文件错误")}else t=e;o.updateUploadDialog(!0);const l=await Fe({purpose:"assistants",file:t},(e=>{const{progress:t,loaded:l,total:a}=e;t&&100*Number(t.toFixed(2))<=99&&o.updateUploadProgress(100*Number(t.toFixed(2)))}));l.data&&(o.updateUploadProgress(100),o.updateUploadDialog(!1),Te.value=1===e?"请分析一下上传的这个文件 "+l.data:"请将语音转换成文本 "+l.data),1!==e&&o.updateRecordDialog(!1)}async function qe(e){if(0===M.groupList.length||Ie.value||!$.value)return;let t="";if(e&&"number"==typeof e){const{requestOptions:l}=he.value[e];t=(null==l?void 0:l.prompt)??""}!async function(e){var t;let l=e||Te.value;if(Ie.value)return;if(!l||""===l.trim())return;F=new AbortController,N({dateTime:(new Date).toLocaleString(),text:l,inversion:!0,error:!1,conversationOptions:null,requestOptions:{prompt:l,options:null}}),pe(),Ie.value=!0,Te.value="";let a={groupId:+Me.value,usingNetwork:me.value};const n=null==(t=je.value[je.value.length-1])?void 0:t.conversationOptions;n&&ge.value&&!me.value&&(a={...n,...a});N({dateTime:(new Date).toLocaleString(),text:"AI思考中",loading:!0,inversion:!1,error:!1,conversationOptions:null,requestOptions:{prompt:l,options:{...a}}}),pe();let i=null,r="",c="",d=0,u=null;E.value=!0;let p={};o.updateIsChatIn(!0);try{const e=async()=>{i=setInterval((async()=>{var e,t;if(r[d]&&c.length<r.length&&(c+=r[d]),r[d]&&($.value=!1,V(he.value.length-1,{dateTime:(new Date).toLocaleString(),text:c,inversion:!1,usage:null==(e=null==u?void 0:u.detail)?void 0:e.usage,error:!1,loading:!0,conversationOptions:{conversationId:null==u?void 0:u.conversationId,parentMessageId:null==u?void 0:u.id},requestOptions:{prompt:l,options:{...a}}}),ve(),d++),!E.value&&c.length>=r.length){if(d=0,c="",i&&clearInterval(i),i=null,$.value=!0,O(he.value.length-1,{loading:!1}),o.updateIsChatIn(!1),p&&_.updateUserBanance(p),2===he.value.length&&!(null==(t=null==Ee?void 0:Ee.value)?void 0:t.appId)){const e=he.value[1].text.length>15?he.value[1].text.slice(0,15):he.value[1].text;await M.updateGroupInfo({groupId:+Me.value,title:e}),await M.queryMyGroup()}ve()}}),16),await oe({prompt:l,appId:Ee.value?Ee.value.appId:0,options:a,signal:F.signal,onDownloadProgress:({event:e})=>{var t;const l=e.target,{responseText:a}=l;if([1].includes($e.value)){const e=a.lastIndexOf("\n",a.length-2);let t=a;-1!==e&&(t=a.substring(e));try{u=JSON.parse(t)}catch(s){console.log("parse data erro from openai: ",s,t),t.includes("OpenAI timed out waiting for response")&&(console.log("绘画超时了~"),z.warning("会话超时了、告知管理员吧~~~"))}}if([2,3].includes($e.value)){const e=a.toString().split("\n").filter((e=>""!==e.trim()));let t="",l={};for(const a of e)try{const e=JSON.parse(a);t+=e.result,l=e}catch(s){console.log("Json parse 2 3 type error: ",a)}l.result=t,u=l}if([4].includes($e.value)){const e=a.lastIndexOf("\n",a.length);let t=a;-1!==e&&(t=a.substring(e));try{u=JSON.parse(t)}catch(s){console.log("parse data error from xunfeizhipu: ",s,t),t.includes("xunfeizhipu timed out waiting for response")&&(console.log("绘画超时了~"),z.warning("会话超时了、告知管理员吧~~~"))}}try{if([1].includes($e.value)&&(r=u.text,E.value=!u.is_end,(null==(t=null==u?void 0:u.detail)?void 0:t.usage)&&($.value=u.is_end,p=null==u?void 0:u.userBanance)),[2,3].includes($e.value)){const{result:e,is_end:t}=u;r=e,E.value=!t,(null==u?void 0:u.userBanance)&&(p=null==u?void 0:u.userBanance)}if([4].includes($e.value)){const{text:e,is_end:t}=u;r=e,E.value=!t,(null==u?void 0:u.userBanance)&&(p=null==u?void 0:u.userBanance)}}catch(s){console.log(s)}}})};await e()}catch(v){console.log("chat error catch",v),o.updateIsChatIn(!1),clearInterval(i),E.value=!1,(402===v.code||(null==v?void 0:v.message.includes("余额不足"))||(null==v?void 0:v.message.includes("免费额度已经使用完毕")))&&o.updateVipDialog(!0);let e=(null==v?void 0:v.message)??s("common.wrong");if("Request failed with status code 401"===e&&(e="非法操作、请先登录后再进行问答使用！"),null==v?void 0:v.message.includes("canceled"))return O(he.value.length-1,{loading:!1}),ve(),void setTimeout((()=>{_.getUserBalance()}),200);const t=he.value[he.value.length-1];if((null==t?void 0:t.text)&&""!==t.text)return void O(he.value.length-1,{text:`${"AI思考中"===t.text?"":t.text}\n[${e}]`,error:!1,loading:!1});V(he.value.length-1,{dateTime:(new Date).toLocaleString(),text:e,inversion:!1,error:!0,loading:!1,conversationOptions:null,requestOptions:{prompt:l,options:{...a}}}),ve()}finally{console.log("finally",Ie.value),Ie.value=!1,E.value=!1}}(t)}async function Oe(e){const t=+e;await ne.replace({name:"Chat",query:{}});const l=M.groupList.find((e=>e.appId===t));var a;l?await M.setActiveGroup(l.uuid):(await M.addNewChatGroup(t),await M.queryMyGroup()),Te.value&&(a=Te.value,Te.value=a,qe())}function Ue(){if(Ie.value)return;const e=I.warning({title:s("chat.exportImage"),content:s("chat.exportImageConfirm"),positiveText:s("common.yes"),negativeText:s("common.no"),onPositiveClick:async()=>{try{e.loading=!0;const t=document.getElementById("image-wrapper"),l=(await Ce(t,{useCORS:!0})).toDataURL("image/png"),a=document.createElement("a");return a.style.display="none",a.href=l,a.setAttribute("download","chat-shot.png"),void 0===a.download&&a.setAttribute("target","_blank"),document.body.appendChild(a),a.click(),document.body.removeChild(a),window.URL.revokeObjectURL(l),e.loading=!1,z.success(s("chat.exportSuccess")),Promise.resolve(!0)}catch(t){z.error(s("chat.exportFailed"))}finally{e.loading=!1}}})}function We(){Ie.value||I.create({title:s("chat.clearChat"),content:s("chat.clearChatConfirm"),positiveText:s("common.yes"),negativeText:s("common.no"),onPositiveClick:async()=>{await M.clearChatByGroupId(),z.success("删除当前页面对话完成")}})}function Ge(e){de.value?"Enter"===e.key&&e.ctrlKey&&(e.preventDefault(),qe()):"Enter"!==e.key||e.shiftKey||(e.preventDefault(),qe())}function He(){Ie.value&&(F.abort(),Ie.value=!1,E.value=!1,$.value=!0)}K(Me,(e=>{var t;e&&(Be.value=!0),ze.value&&!de.value&&(null==(t=ze.value)||t.focus())}),{immediate:!0}),K(he,(e=>{0!==e.length&&Be.value&&(Be.value=!1,pe())}),{immediate:!0});const Ze=async e=>{if(e.id&&e.demoData)return Te.value=e.demoData,await Oe(e.id),void(await M.updateChatTab("app"));Te.value=""};K(ce,(e=>{Ze(e),console.log(e)}));const Pe=()=>{if(o.isChatIn)return z.warning("请等待聊天结束后修改模型信息！");o.updateModelDialog(!0)},Je=a((()=>{if(!M.activeConfig)return;const{modelInfo:e}=M.activeConfig;return e?`${e.modelName}`:void 0}));T((async()=>{U.value&&await Oe(Number(U.value)),G.value&&await async function(e){_.setToken(e),await ne.replace({name:"Chat",query:{}}),z.success("账户登录成功、开始体验吧！"),await _.getUserInfo()}(G.value),W.value&&(W.value.toLowerCase().includes("success")?(z.success("感谢你的购买、祝您使用愉快~",{duration:5e3}),_.getUserInfo(),ne.replace({name:"Chat",query:{}})):z.error("您还没有购买成功哦~")),await A((async()=>{var e;await M.queryActiveChatLogList(),await pe(),ze.value&&!de.value&&(null==(e=ze.value)||e.focus())})),ie(["dialogueTail"]).then((e=>{De.value=e.data}))}));const Ke=a((()=>"dark"===B.theme)),Qe=a((()=>o.recordDialog));Q((()=>{Ie.value&&F.abort()}));const Xe=a((()=>{if(de.value)return["h-full"]})),Ye=a((()=>{})),et=a((()=>de.value?"tiny":"small"));function tt(e){S.value=e}function lt(){ne.push("/draw")}async function at(e){var t;let l={modelInfo:e};if("专业AI模型（ERNIE-Bot）"==JSON.parse(null==(t=Ee.value)?void 0:t.config).modelInfo.modelName)Ve();else{console.log(l);const e={groupId:Me.value,config:JSON.stringify(l)},t=await re(e);200==t.code?(await M.queryMyGroup(),Ve()):z.error(t.data)}}j();const st=j();X((()=>{Y().then((e=>{st.value=e.data.modelMaps[1].filter((e=>1==e.canUpload))[0]}))}));const ot=()=>{ne.push("/gpts")};return(e,t)=>(u(),p("div",{class:q(["chat_card flex w-full flex-col bg-[#f4f4f4] dark:bg-[#010102]",Xe.value]),style:se(Ye.value)},[x(be,{visible:Qe.value,onSubmit:Ve},null,8,["visible"]),x(Se,{"using-context":d(ge),"dark-mode":Ke.value,onExport:Ue,onToggleUsingContext:d(fe),onClear:We},null,8,["using-context","dark-mode","onToggleUsingContext"]),v("main",el,[v("div",{id:"scrollRef",class:q([he.value.length?"":"noData","relative h-full overflow-hidden overflow-y-auto scroll-smooth bg-[#fff] dark:bg-[#1A1D21] ml-6 mr-3"]),ref_key:"scrollRef",ref:ue,style:{"border-radius":"10px 10px 0 0"}},[v("div",{id:"image-wrapper",class:q(["w-full max-w-screen-2xl m-auto h-full",[d(de)?"":"p-4"]])},[he.value.length?(u(),p("div",{key:1,class:q(["max-w-full",[d(de)?"px-1":""]]),style:{width:"100%"}},[(u(!0),p(y,null,b(he.value,((e,t)=>(u(),g(d(Xt),{chatTail:De.value,key:e.chatId,"date-time":e.dateTime,text:e.text,inversion:e.inversion,error:e.error,loading:e.loading,onRegenerate:e=>qe(t),onDelete:t=>function({chatId:e}){Ie.value?z.warning("对话中，不可进行删除操作"):I.warning({title:s("chat.deleteMessage"),content:s("chat.deleteMessageConfirm"),positiveText:s("common.yes"),negativeText:s("common.no"),onPositiveClick:()=>{M.deleteChatById(e)}})}(e)},null,8,["chatTail","date-time","text","inversion","error","loading","onRegenerate","onDelete"])))),128)),v("div",Il,[Ie.value?(u(),g(d(w),{key:0,onClick:He},{icon:k((()=>[x(d(f),{icon:"ri:stop-circle-line"})])),default:k((()=>[ee(" 停止输出 ")])),_:1})):m("",!0)]),v("div",{ref_key:"bottomContainer",ref:D,class:"bottom"},null,512)],2)):(u(),p("div",tl,[ll,v("div",al,[sl,v("div",ol,[v("div",{class:q(0==S.value?"item dark:bg-[#2960BE] bg-[#3378ED] text-[#fff]":"def_item"),onClick:t[0]||(t[0]=e=>tt(0))},[v("div",null,[x(d(f),{class:"mr-[10px]",icon:"simple-line-icons:paper-plane"})]),nl],2),v("div",{class:q(1==S.value?"item dark:bg-[#2960BE] bg-[#3378ED] text-[#fff]":"def_item"),onClick:t[1]||(t[1]=e=>tt(1))},[v("div",null,[x(d(f),{class:"mr-[10px]",icon:"icon-park-outline:all-application"})]),il],2)])]),0==S.value?(u(),p("div",rl,[cl,v("div",dl,[v("div",ul,[pl,v("div",{class:"item_btn border-[2px] border-[#3378ED] text-[#3378ED] dark:text-[#2960BE]",onClick:t[2]||(t[2]=e=>at(st.value))},"上传文件 "),vl,v("div",gl,[st.value?(u(),p("div",fl,h(st.value.modelName),1)):m("",!0)])]),v("div",{class:"item dark:bg-[#202B3A] bg-[#F5F8FE]",onClick:lt},ml),v("div",hl,[xl,v("div",{class:"item_btn border-[2px] border-[#3378ED] text-[#3378ED] dark:text-[#2960BE]",onClick:t[3]||(t[3]=e=>at(st.value))},"上传文件 "),kl,v("div",yl,[st.value?(u(),p("div",bl,h(st.value.modelName),1)):m("",!0)])])])])):(u(),p("div",wl,[Cl,v("div",Al,[_l,v("div",Ll,[v("div",{class:"tag dark:bg-[#2E2E4C] bg-[#E7E7E7]",onClick:ot},[v("div",null,[x(d(f),{class:"text-[15px] mr-[4px]",icon:"icon-park-outline:application"})]),Fl]),v("div",{class:"tag dark:bg-[#2E2E4C] bg-[#E7E7E7]",onClick:t[4]||(t[4]=e=>d(_).updateCreateAppDialog(!0))},[v("div",null,[x(d(f),{class:"text-xl",icon:"material-symbols-light:add"})]),jl])])]),v("div",Tl,[x(nt,{onRunApp:Ze,onClick:t[5]||(t[5]=e=>tt(1))})])]))]))],2)],2)]),0==S.value?(u(),p("footer",zl,[v("div",{style:{"padding-right":"6%","padding-left":"6%"},class:q(["m-auto",d(de)?"px-0 pt-1":"px-4 py-2"])},[v("div",Bl,[v("div",{class:q(["flex mb-1 items-center",["max-w-screen-2xl",d(de)?"px-1":""]])},[xe.value?(u(),g(d(w),{key:0,strong:"",secondary:"",size:et.value,onClick:t[6]||(t[6]=e=>Ve(1)),style:{diplay:"block","margin-right":"12px","border-radius":"8px"},class:"bg-[#f4f4f4] dark:bg-[#010102]"},{default:k((()=>[v("span",Dl,[x(d(f),{class:q(["text-xl",[d(de)?"":"mr-0.5"]]),style:{width:"0.8em",height:"0.8em"},icon:"line-md:cloud-up"},null,8,["class"]),d(de)?m("",!0):(u(),p("span",Ml,"上传"))])])),_:1},8,["size"])):m("",!0),ke.value?(u(),g(d(w),{key:1,strong:"",secondary:"",size:et.value,onClick:Ne,round:"",style:{diplay:"block","margin-right":"0.4rem"},class:"bg-[#f4f4f4] dark:bg-[#010102]"},{default:k((()=>[v("span",El,[x(d(f),{class:q(["text-lg",[d(de)?"":"mr-0.5"]]),style:{width:"0.8em",height:"0.8em"},icon:"streamline:voice-mail"},null,8,["class"]),d(de)?m("",!0):(u(),p("span",$l,"语音助手"))])])),_:1},8,["size"])):m("",!0),x(d(te),{trigger:"hover",disabled:d(de)},{trigger:k((()=>[v("button",{strong:"",secondary:"",style:{"border-radius":"8px"},onClick:Pe,class:q([[d(de)?"px-1 scale-75":"px-3"],"mr-2 py-1 bg-gradient-to-r from-[#3076ED] to-[#54A2F5] hover:bg-gradient-to-r"])},[v("span",Sl,[x(d(f),{class:"text-lg text-white",style:{width:"0.8em",height:"0.8em"},icon:"carbon:model"}),v("span",Rl,h(Je.value),1)])],2)])),default:k((()=>[ee(" 模型切换 ")])),_:1},8,["disabled"])],2),v("div",Nl,[x(d(te),{trigger:"hover",disabled:d(de)},{trigger:k((()=>[x(d(w),{strong:"",secondary:"",size:"small",round:"",onClick:We,style:{"border-radius":"8px"},class:"dark:bg-[#010102] bg-[#F4F4F4]"},{default:k((()=>[v("span",Vl,[ql,x(d(f),{class:"text-xl ml-0.5",style:{width:"0.8em",height:"0.8em"},icon:"akar-icons:trash-can"})])])),_:1})])),default:k((()=>[ee(" 清空聊天记录 ")])),_:1},8,["disabled"])])]),v("div",Ol,[v("div",Ul,[le(v("textarea",{ref_key:"inputRef",ref:ze,"onUpdate:modelValue":t[7]||(t[7]=e=>Te.value=e),placeholder:"你可以问我任何问题",style:{height:"100px",width:"100%",resize:"none","border-radius":"8px"},onKeypress:Ge,class:"bg-[#f4f4f4] dark:bg-[#15171A] pt-4 pb-10 pl-5 pr-5"},"\n\n\t\t\t\t\t\t\t",544),[[ae,Te.value]]),v("div",Wl,[v("div",Gl,[v("div",Hl,[x(d(w),{class:"sendBtn",type:"primary",size:"small",disabled:Re.value,round:"",onClick:qe},{default:k((()=>[Zl,x(d(f),{icon:"icon-park-outline:send"})])),_:1},8,["disabled"])])])])])])],2),d(de)?m("",!0):(u(),g(Ae,{key:0,class:"footer-copyright-bar"}))])):m("",!0),x(we)],6))}}),[["__scopeId","data-v-9a0ffd80"]]),Jl={class:"h-full dark:bg-[#010102] bg-[#F4F4F4] transition-all"},Kl=M(o({__name:"chat",setup(t){const s=i(),o=l(),r=n(),{isMobile:g}=c(),f=a((()=>r.isLogin));a((()=>s.siderCollapsed)),K(f,(async(e,t)=>{e&&!t&&await o.queryMyGroup()}));const m=a((()=>g.value?["rounded-none","shadow-none"]:["rounded-md","shadow-md","dark:border-neutral-800"]));return(t,l)=>(u(),p("div",Jl,[v("div",{class:q(["h-full overflow-hidden",m.value])},[x(d(ce),{style:{"background-color":"transparent"},class:"dark:bg-[#010102] bg-[#F4F4F4] z-40 transition w-full h-full","has-sider":!0,"sider-placement":"left"},{default:k((()=>[x(e,{style:{"background-color":"transparent"},class:"h-full"}),x(Pl)])),_:1})],2)]))}}),[["__scopeId","data-v-06d6c002"]]);export{Kl as default};
