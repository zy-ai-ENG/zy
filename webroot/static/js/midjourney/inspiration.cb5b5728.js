import{T as e,b as t,d as s}from"../@vue_runtime-dom@3.2.47/@vue_runtime-dom@3.2.47.298398d5.js";import{a,E as i,A as r,d as o,r as l,v as n,I as u,B as v,h as p}from"../main-bb4220d0.js";import{t as d}from"../throttle/throttle.33f09de3.js";import{u as c}from"../vue-router@4.1.6_vue@3.2.47/vue-router@4.1.6_vue@3.2.47.018c715a.js";import{c as m}from"../index/index.a4f65e28.js";import{d as f,g as _,n as h,m as j,p as y,J as g,a as x,b as A,F as b,Q as k,o as w,c as B,N as C,R as F,M as U,G as I,S as E,U as q}from"../@vue_runtime-core@3.2.47/@vue_runtime-core@3.2.47.e62b9a68.js";import{e as K}from"../naive-ui@2.34.3_vue@3.2.47/naive-ui@2.34.3_vue@3.2.47.d79924d9.js";import{r as R,j as S,x as J}from"../@vue_reactivity@3.2.47/@vue_reactivity@3.2.47.859737a0.js";import{o as L,J as D,n as z}from"../@vue_shared@3.2.47/@vue_shared@3.2.47.9d8e617e.js";import{S as N}from"../index/index.bf6210d7.js";import"../v-viewer@3.0.11_vue@3.2.47/v-viewer@3.0.11_vue@3.2.47.a81e5850.js";import"../viewerjs@1.11.3/viewerjs@1.11.3.a76d4126.js";import"../clientjs@0.2.1/clientjs@0.2.1.7f53d864.js";import"../@babel_runtime@7.21.5/@babel_runtime@7.21.5.35f69bd2.js";import"../crypto-js@4.1.1/crypto-js@4.1.1.7142fa56.js";import"../@iconify_vue@4.1.1_vue@3.2.47/@iconify_vue@4.1.1_vue@3.2.47.612da1cd.js";import"../pinia@2.0.35_typescript@4.9.5_vue@3.2.47/pinia@2.0.35_typescript@4.9.5_vue@3.2.47.1425f1b3.js";import"../vue-demi@0.14.7_vue@3.2.47/vue-demi@0.14.7_vue@3.2.47.71ba0ef2.js";import"../axios@1.4.0/axios@1.4.0.5ae1da96.js";import"../vue-i18n@9.2.2_vue@3.2.47/vue-i18n@9.2.2_vue@3.2.47.f7da0a53.js";import"../@intlify_shared@9.2.2/@intlify_shared@9.2.2.76c1dc14.js";import"../@intlify_core-base@9.2.2/@intlify_core-base@9.2.2.72ca16dd.js";import"../@intlify_message-compiler@9.2.2/@intlify_message-compiler@9.2.2.9b2b247d.js";import"../@intlify_devtools-if@9.2.2/@intlify_devtools-if@9.2.2.1be0989c.js";import"../vooks@0.2.12_vue@3.2.47/vooks@0.2.12_vue@3.2.47.89d56bd5.js";import"../evtd@0.2.4/evtd@0.2.4.2789e4a1.js";import"../katex@0.16.7/katex@0.16.7.43835b5c.js";import"../@vueuse_core@9.13.0_vue@3.2.47/@vueuse_core@9.13.0_vue@3.2.47.770e5818.js";import"../@vueuse_shared@9.13.0_vue@3.2.47/@vueuse_shared@9.13.0_vue@3.2.47.58cbe97f.js";import"../mitt@3.0.1/mitt@3.0.1.f0e54764.js";import"../@vicons_ionicons5@0.12.0/@vicons_ionicons5@0.12.0.5fe57882.js";import"../marked@4.3.0/marked@4.3.0.cb1ff4ec.js";import"../date-fns@2.30.0/date-fns@2.30.0.bcce45e8.js";import"../vue-clipboard3@2.0.0/vue-clipboard3@2.0.0.ebf9d56c.js";import"../clipboard@2.0.11/clipboard@2.0.11.6a7b8915.js";import"../@vueuse_integrations@10.2.0_axios@1.4.0_qrcode@1.5.3_vue@3.2.47/@vueuse_integrations@10.2.0_axios@1.4.0_qrcode@1.5.3_vue@3.2.47.a70167c7.js";import"../@vueuse_shared@10.2.0_vue@3.2.47/@vueuse_shared@10.2.0_vue@3.2.47.3d57d69b.js";import"../qrcode@1.5.3/qrcode@1.5.3.ae99ec0a.js";import"../encode-utf8@1.0.3/encode-utf8@1.0.3.2ec93547.js";import"../dijkstrajs@1.0.3/dijkstrajs@1.0.3.38d0b2a1.js";import"../seemly@0.3.6/seemly@0.3.6.21da59ee.js";import"../vueuc@0.4.51_vue@3.2.47/vueuc@0.4.51_vue@3.2.47.ce1cbfa6.js";import"../@css-render_vue3-ssr@0.15.12_vue@3.2.47/@css-render_vue3-ssr@0.15.12_vue@3.2.47.e49104bd.js";import"../vdirs@0.1.8_vue@3.2.47/vdirs@0.1.8_vue@3.2.47.bf970686.js";import"../@juggle_resize-observer@3.4.0/@juggle_resize-observer@3.4.0.80d14552.js";import"../css-render@0.15.12/css-render@0.15.12.af3f05a4.js";import"../@emotion_hash@0.8.0/@emotion_hash@0.8.0.b17c1a96.js";import"../lodash-es@4.17.21/lodash-es@4.17.21.6a776102.js";import"../treemate@0.3.11/treemate@0.3.11.05d63ee5.js";import"../async-validator@4.2.5/async-validator@4.2.5.8d480e59.js";import"../@css-render_plugin-bem@0.15.12_css-render@0.15.12/@css-render_plugin-bem@0.15.12_css-render@0.15.12.0c2c3e5c.js";const Q={class:"overflow-hidden pr-0 h-full flex flex-col"},W={class:"market overflow-y-auto flex-1 min-h-screen h-[80vh] p-2 relative itemContent"},O=["id"],P=["id","src","onLoad","onError","onClick"],T={class:"menu p-2 text-[#cbd5e1]"},V={class:"prompt"},G={class:"flex justify-between items-end"},H=["onClick"],X=[A("span",{class:"text-[12px] pt-[2px] scale-90 dark:text-slate-400"},"画同款",-1)],Z=["onClick"],M=[A("span",{class:"text-[12px] pt-[2px] scale-90 dark:text-slate-400"},"复制",-1)],Y=f({__name:"market",props:{type:{type:String,required:!1,default:"all"}},setup(s,{expose:o}){var l;const n=s,u=a(),v=null==(l=_())?void 0:l.appContext.config.globalProperties.$viewerApi,p=K(),f=R([]),U=R({}),I=R(0),E=R(160),q=R(0),z=R(10),N=R(10),Y=R([]),$=R(null),ee=R(0),te=h((()=>u.isLogin)),se=R(30),ae=R(""),ie=h((()=>se.value+z.value+150)),re=c(),oe=R();i.on("newData",(e=>{oe.value=e}));const le=S({page:1,size:999,rec:1,squareType:n.type});function ne(){!function(){const{showName:e=0,showOther:t=0}={};I.value=15*[e,t].filter((e=>e)).length}(),function(){if(!$.value)return;const e=$.value.clientWidth;q.value=Math.floor(e/ie.value);const t=e-q.value*ie.value,s=(q.value-1)*z.value;t-s<0&&(q.value-=1);E.value=Math.floor((e-s)/q.value)}();const e=q.value,t=E.value,s=[];ue.value.forEach(((a,i)=>{let r=200,o=300;a.fileInfo&&(r=a.fileInfo.width||r,o=a.fileInfo.height||o);const l=o*(t/r)+N.value+I.value,n=U.value[a.id];if(s.length<e)n.style.top="0px",n.style.left=(t+z.value)*i+"px",s.push(l);else{const e=Math.min.apply(null,s),t=s.findIndex((t=>t===e));n.style.top=`${e+0}px`,n.style.left=t*(E.value+z.value)+"px",s[t]+=l}})),ee.value=Math.max(...s)+130}const ue=h((()=>oe.value?oe.value.rows:ae.value?f.value.filter((e=>{const{prompt:t}=e;return t.includes(ae.value)})):f.value));j(se,(()=>{ne()}));let ve=null;async function pe(){const e=await r(le);f.value=e.data.rows}j(ue,(()=>{ue.value.length&&(clearTimeout(ve),ve=setTimeout((()=>{ne()}),300))}));const de=h((()=>e=>{let t=200,s=300;return e.fileInfo&&(t=e.fileInfo.width,s=e.fileInfo.height),s/(t/E.value)})),ce=d((function(){ne()}),200);return y((async()=>{await pe(),ne(),window.addEventListener("resize",ce)})),o({handleQuery:e=>{le.squareType=e,pe(),ne()}}),g((()=>{window.removeEventListener("resize",ce)})),(s,a)=>(w(),x("div",Q,[A("div",W,[A("div",{id:"wapper",ref_key:"wapperRef",ref:$,class:"wapper",style:L({height:`${ee.value}px`})},[(w(!0),x(b,null,k(J(ue),((s,a)=>(w(),x("div",{id:s.id,key:a,ref_for:!0,ref:e=>function(e,t){e&&t&&(U.value[t.id]=e)}(e,s),class:"wapper-item",style:L({width:`${E.value}px`})},[B(e,{name:"img",css:!0},{default:C((()=>[A("img",{id:s.id,class:"item-file rounded-sm",style:L({width:`${E.value}px`,height:`${J(de)(s)}px`}),src:s.imageUrl,loading:"lazy",onLoad:e=>function(e,t){Y.value.push(t.id)}(0,s),onError:e=>function(e,t){Y.value.push(t.id)}(0,s),onClick:e=>function(e){v({options:{},images:[e.imageUrl]})}(s)},null,44,P)])),_:2},1024),A("div",T,[A("div",V,D(s.fullPrompt),1),A("div",G,[A("button",{class:"flex mr-2 h-4 w-10 items-center justify-center rounded border transition hover:bg-[#666161] dark:border-neutral-700 dark:hover:bg-[#33373c]",onClick:t((e=>(e=>{u.updatePromptWords({prompt:e.fullPrompt}),re.push("/midjourney?id=textToImage")})(s)),["stop"])},X,8,H),A("button",{class:"flex h-4 w-8 items-center justify-center rounded border transition hover:bg-[#666161] dark:border-neutral-700 dark:hover:bg-[#33373c]",onClick:t((e=>function(e){if(!te.value)return u.setLoginDialog(!0);const{prompt:t}=e;m({text:t}),p.success("复制prompt成功")}(s)),["stop"])},M,8,Z)])]),Y.value.includes(s.id)?F("",!0):(w(),x("div",{key:0,class:"item-loading",style:L({width:`${E.value}px`,height:`${J(de)(s)}px`})},null,4))],12,O)))),128))],4)])]))}}),$=e=>(E("data-v-e2e008c1"),e=e(),q(),e),ee={style:{position:"absolute"}},te={key:0,class:"flex justify-center"},se={style:{display:"flex","justify-content":"center","margin-top":"10px"}},ae={class:"inpBox bg-[#EBEBEB] dark:bg-[#171726]"},ie=[$((()=>A("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAVCAYAAACpF6WWAAAAAXNSR0IArs4c6QAAAe1JREFUOE+dlD1oFFEUhb8DKmphKom/CBILQdHCBBQhNmJAUlkFtRFEK0Fr7aw1sQhISCWSyjSSYKGgRCyihUbsUijGQmxU8AcVjnOXN+tkdnZn3dcs7Jv3vXPfPfeINsv2WmAXsBlYB/wCPgHvJP1udy7+V3nT9kbgGDAIrK84/AN4kX3zWNL3KvgqqO0dwFlgE/AReAm8BwK0AdgJHAC2AF+BO5JWyuAm1HYcOA84UzknabHD0wwBJ1OlU5Li4uZqQG1HmVdSubclfej0ZunMNuAi8DOr7Iak+G2sHBq3HgVmJT2vA+b7tg8Bp4CnkuaaUNtrgKvAF0k3uwUWwJeBPuC6pD8Npbb3AOeAB5Ke9AAdBkayJk5LWs6hR4BRYCr5sf9/4LZ3pwbfl/Qsh4YnTwC3gOPAXuBaXkqdcttbgUvAI0kPq5QGMBo2WbZJB3tVKm2+KfA22WRZ0nSdymStyjfNu/9Z0rjt08A+YEnSTB3Ydmv30225T+8Br4AzMaqSJjpBCz5dkDRfNn8vE7UduAB8AyZaJiqp7WX2IxLfAHclRWb8G9PCdHSTUgeB/pjAlK8D2ai+BmZycK95GvkQ0xeROAbsL4JboAXVxeSPLA1AS/LbDsZqcJ1lutkvgefbKu0GVvwmgQ8DK38BXh3TaV83jK0AAAAASUVORK5CYII=",alt:""},null,-1))),$((()=>A("p",null,"搜索",-1)))],re={key:1,class:"flex w-full flex-j mb-2 items-center overflow-x-hidden justify-center",style:{"margin-top":"25px"}},oe={class:"relative z-40 transition-300 ease"},le=["onClick"],ne={class:"pl-3 pr-3 pt-1 pb-1 whitespace-nowrap"},ue={class:"flex-1 h-[82vh]",style:{padding:"0 200px"}},ve=p(f({__name:"inspiration",setup(e){const{isMobile:t}=o(),a=R(),r=R(""),p=R(),d=R([]);(async()=>{const e=await n({page:1,size:100}).then((e=>e.data.rows));d.value=[{name:"全部",value:""}].concat(e)||u,a.value.handleQuery(r.value)})(),i.emit("drawRoute",l.options.history.location);const c=R(),m=R();function f(){let e={keyword:m.value,page:1,size:999};v(e).then((e=>{c.value=e.data,i.emit("newData",c.value)})),m.value=""}return(e,o)=>(w(),x(b,null,[A("div",ee,[J(t)?F("",!0):(w(),U(N,{key:0}))]),A("div",{class:z(["h-full overflow-hidden dark:bg-[#1F1F38] bg-[#FFFFFF]",[J(t)?"p-0":"p-3"]])},[J(t)?F("",!0):(w(),x("div",te)),A("div",se,[A("div",ae,[I(A("input",{class:"inp bg-[#F4F4F5] dark:bg-[#171726]","onUpdate:modelValue":o[0]||(o[0]=e=>m.value=e),type:"text",placeholder:"输入关键词"},null,512),[[s,m.value]]),A("div",{class:"iconBox",onClick:f},ie)])]),J(t)?F("",!0):(w(),x("div",re,[A("div",oe,[A("ul",{class:"flex justify-start items-center",ref_key:"tabListRef",ref:p},[(w(!0),x(b,null,k(d.value,(e=>(w(),x("li",{onClick:t=>{return s=e,r.value=s.value,a.value.handleQuery(s.value),void i.emit("newData","");var s},class:z(["mr-1 ml-1 w-auto select-none cursor-pointer hover:dark:text-[#fff] hover:text-[#fff] hover:bg-gradient-to-l from-[#2F73EC] to-[#5AA8F7] duration-300 flex rounded-3xl",[e.value===r.value?"text-[#fff] bg-gradient-to-l from-[#2F73EC] to-[#5AA8F7]  dark:text-[#fff]":"bg-[transparent] dark:bg-[transparent]"]])},[A("div",ne,D(e.name),1)],10,le)))),256))],512)])])),A("div",ue,[B(Y,{ref_key:"marketRef",ref:a,type:r.value},null,8,["type"])])],2)],64))}}),[["__scopeId","data-v-e2e008c1"]]);export{ve as default};
