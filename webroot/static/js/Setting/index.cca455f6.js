import{b as e,a as s,d as a,_ as t,an as i,t as l}from"../main-bb4220d0.js";import{e as n,r,p as o,a5 as c,P as u,y as p,W as m,V as v,C as d}from"../naive-ui@2.34.3_vue@3.2.47/naive-ui@2.34.3_vue@3.2.47.d79924d9.js";import{J as f,n as _}from"../@vue_shared@3.2.47/@vue_shared@3.2.47.9d8e617e.js";import{d as x,n as y,o as j,a as g,b as h,c as k,N as w,t as b,F as $,Q as C,p as I,M as z}from"../@vue_runtime-core@3.2.47/@vue_runtime-core@3.2.47.e62b9a68.js";import{r as S,x as U,i as L}from"../@vue_reactivity@3.2.47/@vue_reactivity@3.2.47.859737a0.js";import"../@vue_runtime-dom@3.2.47/@vue_runtime-dom@3.2.47.298398d5.js";import"../v-viewer@3.0.11_vue@3.2.47/v-viewer@3.0.11_vue@3.2.47.a81e5850.js";import"../viewerjs@1.11.3/viewerjs@1.11.3.a76d4126.js";import"../vue-router@4.1.6_vue@3.2.47/vue-router@4.1.6_vue@3.2.47.018c715a.js";import"../clientjs@0.2.1/clientjs@0.2.1.7f53d864.js";import"../@babel_runtime@7.21.5/@babel_runtime@7.21.5.35f69bd2.js";import"../crypto-js@4.1.1/crypto-js@4.1.1.7142fa56.js";import"../@iconify_vue@4.1.1_vue@3.2.47/@iconify_vue@4.1.1_vue@3.2.47.612da1cd.js";import"../pinia@2.0.35_typescript@4.9.5_vue@3.2.47/pinia@2.0.35_typescript@4.9.5_vue@3.2.47.1425f1b3.js";import"../vue-demi@0.14.7_vue@3.2.47/vue-demi@0.14.7_vue@3.2.47.71ba0ef2.js";import"../axios@1.4.0/axios@1.4.0.5ae1da96.js";import"../vue-i18n@9.2.2_vue@3.2.47/vue-i18n@9.2.2_vue@3.2.47.f7da0a53.js";import"../@intlify_shared@9.2.2/@intlify_shared@9.2.2.76c1dc14.js";import"../@intlify_core-base@9.2.2/@intlify_core-base@9.2.2.72ca16dd.js";import"../@intlify_message-compiler@9.2.2/@intlify_message-compiler@9.2.2.9b2b247d.js";import"../@intlify_devtools-if@9.2.2/@intlify_devtools-if@9.2.2.1be0989c.js";import"../vooks@0.2.12_vue@3.2.47/vooks@0.2.12_vue@3.2.47.89d56bd5.js";import"../evtd@0.2.4/evtd@0.2.4.2789e4a1.js";import"../katex@0.16.7/katex@0.16.7.43835b5c.js";import"../@vueuse_core@9.13.0_vue@3.2.47/@vueuse_core@9.13.0_vue@3.2.47.770e5818.js";import"../@vueuse_shared@9.13.0_vue@3.2.47/@vueuse_shared@9.13.0_vue@3.2.47.58cbe97f.js";import"../mitt@3.0.1/mitt@3.0.1.f0e54764.js";import"../@vicons_ionicons5@0.12.0/@vicons_ionicons5@0.12.0.5fe57882.js";import"../marked@4.3.0/marked@4.3.0.cb1ff4ec.js";import"../date-fns@2.30.0/date-fns@2.30.0.bcce45e8.js";import"../vue-clipboard3@2.0.0/vue-clipboard3@2.0.0.ebf9d56c.js";import"../clipboard@2.0.11/clipboard@2.0.11.6a7b8915.js";import"../@vueuse_integrations@10.2.0_axios@1.4.0_qrcode@1.5.3_vue@3.2.47/@vueuse_integrations@10.2.0_axios@1.4.0_qrcode@1.5.3_vue@3.2.47.a70167c7.js";import"../@vueuse_shared@10.2.0_vue@3.2.47/@vueuse_shared@10.2.0_vue@3.2.47.3d57d69b.js";import"../qrcode@1.5.3/qrcode@1.5.3.ae99ec0a.js";import"../encode-utf8@1.0.3/encode-utf8@1.0.3.2ec93547.js";import"../dijkstrajs@1.0.3/dijkstrajs@1.0.3.38d0b2a1.js";import"../seemly@0.3.6/seemly@0.3.6.21da59ee.js";import"../vueuc@0.4.51_vue@3.2.47/vueuc@0.4.51_vue@3.2.47.ce1cbfa6.js";import"../@css-render_vue3-ssr@0.15.12_vue@3.2.47/@css-render_vue3-ssr@0.15.12_vue@3.2.47.e49104bd.js";import"../vdirs@0.1.8_vue@3.2.47/vdirs@0.1.8_vue@3.2.47.bf970686.js";import"../@juggle_resize-observer@3.4.0/@juggle_resize-observer@3.4.0.80d14552.js";import"../css-render@0.15.12/css-render@0.15.12.af3f05a4.js";import"../@emotion_hash@0.8.0/@emotion_hash@0.8.0.b17c1a96.js";import"../lodash-es@4.17.21/lodash-es@4.17.21.6a776102.js";import"../treemate@0.3.11/treemate@0.3.11.05d63ee5.js";import"../async-validator@4.2.5/async-validator@4.2.5.8d480e59.js";import"../@css-render_plugin-bem@0.15.12_css-render@0.15.12/@css-render_plugin-bem@0.15.12_css-render@0.15.12.0c2c3e5c.js";const N={class:"p-4 space-y-5 min-h-[200px]"},q={class:"space-y-6"},J={class:"flex items-center space-x-4"},T={class:"flex-shrink-0 w-[100px]"},B={class:"flex-1"},F={class:"flex items-center space-x-4"},O={class:"flex-shrink-0 w-[100px]"},D={class:"w-[200px]"},M={class:"flex-shrink-0 w-[100px]"},A={class:"flex flex-wrap items-center gap-4"},G={class:"flex items-center space-x-4"},P={class:"flex-shrink-0 w-[100px]"},R={class:"flex flex-wrap items-center gap-4"},E={class:"flex items-center space-x-4"},H={class:"flex-shrink-0 w-[100px]"},V={class:"flex flex-wrap items-center gap-4"},Q=x({__name:"General",setup(p){const m=e(),v=s(),{isMobile:d}=a(),x=n(),I=y((()=>m.theme)),z=y((()=>v.userInfo)),L=S(z.value.avatar??""),Q=S(z.value.username??""),W=S(!1),Y=y({get:()=>m.language,set(e){m.setLanguage(e)}}),K=[{label:"Auto",key:"auto",icon:"ri:contrast-line"},{label:"Light",key:"light",icon:"ri:sun-foggy-line"},{label:"Dark",key:"dark",icon:"ri:moon-foggy-line"}],X=[{label:"简体中文",key:"zh-CN",value:"zh-CN"}];async function Z(e){try{W.value=!0;const s=await i(e);if(W.value=!1,!s.success)return x.error(s.message);x.success(l("common.updateUserSuccess")),v.getUserInfo()}catch(s){W.value=!1}}function ee(){const e=function(){const e=new Date,s=e.getDate(),a=e.getMonth()+1;return`${e.getFullYear()}-${a}-${s}`}(),s=localStorage.getItem("chatStorage")||"{}",a=JSON.stringify(JSON.parse(s),null,2),t=new Blob([a],{type:"application/json"}),i=URL.createObjectURL(t),l=document.createElement("a");l.href=i,l.download=`chat-store_${e}.json`,document.body.appendChild(l),l.click(),document.body.removeChild(l)}function se(e){const s=e.target;if(!s||!s.files)return;const a=s.files[0];if(!a)return;const t=new FileReader;t.onload=()=>{try{const e=JSON.parse(t.result);localStorage.setItem("chatStorage",JSON.stringify(e)),x.success(l("common.success")),location.reload()}catch(e){x.error(l("common.invalidFileFormat"))}},t.readAsText(a)}function ae(){localStorage.removeItem("chatStorage"),location.reload()}function te(){const e=document.getElementById("fileInput");e&&e.click()}return(e,s)=>(j(),g("div",N,[h("div",q,[h("div",J,[h("span",T,f(e.$t("setting.avatarLink")),1),h("div",B,[k(U(r),{value:L.value,"onUpdate:value":s[0]||(s[0]=e=>L.value=e),placeholder:"请填写头像地址"},null,8,["value"])]),k(U(o),{size:"tiny",disabled:W.value,text:"",type:"primary",onClick:s[1]||(s[1]=e=>Z({avatar:L.value}))},{default:w((()=>[b(f(e.$t("common.update")),1)])),_:1},8,["disabled"])]),h("div",F,[h("span",O,f(e.$t("setting.name")),1),h("div",D,[k(U(r),{value:Q.value,"onUpdate:value":s[2]||(s[2]=e=>Q.value=e),placeholder:"请填写用户名"},null,8,["value"])]),k(U(o),{size:"tiny",disabled:W.value,text:"",type:"primary",onClick:s[3]||(s[3]=e=>Z({username:Q.value}))},{default:w((()=>[b(f(e.$t("common.update")),1)])),_:1},8,["disabled"])]),h("div",{class:_(["flex items-center space-x-4",U(d)&&"items-start"])},[h("span",M,f(e.$t("setting.chatHistory")),1),h("div",A,[k(U(o),{size:"small",onClick:ee},{icon:w((()=>[k(U(t),{icon:"ri:download-2-fill"})])),default:w((()=>[b(" "+f(e.$t("common.export")),1)])),_:1}),h("input",{id:"fileInput",type:"file",style:{display:"none"},onChange:se},null,32),k(U(o),{size:"small",onClick:te},{icon:w((()=>[k(U(t),{icon:"ri:upload-2-fill"})])),default:w((()=>[b(" "+f(e.$t("common.import")),1)])),_:1}),k(U(c),{placement:"bottom",onPositiveClick:ae},{trigger:w((()=>[k(U(o),{size:"small"},{icon:w((()=>[k(U(t),{icon:"ri:close-circle-line"})])),default:w((()=>[b(" "+f(e.$t("common.clear")),1)])),_:1})])),default:w((()=>[b(" "+f(e.$t("chat.clearHistoryConfirm")),1)])),_:1})])],2),h("div",G,[h("span",P,f(e.$t("setting.theme")),1),h("div",R,[(j(),g($,null,C(K,(e=>k(U(o),{key:e.key,size:"small",type:e.key===U(I)?"primary":void 0,onClick:s=>U(m).setTheme(e.key)},{icon:w((()=>[k(U(t),{icon:e.icon},null,8,["icon"])])),_:2},1032,["type","onClick"]))),64))])]),h("div",E,[h("span",H,f(e.$t("setting.language")),1),h("div",V,[k(U(u),{style:{width:"140px"},value:U(Y),options:X,onUpdateValue:s[4]||(s[4]=e=>U(m).setLanguage(e))},null,8,["value"])])])])]))}}),W={class:"p-4 space-y-5 min-h-[200px]"},Y={class:"flex items-center space-x-4"},K=h("span",{class:"flex-shrink-0 w-[100px]"},"用户邮箱",-1),X={class:"w-[200px]"},Z={class:"flex items-center space-x-4"},ee=h("span",{class:"flex-shrink-0 w-[100px]"},"用户姓名",-1),se={class:"w-[200px]"},ae={class:"flex items-center space-x-4"},te=h("span",{class:"flex-shrink-0 w-[100px]"},"问答余额",-1),ie={class:"w-[200px]"},le={class:"flex items-center space-x-4"},ne=h("span",{class:"flex-shrink-0 w-[100px]"},"绘画余额",-1),re={class:"w-[200px]"},oe={class:"flex items-center space-x-4"},ce=h("span",{class:"flex-shrink-0 w-[100px]"},"MJToken",-1),ue={class:"w-[200px]"},pe={class:"flex items-center space-x-4"},me=h("span",{class:"flex-shrink-0 w-[100px]"},"使用金额",-1),ve={class:"w-[200px]"},de=x({__name:"Personal",setup(e){const a=s(),{userInfo:t,userBalance:i}=a,l=S(!1);return I((async()=>{!async function(){try{l.value=!0,await a.getUserInfo(),l.value=!1}catch(e){l.value=!1}}()})),(e,s)=>(j(),z(U(p),{show:l.value},{default:w((()=>[h("div",W,[h("div",Y,[K,h("div",X,f(U(t).email||"--"),1)]),h("div",Z,[ee,h("div",se,f(U(t).username||"--"),1)]),h("div",ae,[te,h("div",ie,f(U(i).usesLeft||"0")+" 积分 ",1)]),h("div",le,[ne,h("div",re,f(U(i).paintCount||"0")+" 积分 ",1)]),h("div",oe,[ce,h("div",ue,f(U(i).balance||"0")+" Token ",1)]),h("div",pe,[me,h("div",ve,f(U(i).useTokens||"0")+" Token ",1)])])])),_:1},8,["show"]))}}),fe={class:"ml-2"},_e={class:"ml-2"},xe={class:"min-h-[100px]"},ye=x({__name:"index",props:{visible:{type:Boolean}},emits:["update:visible"],setup(e,{emit:s}){const a=e,i=S("personalInfo"),l=y({get:()=>a.visible,set(e){s("update:visible",e)}});return(e,s)=>(j(),z(U(d),{show:U(l),"onUpdate:show":s[1]||(s[1]=e=>L(l)?l.value=e:null),title:"个人中心","auto-focus":!1,preset:"card",style:{width:"95%","max-width":"640px"}},{default:w((()=>[h("div",null,[k(U(m),{value:i.value,"onUpdate:value":s[0]||(s[0]=e=>i.value=e),type:"line",animated:""},{default:w((()=>[k(U(v),{name:"personalInfo",tab:"personalInfo"},{tab:w((()=>[k(U(t),{class:"text-lg",icon:"ri:file-user-line"}),h("span",fe,f(e.$t("setting.personalInfo")),1)])),default:w((()=>[k(de)])),_:1}),k(U(v),{name:"General",tab:"General"},{tab:w((()=>[k(U(t),{class:"text-lg",icon:"ri:list-settings-line"}),h("span",_e,f(e.$t("setting.general")),1)])),default:w((()=>[h("div",xe,[k(Q)])])),_:1})])),_:1},8,["value"])])])),_:1},8,["show"]))}});export{ye as default};
