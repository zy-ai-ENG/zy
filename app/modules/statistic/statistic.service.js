'use strict';const _0x12af46=_0x3422;(function(_0x10d0d9,_0x36eb71){const _0x313075=_0x3422,_0x5e1956=_0x10d0d9();while(!![]){try{const _0x33c13b=parseInt(_0x313075(0x151))/0x1+parseInt(_0x313075(0x133))/0x2*(-parseInt(_0x313075(0x160))/0x3)+-parseInt(_0x313075(0x123))/0x4+-parseInt(_0x313075(0x108))/0x5+-parseInt(_0x313075(0x152))/0x6*(parseInt(_0x313075(0x12e))/0x7)+parseInt(_0x313075(0x146))/0x8*(parseInt(_0x313075(0x110))/0x9)+-parseInt(_0x313075(0x12d))/0xa*(-parseInt(_0x313075(0x15a))/0xb);if(_0x33c13b===_0x36eb71)break;else _0x5e1956['push'](_0x5e1956['shift']());}catch(_0x27b510){_0x5e1956['push'](_0x5e1956['shift']());}}}(_0x3f5a,0xc9a92));var __decorate=this&&this['__decorate']||function(_0xa8ff2e,_0x1373fc,_0x296911,_0x3109d0){const _0x5cd9c1=_0x3422;var _0x24c34e=arguments['length'],_0x1aa1e5=_0x24c34e<0x3?_0x1373fc:_0x3109d0===null?_0x3109d0=Object['getOwnPropertyDescriptor'](_0x1373fc,_0x296911):_0x3109d0,_0x1b3f65;if(typeof Reflect===_0x5cd9c1(0x15b)&&typeof Reflect[_0x5cd9c1(0x149)]===_0x5cd9c1(0xf5))_0x1aa1e5=Reflect['decorate'](_0xa8ff2e,_0x1373fc,_0x296911,_0x3109d0);else{for(var _0xb41897=_0xa8ff2e[_0x5cd9c1(0x119)]-0x1;_0xb41897>=0x0;_0xb41897--)if(_0x1b3f65=_0xa8ff2e[_0xb41897])_0x1aa1e5=(_0x24c34e<0x3?_0x1b3f65(_0x1aa1e5):_0x24c34e>0x3?_0x1b3f65(_0x1373fc,_0x296911,_0x1aa1e5):_0x1b3f65(_0x1373fc,_0x296911))||_0x1aa1e5;}return _0x24c34e>0x3&&_0x1aa1e5&&Object[_0x5cd9c1(0x130)](_0x1373fc,_0x296911,_0x1aa1e5),_0x1aa1e5;},__metadata=this&&this[_0x12af46(0x147)]||function(_0x145da1,_0x38eca6){const _0x1cc695=_0x12af46;if(typeof Reflect===_0x1cc695(0x15b)&&typeof Reflect[_0x1cc695(0x13b)]==='function')return Reflect[_0x1cc695(0x13b)](_0x145da1,_0x38eca6);},__param=this&&this['__param']||function(_0x24495e,_0x1deb75){return function(_0x289f85,_0x154c2e){_0x1deb75(_0x289f85,_0x154c2e,_0x24495e);};};function _0x3f5a(){const _0x3ccffa=['\x27\x20)\x20AS\x20groupeName,\x0a\x20\x20\x20\x20\x20\x20\x20\x20COUNT(*)\x20AS\x20count\x20\x0a\x20\x20\x20\x20\x20\x20FROM\x0a\x20\x20\x20\x20\x20\x20\x20\x20chatlog\x20\x0a\x20\x20\x20\x20\x20\x20WHERE\x0a\x20\x20\x20\x20\x20\x20\x20\x20role\x20=\x20\x27user\x27\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20AND\x20createdAt\x20>=\x20\x27','get','__esModule','请先配置百度统计siteId','setHours','select','\x27\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20AND\x20createdAt\x20<=\x20\x27','136089DJgjay','midjourneyEntity','configEntity','countNewChatsToday','orderEntity','OrderEntity','user.createdAt\x20<\x20:tomorrow','createQueryBuilder','chatLog.createdAt\x20>=\x20:today','length','map','chatlog.modelType\x20=\x20\x27music\x27','default','chatLogEntity','chatLog.type\x20=\x20:type','midjourney.createdAt\x20>=\x20:today','YYYYMMDD','midjourney.createdAt\x20>=\x20:startDate','Not','3850704dZCqJC','chatlog.answer\x20is\x20not\x20null','data','day','countNewUsersToday','userEntity','../globalConfig/config.entity','&start_date=','MidjourneyStatusEnum','%Y-%m-%d\x20%H:00','6063590MgkUrT','5852qklDLc','@nestjs/common','defineProperty','getBaiduVisit','countNewOrdersToday','696108uWsyJC','countChatsByTimeRange','axios','../../common/utils/date','count','getRawMany','M.DD','toFixed','metadata','PAINT_TYPE','query','date','sum','modelUse','orderBy','diff','formatDate','baiduSiteId','setDate','872dUQNVe','__metadata','chatLog.createdAt\x20<\x20:tomorrow','decorate','countTodayCollection','DATE(midjourney.createdAt)\x20as\x20date,\x20COUNT(*)\x20as\x20count','chatlog','UserEntity','user.createdAt\x20>=\x20:today','../midjourney/midjourney.entity','countMjDrawsByTimeRange','850853JEUxeR','1692cLWxrX','countTotalCollection','design:paramtypes','HttpException','music','../../common/constants/midjourney.constant','countNewMidhourneysToday','typeorm','22tUtyFS','object','../chatLog/chatLog.entity','find','endTime','../user/user.entity','3xXykzK','chatlog.createdAt\x20<\x20:tomorrow','startTime','user','getBaseStatistic','countNewDrawsToday','midjourney.createdAt\x20<\x20:tomorrow','Injectable','CHAT_TYPE','overview/getTimeTrendRpt','midjourney','countTodayMusic','@nestjs/typeorm','chatlog.createdAt\x20>=\x20:startDate','countChats','SELECT\x20SUM(price)\x20sum\x20FROM\x20`order`\x20WHERE\x20status\x20=\x201\x20AND\x20DATE(updatedAt)\x20=\x20CURDATE()','getDate','StatisticService','order.createdAt\x20<\x20:tomorrow','result','DeductionKey','groupBy','MidjourneyEntity','countTotalMusic','getCount','countOrders','\x0a\x20\x20\x20\x20\x20\x20SELECT\x0a\x20\x20\x20\x20\x20\x20\x20\x20model\x20AS\x20groupeName,\x0a\x20\x20\x20\x20\x20\x20\x20\x20count(*)\x20AS\x20count\x20\x0a\x20\x20\x20\x20\x20\x20FROM\x0a\x20\x20\x20\x20\x20\x20\x20\x20chatlog\x20\x0a\x20\x20\x20\x20\x20\x20WHERE\x0a\x20\x20\x20\x20\x20\x20\x20\x20role\x20=\x20\x27user\x27\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20AND\x20createdAt\x20>=\x20\x27','value','getChatStatistic','&end_date=','push','chatLog','&method=','DATE(chatlog.createdAt)\x20as\x20date,\x20COUNT(*)\x20as\x20count','chatlog.createdAt\x20>=\x20:today','Repository','andWhere','获取百度统计数据失败','function','ChatLogEntity','getBaiduStatistics','pv_count,visitor_count,ip_count,bounce_ratio,avg_visit_time','https://openapi.baidu.com/rest/2.0/tongji/report/getData?access_token=','getTime','IsNull','configVal','chatlog.type\x20=\x20:type','HttpStatus','configKey','where','now','\x27\x20\x0a\x20\x20\x20\x20\x20\x20GROUP\x20BY\x0a\x20\x20\x20\x20\x20\x20\x20\x20groupeName\x0a\x20\x20\x20\x20','&site_id=','InjectRepository','countUsers','connection','BAD_REQUEST','6696380muRiaz'];_0x3f5a=function(){return _0x3ccffa;};return _0x3f5a();}Object[_0x12af46(0x130)](exports,_0x12af46(0x10b),{'value':!![]}),exports[_0x12af46(0xe0)]=void 0x0;const common_1=require(_0x12af46(0x12f)),typeorm_1=require(_0x12af46(0xdb)),user_entity_1=require(_0x12af46(0x15f)),typeorm_2=require(_0x12af46(0x159)),chatLog_entity_1=require(_0x12af46(0x15c)),balance_constant_1=require('../../common/constants/balance.constant'),date_1=require(_0x12af46(0x136)),axios_1=require(_0x12af46(0x135)),config_entity_1=require(_0x12af46(0x129)),order_entity_1=require('../order/order.entity'),midjourney_entity_1=require(_0x12af46(0x14f)),midjourney_constant_1=require(_0x12af46(0x157));function _0x3422(_0x363a4d,_0x35b4b1){const _0x3f5a9a=_0x3f5a();return _0x3422=function(_0x342252,_0x3e119d){_0x342252=_0x342252-0xd0;let _0x97ce5d=_0x3f5a9a[_0x342252];return _0x97ce5d;},_0x3422(_0x363a4d,_0x35b4b1);}let StatisticService=class StatisticService{constructor(_0x1c942c,_0x3509e7,_0x12d967,_0x1f04d4,_0x93f491,_0x3450ba){const _0x1920e4=_0x12af46;this[_0x1920e4(0x128)]=_0x1c942c,this[_0x1920e4(0x11d)]=_0x3509e7,this['configEntity']=_0x12d967,this[_0x1920e4(0x114)]=_0x1f04d4,this[_0x1920e4(0x111)]=_0x93f491,this[_0x1920e4(0x106)]=_0x3450ba;}async[_0x12af46(0xd3)](){const _0x4c26b3=_0x12af46,_0x2dc7f9=await this[_0x4c26b3(0x105)](),_0x27aa7c=await this['countNewUsersToday'](),_0x50342e=await this[_0x4c26b3(0xdd)](),_0x5350e6=await this[_0x4c26b3(0x113)](),_0x4dbcce=await this['countDraws'](),_0x5245dc=await this[_0x4c26b3(0xd4)](),_0x26aa4a=await this[_0x4c26b3(0x158)](),_0x3c449f=await this[_0x4c26b3(0xe8)](),_0x3a1551=await this[_0x4c26b3(0x132)](),_0x868642=await this['countTodayCollection'](),_0x58b514=await this[_0x4c26b3(0x153)](),_0x1fd947=await this[_0x4c26b3(0xda)](),_0xc19fe0=await this[_0x4c26b3(0xe6)]();return{'userCount':_0x2dc7f9,'newUserCount':_0x27aa7c,'chatCount':_0x50342e,'newChatCount':_0x5350e6,'drawCount':_0x4dbcce,'newDrawCount':_0x26aa4a+_0x5245dc,'orderCount':_0x3c449f,'newOrderCount':_0x3a1551,'todayBrokerage':0x0,'totalBrokerage':0x0,'todayCollection':_0x868642,'totalCollection':_0x58b514,'todayMusic':_0x1fd947,'totalMusic':_0xc19fe0,'todayVideo':0x0,'totalVideo':0x0};}async[_0x12af46(0xeb)]({days:days=0x7}){const _0x1de409=_0x12af46,_0x24e192=await this['countChatsByTimeRange'](days),_0x5ee20d=await this['countDrawsByTimeRange'](days),_0x2039c2=await this[_0x1de409(0x150)](days);return{'date':_0x24e192[_0x1de409(0x11a)](_0x25b7fa=>_0x25b7fa[_0x1de409(0x13e)]),'chat':_0x24e192['map'](_0x55ed99=>_0x55ed99[_0x1de409(0xea)]),'draw':_0x5ee20d[_0x1de409(0x11a)]((_0x4171b0,_0x39ef14)=>{const _0x4b936f=_0x1de409;return _0x4171b0[_0x4b936f(0xea)]+_0x2039c2[_0x39ef14][_0x4b936f(0xea)];})};}async[_0x12af46(0x131)]({days:days=0x7}){const _0x2fe4c7=_0x12af46,_0x2cc96f=await this[_0x2fe4c7(0xf7)](days);return _0x2cc96f;}async['countUsers'](){const _0x21ba19=await this['userEntity']['count']();return _0x21ba19;}async[_0x12af46(0x127)](){const _0x2e43bf=_0x12af46,_0x491d8c=new Date();_0x491d8c['setHours'](0x0,0x0,0x0,0x0);const _0x56c444=new Date(_0x491d8c[_0x2e43bf(0xfa)]()+0x18*0x3c*0x3c*0x3e8),_0x4d0bab=this[_0x2e43bf(0x128)][_0x2e43bf(0x117)](_0x2e43bf(0xd2)),_0xc2d79=await _0x4d0bab[_0x2e43bf(0x100)](_0x2e43bf(0x14e),{'today':_0x491d8c})[_0x2e43bf(0xf3)](_0x2e43bf(0x116),{'tomorrow':_0x56c444})[_0x2e43bf(0xe7)]();return _0xc2d79;}async['countChats'](){const _0x1c7e34=_0x12af46,_0x5bb1d9=await this[_0x1c7e34(0x11d)][_0x1c7e34(0x137)]({'where':{'type':balance_constant_1[_0x1c7e34(0xe3)][_0x1c7e34(0xd7)]}});return _0x5bb1d9;}async[_0x12af46(0x113)](){const _0x5f5ca3=_0x12af46,_0x1abee7=new Date();_0x1abee7[_0x5f5ca3(0x10d)](0x0,0x0,0x0,0x0);const _0x424569=new Date(_0x1abee7[_0x5f5ca3(0xfa)]()+0x18*0x3c*0x3c*0x3e8),_0x3aaa7a=this[_0x5f5ca3(0x11d)][_0x5f5ca3(0x117)](_0x5f5ca3(0xee)),_0x14f676=await _0x3aaa7a[_0x5f5ca3(0x100)](_0x5f5ca3(0x11e),{'type':balance_constant_1[_0x5f5ca3(0xe3)][_0x5f5ca3(0xd7)]})[_0x5f5ca3(0xf3)](_0x5f5ca3(0x118),{'today':_0x1abee7})['andWhere']('chatLog.createdAt\x20<\x20:tomorrow',{'tomorrow':_0x424569})[_0x5f5ca3(0xe7)]();return _0x14f676;}async['countDraws'](){const _0x92d54a=_0x12af46,_0x28107e=await this['chatLogEntity'][_0x92d54a(0x137)]({'where':{'type':balance_constant_1[_0x92d54a(0xe3)]['PAINT_TYPE']}});return _0x28107e;}async[_0x12af46(0xd4)](){const _0x518242=_0x12af46,_0x1f13c4=new Date();_0x1f13c4[_0x518242(0x10d)](0x0,0x0,0x0,0x0);const _0x30f7f8=new Date(_0x1f13c4[_0x518242(0xfa)]()+0x18*0x3c*0x3c*0x3e8),_0x39fcb4=this[_0x518242(0x11d)][_0x518242(0x117)](_0x518242(0xee)),_0x3fd91f=await _0x39fcb4['where'](_0x518242(0x11e),{'type':balance_constant_1['DeductionKey']['PAINT_TYPE']})[_0x518242(0xf3)](_0x518242(0x118),{'today':_0x1f13c4})[_0x518242(0xf3)](_0x518242(0x148),{'tomorrow':_0x30f7f8})[_0x518242(0xe7)]();return _0x3fd91f;}async[_0x12af46(0x158)](){const _0x1c0d84=_0x12af46,_0xca4759=new Date();_0xca4759[_0x1c0d84(0x10d)](0x0,0x0,0x0,0x0);const _0x5ca807=new Date(_0xca4759[_0x1c0d84(0xfa)]()+0x18*0x3c*0x3c*0x3e8),_0x5df00e=this[_0x1c0d84(0x111)][_0x1c0d84(0x117)](_0x1c0d84(0xd9)),_0x2969da=await _0x5df00e[_0x1c0d84(0x100)](_0x1c0d84(0x11f),{'today':_0xca4759})[_0x1c0d84(0xf3)](_0x1c0d84(0xd5),{'tomorrow':_0x5ca807})[_0x1c0d84(0xe7)]();return _0x2969da;}async[_0x12af46(0x134)](_0x3e06fc){const _0x40b92a=_0x12af46,_0x3f561e=new Date();_0x3f561e[_0x40b92a(0x10d)](0x0,0x0,0x0,0x0);const _0x332f28=new Date(_0x3f561e[_0x40b92a(0xfa)]()-(_0x3e06fc-0x1)*0x18*0x3c*0x3c*0x3e8),_0x24de36=this[_0x40b92a(0x11d)][_0x40b92a(0x117)]('chatlog'),_0x40903b=await _0x24de36['select'](_0x40b92a(0xf0))['where'](_0x40b92a(0xfd),{'type':balance_constant_1[_0x40b92a(0xe3)][_0x40b92a(0xd7)]})[_0x40b92a(0xf3)](_0x40b92a(0xdc),{'startDate':_0x332f28})[_0x40b92a(0xe4)](_0x40b92a(0x13e))[_0x40b92a(0x141)]('date')[_0x40b92a(0x138)](),_0x3f8e31=[],_0x2af329=_0x332f28;for(let _0xc25900=0x0;_0xc25900<_0x3e06fc;_0xc25900++){const _0x5b251b=(0x0,date_1[_0x40b92a(0x143)])(new Date(_0x2af329),'M.DD'),_0x1b999a=_0x40903b[_0x40b92a(0x15d)](_0x2ebebd=>(0x0,date_1[_0x40b92a(0x143)])(new Date(_0x2ebebd[_0x40b92a(0x13e)]),_0x40b92a(0x139))===_0x5b251b)?.[_0x40b92a(0x137)]??0x0;_0x1b999a>0x0?_0x3f8e31['push']({'date':_0x5b251b,'value':Number(_0x1b999a)}):_0x3f8e31[_0x40b92a(0xed)]({'date':_0x5b251b,'value':0x0}),_0x2af329['setDate'](_0x2af329[_0x40b92a(0xdf)]()+0x1);}return _0x3f8e31;}async['countDrawsByTimeRange'](_0x6c0ee7){const _0x47626c=_0x12af46,_0x1338e4=new Date();_0x1338e4[_0x47626c(0x10d)](0x0,0x0,0x0,0x0);const _0x2e0768=new Date(_0x1338e4[_0x47626c(0xfa)]()-(_0x6c0ee7-0x1)*0x18*0x3c*0x3c*0x3e8),_0x4d2270=this[_0x47626c(0x11d)][_0x47626c(0x117)]('chatlog'),_0x436eca=await _0x4d2270['select'](_0x47626c(0xf0))[_0x47626c(0x100)](_0x47626c(0xfd),{'type':balance_constant_1[_0x47626c(0xe3)][_0x47626c(0x13c)]})[_0x47626c(0xf3)](_0x47626c(0xdc),{'startDate':_0x2e0768})[_0x47626c(0xe4)](_0x47626c(0x13e))[_0x47626c(0x141)](_0x47626c(0x13e))['getRawMany'](),_0xa4fbb2=[],_0x4f9b60=_0x2e0768;for(let _0x32abba=0x0;_0x32abba<_0x6c0ee7;_0x32abba++){const _0x22c1fb=(0x0,date_1[_0x47626c(0x143)])(new Date(_0x4f9b60),_0x47626c(0x139)),_0x4f4281=_0x436eca['find'](_0x5bfadf=>(0x0,date_1[_0x47626c(0x143)])(new Date(_0x5bfadf[_0x47626c(0x13e)]),_0x47626c(0x139))===_0x22c1fb)?.[_0x47626c(0x137)]??0x0;_0x4f4281>0x0?_0xa4fbb2[_0x47626c(0xed)]({'date':_0x22c1fb,'value':Number(_0x4f4281)}):_0xa4fbb2[_0x47626c(0xed)]({'date':_0x22c1fb,'value':0x0}),_0x4f9b60[_0x47626c(0x145)](_0x4f9b60[_0x47626c(0xdf)]()+0x1);}return _0xa4fbb2;}async[_0x12af46(0x150)](_0x283ec1){const _0x1ecd26=_0x12af46,_0x53652a=new Date();_0x53652a[_0x1ecd26(0x10d)](0x0,0x0,0x0,0x0);const _0x5f479e=new Date(_0x53652a[_0x1ecd26(0xfa)]()-(_0x283ec1-0x1)*0x18*0x3c*0x3c*0x3e8),_0x520d9f=this['midjourneyEntity']['createQueryBuilder'](_0x1ecd26(0xd9)),_0x599988=await _0x520d9f[_0x1ecd26(0x10e)](_0x1ecd26(0x14b))[_0x1ecd26(0x100)]('midjourney.status\x20=\x20:status',{'status':midjourney_constant_1[_0x1ecd26(0x12b)]['DRAWED']})[_0x1ecd26(0xf3)](_0x1ecd26(0x121),{'startDate':_0x5f479e})[_0x1ecd26(0xe4)](_0x1ecd26(0x13e))[_0x1ecd26(0x141)](_0x1ecd26(0x13e))[_0x1ecd26(0x138)](),_0x2b1452=[],_0x195817=_0x5f479e;for(let _0xbba04e=0x0;_0xbba04e<_0x283ec1;_0xbba04e++){const _0x590d4e=(0x0,date_1['formatDate'])(new Date(_0x195817),_0x1ecd26(0x139)),_0x4e8bb7=_0x599988[_0x1ecd26(0x15d)](_0x59494f=>(0x0,date_1[_0x1ecd26(0x143)])(new Date(_0x59494f['date']),_0x1ecd26(0x139))===_0x590d4e)?.[_0x1ecd26(0x137)]??0x0;_0x4e8bb7>0x0?_0x2b1452[_0x1ecd26(0xed)]({'date':_0x590d4e,'value':Number(_0x4e8bb7)}):_0x2b1452[_0x1ecd26(0xed)]({'date':_0x590d4e,'value':0x0}),_0x195817['setDate'](_0x195817['getDate']()+0x1);}return _0x2b1452;}async['getBaiduStatistics'](_0x1b8eaa){const _0x54015c=_0x12af46,_0x1ff590=(0x0,date_1[_0x54015c(0x143)])(new Date(),_0x54015c(0x120)),_0x24b3e7=(0x0,date_1[_0x54015c(0x143)])(new Date(Date[_0x54015c(0x101)]()-Number(_0x1b8eaa-0x1)*0x18*0x3c*0x3c*0x3e8),_0x54015c(0x120)),_0x1cfba8=_0x54015c(0xf8),_0x5c7ae4=_0x54015c(0xd8),_0xff16b=await this[_0x54015c(0x112)]['find']({'where':{'configKey':(0x0,typeorm_2['In'])(['baiduToken',_0x54015c(0x144)])}}),_0x2faf19=_0xff16b[_0x54015c(0x15d)](_0x2762fb=>_0x2762fb['configKey']===_0x54015c(0x144))?.[_0x54015c(0xfc)],_0x31b74e=_0xff16b[_0x54015c(0x15d)](_0x22b6b8=>_0x22b6b8[_0x54015c(0xff)]==='baiduToken')?.['configVal'];if(!_0x2faf19||!_0x31b74e)return[];if(!_0x2faf19)throw new common_1[(_0x54015c(0x155))](_0x54015c(0x10c),common_1[_0x54015c(0xfe)][_0x54015c(0x107)]);if(!_0x31b74e)throw new common_1[(_0x54015c(0x155))]('请先配置百度统计accessToken',common_1['HttpStatus'][_0x54015c(0x107)]);const _0x337dbd=_0x54015c(0xf9)+_0x31b74e+_0x54015c(0x103)+_0x2faf19+_0x54015c(0xef)+_0x5c7ae4+_0x54015c(0x12a)+_0x24b3e7+_0x54015c(0xec)+_0x1ff590+'&metrics='+_0x1cfba8,_0x3b19e5=await axios_1[_0x54015c(0x11c)][_0x54015c(0x10a)](_0x337dbd),{error_code:_0x2e7f97,message:_0x2c79aa}=_0x3b19e5[_0x54015c(0x125)];if(_0x2e7f97===0x6f)throw new common_1['HttpException'](_0x2c79aa||'百度授权码过期',common_1[_0x54015c(0xfe)][_0x54015c(0x107)]);if(_0x2e7f97&&_0x2e7f97!==0xc8)throw new common_1['HttpException'](_0x2c79aa||_0x54015c(0xf4),common_1[_0x54015c(0xfe)][_0x54015c(0x107)]);return _0x3b19e5['data'][_0x54015c(0xe2)];}async[_0x12af46(0xe8)](){const _0x394162=_0x12af46,_0xb07a15=await this[_0x394162(0x114)]['count']();return _0xb07a15;}async['countNewOrdersToday'](){const _0x58bc0f=_0x12af46,_0x493a00=new Date();_0x493a00[_0x58bc0f(0x10d)](0x0,0x0,0x0,0x0);const _0x52b50f=new Date(_0x493a00[_0x58bc0f(0xfa)]()+0x18*0x3c*0x3c*0x3e8),_0x40dc6f=this[_0x58bc0f(0x114)][_0x58bc0f(0x117)]('order'),_0x4fc504=await _0x40dc6f[_0x58bc0f(0x100)]('order.createdAt\x20>=\x20:today',{'today':_0x493a00})[_0x58bc0f(0xf3)](_0x58bc0f(0xe1),{'tomorrow':_0x52b50f})['getCount']();return _0x4fc504;}async['countTodayMusic'](){const _0x1a6187=_0x12af46,_0x1a735e=new Date();_0x1a735e[_0x1a6187(0x10d)](0x0,0x0,0x0,0x0);const _0x5b6016=new Date(_0x1a735e[_0x1a6187(0xfa)]()+0x18*0x3c*0x3c*0x3e8),_0x487f85=this[_0x1a6187(0x11d)][_0x1a6187(0x117)](_0x1a6187(0x14c)),_0x28917c=await _0x487f85[_0x1a6187(0x100)](_0x1a6187(0x11b))[_0x1a6187(0xf3)](_0x1a6187(0x124))[_0x1a6187(0xf3)](_0x1a6187(0xf1),{'today':_0x1a735e})[_0x1a6187(0xf3)](_0x1a6187(0xd0),{'tomorrow':_0x5b6016})['getCount']();return _0x28917c;}async[_0x12af46(0xe6)](){const _0x4d4515=_0x12af46,_0x454f41=await this[_0x4d4515(0x11d)]['count']({'where':{'modelType':_0x4d4515(0x156),'answer':(0x0,typeorm_2[_0x4d4515(0x122)])((0x0,typeorm_2[_0x4d4515(0xfb)])())}});return _0x454f41;}async[_0x12af46(0x14a)](){const _0x29f975=_0x12af46,_0x4c51ae=await this['connection'][_0x29f975(0x13d)](_0x29f975(0xde)),_0x24f94c=_0x4c51ae[_0x29f975(0x13f)]?Number(_0x4c51ae['sum']):0x0;return _0x24f94c[_0x29f975(0x13a)](0x2);}async[_0x12af46(0x153)](){const _0x81eafb=_0x12af46,_0xc56a75=await this['connection']['query']('SELECT\x20SUM(price)\x20sum\x20FROM\x20`order`\x20WHERE\x20status\x20=\x201'),_0x39c221=_0xc56a75[_0x81eafb(0x13f)]?Number(_0xc56a75['sum']):0x0;return _0x39c221[_0x81eafb(0x13a)](0x2);}async[_0x12af46(0x140)](_0x58e7e9){const _0x385e92=_0x12af46,_0x29b1a7=await this[_0x385e92(0x106)][_0x385e92(0x13d)](_0x385e92(0xe9)+_0x58e7e9['startTime']+'\x27\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20AND\x20createdAt\x20<=\x20\x27'+_0x58e7e9[_0x385e92(0x15e)]+_0x385e92(0x102)),_0x377d71=(0x0,date_1[_0x385e92(0x11c)])(_0x58e7e9[_0x385e92(0xd1)])[_0x385e92(0x142)]((0x0,date_1['default'])(_0x58e7e9[_0x385e92(0x15e)]),_0x385e92(0x126)),_0x412e02=_0x377d71===0x0?_0x385e92(0x12c):'%Y-%m-%d',_0x12a78b=await this[_0x385e92(0x106)]['query']('\x0a\x20\x20\x20\x20\x20\x20SELECT\x0a\x20\x20\x20\x20\x20\x20\x20\x20DATE_FORMAT(\x20createdAt,\x20\x27'+_0x412e02+_0x385e92(0x109)+_0x58e7e9[_0x385e92(0xd1)]+_0x385e92(0x10f)+_0x58e7e9[_0x385e92(0x15e)]+'\x27\x20\x0a\x20\x20\x20\x20\x20\x20GROUP\x20BY\x0a\x20\x20\x20\x20\x20\x20\x20\x20groupeName\x20\x0a\x20\x20\x20\x20\x20\x20ORDER\x20BY\x0a\x20\x20\x20\x20\x20\x20\x20\x20groupeName;\x0a\x20\x20\x20\x20');return{'pie':_0x29b1a7,'line':_0x12a78b};}};StatisticService=__decorate([(0x0,common_1[_0x12af46(0xd6)])(),__param(0x0,(0x0,typeorm_1[_0x12af46(0x104)])(user_entity_1[_0x12af46(0x14d)])),__param(0x1,(0x0,typeorm_1[_0x12af46(0x104)])(chatLog_entity_1[_0x12af46(0xf6)])),__param(0x2,(0x0,typeorm_1['InjectRepository'])(config_entity_1['ConfigEntity'])),__param(0x3,(0x0,typeorm_1[_0x12af46(0x104)])(order_entity_1[_0x12af46(0x115)])),__param(0x4,(0x0,typeorm_1['InjectRepository'])(midjourney_entity_1[_0x12af46(0xe5)])),__metadata(_0x12af46(0x154),[typeorm_2[_0x12af46(0xf2)],typeorm_2['Repository'],typeorm_2[_0x12af46(0xf2)],typeorm_2[_0x12af46(0xf2)],typeorm_2[_0x12af46(0xf2)],typeorm_2['Connection']])],StatisticService),exports['StatisticService']=StatisticService;