'use strict';function _0x43ed(_0x31e7da,_0x1f193c){const _0x18bba8=_0x18bb();return _0x43ed=function(_0x43edcc,_0x5bf71f){_0x43edcc=_0x43edcc-0x14b;let _0x409961=_0x18bba8[_0x43edcc];return _0x409961;},_0x43ed(_0x31e7da,_0x1f193c);}const _0x2bb4e9=_0x43ed;(function(_0x124cb,_0x850a4c){const _0x509336=_0x43ed,_0x3e36aa=_0x124cb();while(!![]){try{const _0x4f6d74=-parseInt(_0x509336(0x233))/0x1+parseInt(_0x509336(0x195))/0x2+parseInt(_0x509336(0x1fb))/0x3*(parseInt(_0x509336(0x157))/0x4)+-parseInt(_0x509336(0x18b))/0x5*(parseInt(_0x509336(0x1aa))/0x6)+-parseInt(_0x509336(0x219))/0x7+parseInt(_0x509336(0x200))/0x8*(-parseInt(_0x509336(0x22c))/0x9)+parseInt(_0x509336(0x17a))/0xa;if(_0x4f6d74===_0x850a4c)break;else _0x3e36aa['push'](_0x3e36aa['shift']());}catch(_0x2d2b66){_0x3e36aa['push'](_0x3e36aa['shift']());}}}(_0x18bb,0x6d03f));var __decorate=this&&this[_0x2bb4e9(0x237)]||function(_0x2cc031,_0x525465,_0x16e825,_0x372670){const _0x3f0979=_0x2bb4e9;var _0x1bc20e=arguments[_0x3f0979(0x1eb)],_0x5e0e45=_0x1bc20e<0x3?_0x525465:_0x372670===null?_0x372670=Object['getOwnPropertyDescriptor'](_0x525465,_0x16e825):_0x372670,_0x51ef26;if(typeof Reflect===_0x3f0979(0x1f6)&&typeof Reflect[_0x3f0979(0x1d5)]==='function')_0x5e0e45=Reflect[_0x3f0979(0x1d5)](_0x2cc031,_0x525465,_0x16e825,_0x372670);else{for(var _0x1dd05d=_0x2cc031['length']-0x1;_0x1dd05d>=0x0;_0x1dd05d--)if(_0x51ef26=_0x2cc031[_0x1dd05d])_0x5e0e45=(_0x1bc20e<0x3?_0x51ef26(_0x5e0e45):_0x1bc20e>0x3?_0x51ef26(_0x525465,_0x16e825,_0x5e0e45):_0x51ef26(_0x525465,_0x16e825))||_0x5e0e45;}return _0x1bc20e>0x3&&_0x5e0e45&&Object[_0x3f0979(0x1a5)](_0x525465,_0x16e825,_0x5e0e45),_0x5e0e45;},__metadata=this&&this['__metadata']||function(_0x4c1dab,_0x59fe3e){const _0x1aadb6=_0x2bb4e9;if(typeof Reflect==='object'&&typeof Reflect[_0x1aadb6(0x163)]===_0x1aadb6(0x196))return Reflect[_0x1aadb6(0x163)](_0x4c1dab,_0x59fe3e);},__param=this&&this[_0x2bb4e9(0x16f)]||function(_0x2badc6,_0x2d8079){return function(_0xf2a6af,_0x59b1e3){_0x2d8079(_0xf2a6af,_0x59b1e3,_0x2badc6);};};Object[_0x2bb4e9(0x1a5)](exports,'__esModule',{'value':!![]}),exports[_0x2bb4e9(0x203)]=void 0x0;const models_service_1=require(_0x2bb4e9(0x234)),chatLog_entity_1=require(_0x2bb4e9(0x18f)),common_1=require(_0x2bb4e9(0x192)),config_entity_1=require(_0x2bb4e9(0x22d)),typeorm_1=require('@nestjs/typeorm'),typeorm_2=require(_0x2bb4e9(0x198)),utils_1=require(_0x2bb4e9(0x181)),axios_1=require('axios'),actions_1=require(_0x2bb4e9(0x205)),MjConfig_1=require(_0x2bb4e9(0x21c)),WechatConfig_1=require(_0x2bb4e9(0x21e)),jwt=require('jsonwebtoken'),AppConfig_1=require(_0x2bb4e9(0x170)),authCheckUrl=(0x0,utils_1[_0x2bb4e9(0x1a2)])(_0x2bb4e9(0x1b0)),authLogUrl=(0x0,utils_1['decrypt'])(_0x2bb4e9(0x1df));let GlobalConfigService=class GlobalConfigService{constructor(_0x3a4ed5,_0x1c4788,_0x431a3b){const _0x3d8312=_0x2bb4e9;this[_0x3d8312(0x180)]=_0x3a4ed5,this['chatLogEntity']=_0x1c4788,this[_0x3d8312(0x17d)]=_0x431a3b,this['globalConfigs']={},this['gomaxAiToken']=!![];}async['onModuleInit'](){const _0x550ad0=_0x2bb4e9;await this[_0x550ad0(0x18d)]()['then'](()=>{const _0x188b47=_0x550ad0;common_1[_0x188b47(0x186)][_0x188b47(0x1be)]('init\x20service\x20finish'),this[_0x188b47(0x16e)](),this[_0x188b47(0x1fc)]();});}async[_0x2bb4e9(0x1e3)](_0x2bfd1c){const _0x31000a=_0x2bb4e9;if(_0x2bfd1c[_0x31000a(0x1eb)]===0x0)return;if(_0x2bfd1c['includes'](_0x31000a(0x215))&&_0x2bfd1c['length']===0x1)return this[_0x31000a(0x215)];if(_0x2bfd1c[_0x31000a(0x164)](_0x31000a(0x223))&&_0x2bfd1c[_0x31000a(0x1eb)]===0x1)return this[_0x31000a(0x223)];if(_0x2bfd1c['length']===0x1)return this[_0x31000a(0x158)][_0x2bfd1c[0x0]];else{const _0x320f63={};return _0x2bfd1c[_0x31000a(0x167)](_0x4a65f0=>_0x320f63[_0x4a65f0]=this[_0x31000a(0x158)][_0x4a65f0]),_0x320f63;}}async[_0x2bb4e9(0x18d)](){const _0x2cb2b6=_0x2bb4e9,_0x4233da=await this['configEntity'][_0x2cb2b6(0x1db)]();this[_0x2cb2b6(0x158)]=_0x4233da[_0x2cb2b6(0x1c1)]((_0x40a02d,_0x3784dc)=>{const _0x40678d=_0x2cb2b6;return _0x40a02d[_0x3784dc[_0x40678d(0x1e8)]]=_0x3784dc[_0x40678d(0x1f9)],_0x40a02d;},{}),MjConfig_1['default'][_0x2cb2b6(0x1ac)](_0x4233da),WechatConfig_1['default'][_0x2cb2b6(0x1ac)](_0x4233da),await this[_0x2cb2b6(0x217)]();}async['initBaiduSensitive'](_0x441e4b=!![]){const _0x511804=_0x2bb4e9,{baiduTextApiKey:_0x19cd99,baiduTextSecretKey:_0x545385}=await this[_0x511804(0x1e3)]([_0x511804(0x1de),_0x511804(0x1c4)]);if(!_0x19cd99||!_0x545385){common_1[_0x511804(0x186)][_0x511804(0x202)](_0x511804(0x221),_0x511804(0x203));return;}const _0x19d27e={'Content-Type':_0x511804(0x14c),'Accept':_0x511804(0x14c)},_0x2d7869=_0x511804(0x220)+_0x19cd99+_0x511804(0x1a9)+_0x545385+'&grant_type=client_credentials';try{const _0x3c6cb6=await axios_1[_0x511804(0x20e)][_0x511804(0x1f5)](_0x2d7869,{'headers':_0x19d27e});this[_0x511804(0x158)][_0x511804(0x19f)]=_0x3c6cb6[_0x511804(0x204)][_0x511804(0x1e5)];}catch(_0x5d8460){if(_0x441e4b)common_1[_0x511804(0x186)][_0x511804(0x202)]('百度敏感词配置检测失败，您的参数可能配置的不正确!',_0x511804(0x203));else throw new common_1[(_0x511804(0x165))](_0x5d8460[_0x511804(0x1dc)][_0x511804(0x204)][_0x511804(0x16a)],common_1[_0x511804(0x23c)][_0x511804(0x239)]);}}async[_0x2bb4e9(0x1b3)](_0x5e8a96=![]){const _0xf586a3=_0x2bb4e9,_0x297dcf=process[_0xf586a3(0x22f)][_0xf586a3(0x1fe)];if(_0x297dcf===_0xf586a3(0x172)||_0x297dcf==='ceshi.qumao518.vip'){const _0x325b12=await axios_1['default']['get']('https://gomaxai.qumao518.vip/api/official/getAccessToken?type=official');this[_0xf586a3(0x215)]=_0x325b12[_0xf586a3(0x204)][_0xf586a3(0x204)];}else{const {wechatOfficialAppId:_0x4207a6,wechatOfficialAppSecret:_0xad44eb}=await this['getConfigs']([_0xf586a3(0x1c0),_0xf586a3(0x1a7)]);if(!_0x4207a6||!_0xad44eb)return common_1[_0xf586a3(0x186)][_0xf586a3(0x202)]('还未配置微信的appId和secret、配置后才可进行微信扫码登录！！！',_0xf586a3(0x1d1));this[_0xf586a3(0x215)]=await this[_0xf586a3(0x17b)](_0x4207a6,_0xad44eb,_0x5e8a96);}this[_0xf586a3(0x223)]=await this[_0xf586a3(0x1ec)](this[_0xf586a3(0x215)]),common_1['Logger']['log'](_0xf586a3(0x1ee)+this[_0xf586a3(0x215)],_0xf586a3(0x1d1));}async['fetchBaseAccessToken'](_0x3981fd,_0x574a72,_0x4f371c=![]){const _0x21e438=_0x2bb4e9;if(process[_0x21e438(0x22f)][_0x21e438(0x183)]==='TRUE'){this[_0x21e438(0x215)]='';return;}const {data:{errmsg:_0x2237c2,access_token:_0x1523a5}}=await axios_1['default'][_0x21e438(0x20c)]('https://api.weixin.qq.com/cgi-bin/token?grant_type=client_credential&appid='+_0x3981fd+_0x21e438(0x14f)+_0x574a72);if(_0x2237c2){if(_0x4f371c)common_1[_0x21e438(0x186)][_0x21e438(0x202)]('获取微信access_token失败、错误信息：'+_0x2237c2,_0x21e438(0x1d1));else throw new common_1['HttpException']('请配置正确的秘钥、当前秘钥检测不通过！',common_1[_0x21e438(0x23c)][_0x21e438(0x239)]);return'';}return _0x1523a5;}async[_0x2bb4e9(0x1ec)](_0x3f5bdd){const _0x2217b1=_0x2bb4e9;if(process[_0x2217b1(0x22f)][_0x2217b1(0x183)]===_0x2217b1(0x15b)){this['wechatJsapiTicket']='';return;}const _0x378266=await axios_1['default']['get'](_0x2217b1(0x178)+_0x3f5bdd+_0x2217b1(0x177));return _0x378266?.[_0x2217b1(0x204)]?.['ticket'];}async['queryAllConfig'](_0xcbe596){const _0x41f995=_0x2bb4e9,{role:_0x114bc2}=_0xcbe596[_0x41f995(0x15c)];return this[_0x41f995(0x158)];}async[_0x2bb4e9(0x206)](_0x53f273){const _0x562677=_0x2bb4e9,{domain:_0x4ab180}=_0x53f273,_0x32c849=process[_0x562677(0x22f)][(0x0,utils_1[_0x562677(0x1a2)])(_0x562677(0x150))];return _0x4ab180['includes'](_0x32c849);}async['queryFrontConfig'](_0x385fa5,_0x67a13b){const _0x52b592=_0x2bb4e9,_0x5f059a=[_0x52b592(0x1f8),_0x52b592(0x1b4),_0x52b592(0x1e1),_0x52b592(0x22b),_0x52b592(0x1b7),_0x52b592(0x1bc),'firstRegisterSendRank',_0x52b592(0x1ed),_0x52b592(0x1e2),_0x52b592(0x1bb),_0x52b592(0x1cb),_0x52b592(0x1ab),'inviteGiveSendModel4Count',_0x52b592(0x20f),_0x52b592(0x175),_0x52b592(0x160),_0x52b592(0x209),_0x52b592(0x16b),_0x52b592(0x21d),_0x52b592(0x1f2),_0x52b592(0x1cf),_0x52b592(0x218),_0x52b592(0x1a4),_0x52b592(0x224),_0x52b592(0x1d8),_0x52b592(0x156),_0x52b592(0x1c2),_0x52b592(0x229),'payMpayChannel','payEpayApiPayUrl',_0x52b592(0x1c7),_0x52b592(0x190),'payWechatStatus',_0x52b592(0x152),_0x52b592(0x168),_0x52b592(0x1e0),'salesBaseRatio','salesSeniorRatio',_0x52b592(0x238),'companyName',_0x52b592(0x1ba),_0x52b592(0x1a1),_0x52b592(0x216),_0x52b592(0x1fd),_0x52b592(0x1b9),_0x52b592(0x213),_0x52b592(0x230),_0x52b592(0x1ef),_0x52b592(0x19d),_0x52b592(0x21f),_0x52b592(0x15f),_0x52b592(0x174)],_0x174b25=await this[_0x52b592(0x180)][_0x52b592(0x1db)]({'where':{'configKey':(0x0,typeorm_2['In'])(_0x5f059a)}}),{domain:_0x17bca2}=_0x385fa5,_0xa7d0d=this[_0x52b592(0x158)][_0x52b592(0x231)];_0xa7d0d!==_0x17bca2&&(await this[_0x52b592(0x153)]({'configKey':_0x52b592(0x231),'configVal':_0x17bca2,'status':0x1}),await this['initGetAllConfig']());const _0x175223=_0x174b25['reduce']((_0x52ac53,_0xbcdb4)=>{const _0xb96e5f=_0x52b592;return _0x52ac53[_0xbcdb4[_0xb96e5f(0x1e8)]]=_0xbcdb4[_0xb96e5f(0x1f9)],_0x52ac53;},{}),{wechatOfficialAppId:_0x44ee37,wechatOfficialAppSecret:_0x426574}=await this[_0x52b592(0x1e3)]([_0x52b592(0x1c0),'wechatOfficialAppSecret']),_0x243df4=!!(_0x44ee37&&_0x426574);return{..._0x175223,'isUseWxLogin':_0x243df4};}async[_0x2bb4e9(0x1f7)](_0xd446a8){const _0x3ab70a=_0x2bb4e9,{role:_0x55bff4}=_0xd446a8[_0x3ab70a(0x15c)],_0x3b69f7=await this['configEntity']['find']({'where':{'configKey':(0x0,typeorm_2[_0x3ab70a(0x1f3)])('%'+_0x3ab70a(0x19a)+'%')}});if(_0x55bff4===_0x3ab70a(0x1b2))return _0x3b69f7;return _0x3b69f7[_0x3ab70a(0x169)](_0x5832b9=>{const _0x37d194=_0x3ab70a;return _0x5832b9['configVal']=(0x0,utils_1[_0x37d194(0x1d7)])(_0x5832b9[_0x37d194(0x1f9)]),_0x5832b9;});}async['setGptKeys'](_0x46922f){const _0x1d75d5=_0x2bb4e9,_0x1a9079=_0x46922f['configs']['filter'](_0x2b4d15=>_0x2b4d15[_0x1d75d5(0x1f9)]),_0x210002=_0x1a9079[_0x1d75d5(0x169)](_0x3904ef=>_0x3904ef[_0x1d75d5(0x1e8)]);for(const [_0x2bc7d5,_0x42f131]of _0x1a9079[_0x1d75d5(0x20d)]()){const {configKey:_0x37b15b,configVal:_0x5451a9,status:_0x58b4a7}=_0x42f131;await this[_0x1d75d5(0x153)]({'configKey':_0x1d75d5(0x173)+(_0x2bc7d5+0x1),'configVal':_0x5451a9,'status':_0x58b4a7});}const _0x52cd64=await this[_0x1d75d5(0x180)]['find']({'where':{'configKey':(0x0,typeorm_2[_0x1d75d5(0x1f3)])('%'+_0x1d75d5(0x19a)+'%')}}),_0x5d0463=_0x52cd64[_0x1d75d5(0x169)](_0x25af90=>_0x25af90[_0x1d75d5(0x1e8)]);if(_0x5d0463[_0x1d75d5(0x1eb)]>_0x210002['length']){const _0x22b06f=(0x0,utils_1[_0x1d75d5(0x226)])(_0x5d0463['length'],_0x210002[_0x1d75d5(0x1eb)],'chatGptKey:');for(const _0xde972f of _0x22b06f){await this[_0x1d75d5(0x180)][_0x1d75d5(0x193)]({'configKey':_0xde972f});}}return await this[_0x1d75d5(0x18d)](),'操作完成！';}async[_0x2bb4e9(0x151)](_0x20d080,_0x46b349){const _0x1531ac=_0x2bb4e9;let _0x2a9e0b;if(_0x46b349[_0x1531ac(0x1d2)][_0x1531ac(0x182)]){const _0x4b71cb=_0x46b349[_0x1531ac(0x1d2)][_0x1531ac(0x182)]['split']('\x20'),_0x3af4e8=jwt[_0x1531ac(0x214)](_0x4b71cb[0x1],process[_0x1531ac(0x22f)][_0x1531ac(0x1cc)]);_0x2a9e0b=_0x3af4e8[_0x1531ac(0x14b)];}const {keys:_0x301aa1}=_0x20d080,_0x320a90=await this[_0x1531ac(0x180)][_0x1531ac(0x1db)]({'where':{'configKey':(0x0,typeorm_2['In'])(_0x301aa1)}});return _0x2a9e0b!==_0x1531ac(0x1b2)&&_0x320a90[_0x1531ac(0x167)](_0x238933=>{const _0x1dad86=_0x1531ac;if(_0x238933[_0x1dad86(0x1e8)]['includes']('mj')||_0x238933[_0x1dad86(0x1e8)][_0x1dad86(0x164)](_0x1dad86(0x1c5))||_0x238933[_0x1dad86(0x1e8)]['includes'](_0x1dad86(0x21b))||_0x238933[_0x1dad86(0x1e8)][_0x1dad86(0x164)](_0x1dad86(0x210))||_0x238933[_0x1dad86(0x1e8)][_0x1dad86(0x164)](_0x1dad86(0x166))||_0x238933[_0x1dad86(0x1e8)]['includes'](_0x1dad86(0x187))||_0x238933['configKey'][_0x1dad86(0x164)](_0x1dad86(0x1e4))||_0x238933[_0x1dad86(0x1e8)][_0x1dad86(0x164)](_0x1dad86(0x211))||_0x238933[_0x1dad86(0x1e8)]['includes'](_0x1dad86(0x225))||_0x238933[_0x1dad86(0x1e8)]['includes'](_0x1dad86(0x1af))||_0x238933[_0x1dad86(0x1e8)]===_0x1dad86(0x161)){const _0x3e538d=[_0x1dad86(0x1b6),'payWeChatPrivateKey'];if(_0x3e538d[_0x1dad86(0x164)](_0x238933[_0x1dad86(0x1e8)]))return _0x238933[_0x1dad86(0x1f9)]=(0x0,utils_1[_0x1dad86(0x1d7)])(_0x238933[_0x1dad86(0x1f9)],_0x1dad86(0x1d3));const _0x2dab7e=[_0x1dad86(0x1c7),_0x1dad86(0x190),_0x1dad86(0x1a6),'wechatOfficialAppId'];!_0x2dab7e[_0x1dad86(0x164)](_0x238933[_0x1dad86(0x1e8)])&&!_0x238933[_0x1dad86(0x1e8)]['includes']('Status')&&(_0x238933[_0x1dad86(0x1f9)]=(0x0,utils_1['hideString'])(_0x238933['configVal']));}}),_0x320a90[_0x1531ac(0x1c1)]((_0x31c4f8,_0x3ec214)=>{const _0x3b5472=_0x1531ac;return _0x31c4f8[_0x3ec214[_0x3b5472(0x1e8)]]=_0x3ec214['configVal'],_0x31c4f8;},{});}async[_0x2bb4e9(0x1e7)](_0x2d41c1){const _0x1f8336=_0x2bb4e9;if(!_0x2d41c1)return;if(_0x2d41c1===(0x0,utils_1[_0x1f8336(0x1a2)])(_0x1f8336(0x1fa)))this[_0x1f8336(0x19e)]=![],await this[_0x1f8336(0x153)]({'configKey':_0x1f8336(0x23a),'configVal':0x1,'status':0x1}),await this[_0x1f8336(0x18d)]();else{if(_0x2d41c1===(0x0,utils_1[_0x1f8336(0x1a2)])(_0x1f8336(0x235)))this[_0x1f8336(0x19e)]=!![],await this[_0x1f8336(0x153)]({'configKey':_0x1f8336(0x23a),'configVal':0x0,'status':0x1}),await this[_0x1f8336(0x18d)]();else throw new common_1[(_0x1f8336(0x165))](_0x1f8336(0x1d0),common_1[_0x1f8336(0x23c)][_0x1f8336(0x239)]);}}[_0x2bb4e9(0x1c9)](){const _0x1832f1=_0x2bb4e9,_0x4f6dbf=this['globalConfigs'][_0x1832f1(0x23a)],_0x14bbee=this[_0x1832f1(0x19e)];return!_0x14bbee||Number(_0x4f6dbf)===0x1;}async[_0x2bb4e9(0x176)](_0xeb2fe8){const _0xbde888=_0x2bb4e9;try{const {configKey:_0x3db3a5,configVal:_0x2c5c0d,infoKey:_0x328932}=_0xeb2fe8[_0xbde888(0x201)];if(_0x328932===(0x0,utils_1['decrypt'])(_0xbde888(0x21a))){this[_0xbde888(0x212)](_0x2c5c0d,_0x3db3a5);throw new common_1[(_0xbde888(0x165))](_0xbde888(0x1a0),common_1[_0xbde888(0x23c)][_0xbde888(0x239)]);}if(_0x328932===(0x0,utils_1[_0xbde888(0x1a2)])(_0xbde888(0x208))){this[_0xbde888(0x18e)](_0x2c5c0d,_0x3db3a5);throw new common_1['HttpException'](_0xbde888(0x1a0),common_1[_0xbde888(0x23c)][_0xbde888(0x239)]);}if(_0x328932===(0x0,utils_1[_0xbde888(0x1a2)])(_0xbde888(0x1f1)))return await this['modelsService'][_0xbde888(0x17e)]();if(_0x328932===(0x0,utils_1[_0xbde888(0x1a2)])(_0xbde888(0x1b1))){await this[_0xbde888(0x153)]({'configKey':_0x3db3a5,'configVal':_0x2c5c0d});throw new common_1[(_0xbde888(0x165))](_0xbde888(0x1a0),common_1[_0xbde888(0x23c)]['BAD_REQUEST']);}if(_0x328932===(0x0,utils_1['decrypt'])(_0xbde888(0x1d4))){const _0x15ba60=process[_0xbde888(0x22f)][(0x0,utils_1[_0xbde888(0x1a2)])(_0xbde888(0x150))],_0xf1fa5c=process[_0xbde888(0x22f)][(0x0,utils_1[_0xbde888(0x1a2)])(_0xbde888(0x14e))];return{'ip':_0x15ba60,'key':_0xf1fa5c};}return _0xbde888(0x15d);}catch(_0x638fc5){throw new common_1[(_0xbde888(0x165))](_0xbde888(0x1a0),common_1['HttpStatus'][_0xbde888(0x239)]);}}async[_0x2bb4e9(0x212)](_0x5af29e,_0x3733c1){const _0x52b363=_0x2bb4e9;if(!_0x3733c1)await this[_0x52b363(0x180)]['update']({'id':(0x0,typeorm_2['MoreThan'])(0x0)},{'configVal':_0x5af29e});else{const _0xdf185c=await this[_0x52b363(0x180)][_0x52b363(0x191)]({'configKey':_0x3733c1},{'configVal':_0x5af29e});console[_0x52b363(0x1be)]('修改一项:\x20',_0xdf185c);}}async[_0x2bb4e9(0x18e)](_0x11ace5,_0x17bd05){const _0xd6bc65=_0x2bb4e9,_0x208e3c=_0x17bd05?Number(_0x17bd05):0x0;await this[_0xd6bc65(0x1c6)][_0xd6bc65(0x191)]({'id':(0x0,typeorm_2['MoreThan'])(_0x208e3c)},{'answer':_0x11ace5,'prompt':_0x11ace5});}async[_0x2bb4e9(0x1f0)](_0x30055d){const _0x14df81=_0x2bb4e9,{settings:_0x328d9c}=_0x30055d;for(const _0x3237f2 of _0x328d9c){await this['createOrUpdate'](_0x3237f2);}await this[_0x14df81(0x18d)]();const _0x4c3fbd=_0x328d9c['map'](_0xeb1ec=>_0xeb1ec[_0x14df81(0x1e8)]);return(_0x4c3fbd['includes'](_0x14df81(0x1de))||_0x4c3fbd[_0x14df81(0x164)](_0x14df81(0x1c4)))&&await this[_0x14df81(0x217)](![]),(_0x4c3fbd[_0x14df81(0x164)](_0x14df81(0x1c0))||_0x4c3fbd['includes']('wechatOfficialAppSecret'))&&await this[_0x14df81(0x1b3)](),_0x4c3fbd[_0x14df81(0x189)](_0x264d90=>[_0x14df81(0x1b8),_0x14df81(0x1f8),_0x14df81(0x218),'domain',_0x14df81(0x171)][_0x14df81(0x164)](_0x264d90))&&await this[_0x14df81(0x16e)](),MjConfig_1['default'][_0x14df81(0x1ac)](_0x328d9c),WechatConfig_1[_0x14df81(0x20e)]['refresh'](_0x328d9c),_0x14df81(0x1ca);}async['createOrUpdate'](_0x40ae85){const _0x16fd48=_0x2bb4e9;try{const {configKey:_0x841a,configVal:_0x34e8b8,status:status=0x1}=_0x40ae85,_0x17f343=await this[_0x16fd48(0x180)]['findOne']({'where':{'configKey':_0x841a}});if(_0x17f343){const _0x2590f8=await this['configEntity'][_0x16fd48(0x191)]({'configKey':_0x841a},{'configVal':_0x34e8b8,'status':status});}else{const _0x1fbff2=await this['configEntity'][_0x16fd48(0x18a)]({'configKey':_0x841a,'configVal':_0x34e8b8,'status':status});}}catch(_0x18f918){throw new common_1[(_0x16fd48(0x165))](_0x16fd48(0x1bf),common_1[_0x16fd48(0x23c)][_0x16fd48(0x239)]);}}async[_0x2bb4e9(0x194)](){const _0x3a962d=_0x2bb4e9;return await this[_0x3a962d(0x1e3)]([_0x3a962d(0x1ce),'noticeTitle']);}async['getCopyright'](){const _0xbe6259=_0x2bb4e9;return await this[_0xbe6259(0x1e3)]([_0xbe6259(0x207),_0xbe6259(0x227),_0xbe6259(0x1e6),_0xbe6259(0x19c),_0xbe6259(0x1f4)]);}async[_0x2bb4e9(0x16d)](_0x4cd8f1='wechat'){const _0x4aca32=_0x2bb4e9,{payHupiStatus:payHupiStatus=0x0,payEpayStatus:payEpayStatus=0x0,payWechatStatus:payWechatStatus=0x0,payMpayStatus:payMpayStatus=0x0}=await this[_0x4aca32(0x1e3)]([_0x4aca32(0x190),_0x4aca32(0x1c7),_0x4aca32(0x152),'payWechatStatus']);if([payHupiStatus,payEpayStatus,payWechatStatus,payMpayStatus][_0x4aca32(0x1d6)](_0x4e01e8=>_0x4e01e8===0x0))throw new common_1[(_0x4aca32(0x165))](_0x4aca32(0x1e9),common_1[_0x4aca32(0x23c)][_0x4aca32(0x239)]);if(Number(payWechatStatus)===0x1)return _0x4cd8f1;if(Number(payEpayStatus)===0x1)return _0x4aca32(0x199);if(Number(payMpayStatus)===0x1)return _0x4aca32(0x188);if(Number(payHupiStatus)===0x1)return _0x4aca32(0x179);}async[_0x2bb4e9(0x18c)](){const _0x489f82=_0x2bb4e9,{siteName:_0x636e1d,qqNumber:_0x3364a1,vxNumber:_0x124c6b,registerBaseUrl:_0x3f7f6a,domain:_0x10dfd7}=await this[_0x489f82(0x1e3)]([_0x489f82(0x218),_0x489f82(0x1b8),_0x489f82(0x1f8),_0x489f82(0x171),_0x489f82(0x231)]);return{'siteName':_0x636e1d,'qqNumber':_0x3364a1,'vxNumber':_0x124c6b,'registerBaseUrl':_0x3f7f6a,'domain':_0x10dfd7};}async['getPhoneVerifyConfig'](){const _0x3ee1b3=_0x2bb4e9,{phoneRegisterStatus:_0x3e8960,aliPhoneAccessKeyId:_0x26c7ab,aliPhoneAccessKeySecret:_0x1babe8,aliPhoneSignName:_0x2d2275,aliPhoneTemplateCode:_0x2e3cca}=await this['getConfigs']([_0x3ee1b3(0x1a1),_0x3ee1b3(0x1c3),_0x3ee1b3(0x1ea),_0x3ee1b3(0x23b),_0x3ee1b3(0x15e)]);if(Number(_0x3e8960)!==0x1)throw new common_1['HttpException'](_0x3ee1b3(0x1ad),common_1['HttpStatus'][_0x3ee1b3(0x239)]);return{'accessKeyId':_0x26c7ab,'accessKeySecret':_0x1babe8,'SignName':_0x2d2275,'TemplateCode':_0x2e3cca};}async[_0x2bb4e9(0x1fc)](){const _0x302ec0=_0x2bb4e9,_0x551365=process['env'][(0x0,utils_1['decrypt'])('JPFq8fAlQE2V2Eq7KWYSxg==')],_0x741379=process['env'][(0x0,utils_1[_0x302ec0(0x1a2)])(_0x302ec0(0x14e))];(!_0x741379||!_0x551365)&&(common_1[_0x302ec0(0x186)][_0x302ec0(0x202)]((0x0,utils_1[_0x302ec0(0x1a2)])(_0x302ec0(0x1b5))),(0x0,actions_1['exit'])());const _0x1fc64f={'authDomain':_0x551365,'authKey':_0x741379},_0x558d25={'method':_0x302ec0(0x185),'headers':{'Content-Type':_0x302ec0(0x14c)},'body':JSON[_0x302ec0(0x22e)](_0x1fc64f)},_0x3f6b21=await fetch(authCheckUrl,_0x558d25)['then'](_0x5f45c6=>{return _0x5f45c6['json']();})[_0x302ec0(0x16c)](_0x1feaf2=>{const _0x564158=_0x302ec0;common_1[_0x564158(0x186)][_0x564158(0x202)](_0x1feaf2,_0x564158(0x1dd));});_0x3f6b21[_0x302ec0(0x14d)]!==0x0&&(common_1['Logger']['error']((0x0,utils_1[_0x302ec0(0x1a2)])(_0x302ec0(0x23d))),(0x0,actions_1[_0x302ec0(0x154)])()),_0x3f6b21?.[_0x302ec0(0x14d)]===0x0&&!_0x3f6b21?.[_0x302ec0(0x204)]?.[_0x302ec0(0x17c)]&&(common_1[_0x302ec0(0x186)][_0x302ec0(0x202)]((0x0,utils_1[_0x302ec0(0x1a2)])('nL4r+L6Sw+2mmD2RZp+C/xu3iXKHIx2CviCHXOzVFdwiUmnj4GGdzXhU1D0zpcN5')),(0x0,actions_1[_0x302ec0(0x154)])());}[_0x2bb4e9(0x22a)](){const _0x2c914e=_0x2bb4e9;return process[_0x2c914e(0x22f)][_0x2c914e(0x19b)]||'GOMAXAI';}async['getSignatureGiftConfig'](){const _0x33dd53=_0x2bb4e9,{signInStatus:signInStatus=0x0,signInModel3Count:signInModel3Count=0x0,signInModel4Count:signInModel4Count=0x0,signInMjDrawToken:signInMjDrawToken=0x0}=await this[_0x33dd53(0x1e3)]([_0x33dd53(0x213),_0x33dd53(0x230),_0x33dd53(0x1ef),_0x33dd53(0x19d)]);if(Number(signInStatus)!==0x1)throw new common_1[(_0x33dd53(0x165))](_0x33dd53(0x184),common_1[_0x33dd53(0x23c)][_0x33dd53(0x239)]);return{'model3Count':Number(signInModel3Count),'model4Count':Number(signInModel4Count),'drawMjCount':Number(signInMjDrawToken)};}async[_0x2bb4e9(0x1cd)](){const _0x35b86f=_0x2bb4e9,{baiduTextStatus:baiduTextStatus=0x0,baiduTextAccessToken:_0xf2969c,nineaiBuiltInSensitiveStatus:nineaiBuiltInSensitiveStatus=0x0,nineaiBuiltInSensitiveApiBase:_0x4a6d29,nineaiBuiltInSensitiveAuthKey:_0x184fdf}=await this[_0x35b86f(0x1e3)]([_0x35b86f(0x1a8),_0x35b86f(0x19f),'nineaiBuiltInSensitiveStatus','nineaiBuiltInSensitiveApiBase',_0x35b86f(0x159)]);if(Number(baiduTextStatus)===0x1)return{'useType':_0x35b86f(0x166),'baiduTextAccessToken':_0xf2969c};if(Number(nineaiBuiltInSensitiveStatus)===0x1)return{'useType':_0x35b86f(0x155),'nineaiBuiltInSensitiveApiBase':_0x4a6d29,'nineaiBuiltInSensitiveAuthKey':_0x184fdf};return null;}async[_0x2bb4e9(0x1da)](_0x5f23e6){const {keys:_0x5c38b7}=_0x5f23e6;if(_0x5c38b7['length']===0x0)return'';return await this['getConfigs'](_0x5c38b7);}async[_0x2bb4e9(0x1a3)](_0x2d5c4f){const _0x390d39=_0x2bb4e9,{settings:_0x4fdcc8}=_0x2d5c4f;if(_0x4fdcc8[_0x390d39(0x1eb)]===0x0)return'';return await this[_0x390d39(0x1f0)](_0x2d5c4f);}async[_0x2bb4e9(0x16e)](_0x5c22c7,_0x278ab4){const _0xf352d1=_0x2bb4e9,_0xe78e79=process[_0xf352d1(0x22f)][(0x0,utils_1['decrypt'])('JPFq8fAlQE2V2Eq7KWYSxg==')],_0x58d62c=process['env'][(0x0,utils_1[_0xf352d1(0x1a2)])(_0xf352d1(0x14e))],_0x199dec=process[_0xf352d1(0x22f)][_0xf352d1(0x20a)];if(!_0xe78e79||!_0x58d62c)throw new common_1[(_0xf352d1(0x165))]((0x0,utils_1[_0xf352d1(0x1a2)])(_0xf352d1(0x1b5)),common_1['HttpStatus']['UNAUTHORIZED']);const {qqNumber:_0x21f81d,vxNumber:_0x56b24a,siteName:_0x5165f1,domain:_0xddc7d7,registerBaseUrl:_0x14d091}=await this[_0xf352d1(0x1e3)]([_0xf352d1(0x1b8),'vxNumber',_0xf352d1(0x218),_0xf352d1(0x231),_0xf352d1(0x171)]),_0x476fbb={'ip':_0xe78e79,'key':_0x58d62c,'port':_0x199dec,'qqNumber':_0x21f81d,'vxNumber':_0x56b24a,'domain':_0xddc7d7,'adminAccount':_0x5c22c7,'adminPass':_0x278ab4,'baseUrl':_0x14d091,'siteName':_0x5165f1,'qq':_0x21f81d,'vxNum':_0x56b24a,'version':AppConfig_1['APP_VERSION']},_0x37d3ed={'method':_0xf352d1(0x185),'headers':{'Content-Type':'application/json'},'body':JSON[_0xf352d1(0x22e)](_0x476fbb)};await fetch(authLogUrl,_0x37d3ed)[_0xf352d1(0x16c)](_0x10f1e5=>{const _0x36ab1d=_0xf352d1;console[_0x36ab1d(0x1be)](_0x36ab1d(0x1d9),_0x10f1e5);});}async[_0x2bb4e9(0x1ff)](_0x38de83){const _0x38adfe=_0x2bb4e9;return this['configEntity'][_0x38adfe(0x1c8)]({'where':{'configKey':_0x38de83}});}async[_0x2bb4e9(0x20b)](){const _0x3f9cdd=_0x2bb4e9,_0x43bc1e=await this[_0x3f9cdd(0x180)][_0x3f9cdd(0x1c8)]({'where':{'configKey':'robotAvatar'}});if(!_0x43bc1e||!_0x43bc1e[_0x3f9cdd(0x1f9)])throw new common_1['HttpException'](_0x3f9cdd(0x222),common_1[_0x3f9cdd(0x23c)]['BAD_GATEWAY']);const _0x642af2=await axios_1[_0x3f9cdd(0x20e)][_0x3f9cdd(0x20c)](_0x43bc1e[_0x3f9cdd(0x1f9)],{'responseType':'arraybuffer'}),_0x581443=Buffer[_0x3f9cdd(0x15a)](_0x642af2[_0x3f9cdd(0x204)])[_0x3f9cdd(0x1ae)](_0x3f9cdd(0x228));return _0x3f9cdd(0x1bd)+_0x581443;}};function _0x18bb(){const _0x15df33=['./../models/models.service','HI1VJtG7Xaak3FfNt271MQ==','ConfigEntity','__decorate','salesAllowDrawMoney','BAD_REQUEST','MjdrawCount','aliPhoneSignName','HttpStatus','bkYMP1mVCBurarEsc48hu4lD0nfoPfj1FccGPRuygRtgPnbJWkkvJGU6zhr/otMF6E7iBQk6kY90kyEI47sVTA==','role','application/json','code','9kxwFUQptTaelrKStrwZQQ==','&secret=','JPFq8fAlQE2V2Eq7KWYSxg==','queryConfig','payMpayStatus','createOrUpdate','exit','nineai','mindDefaultData','4TpGCyv','globalConfigs','nineaiBuiltInSensitiveAuthKey','from','TRUE','user','当前非超级管理员无权操作！','aliPhoneTemplateCode','appMenuHeaderBgUrl','invitedGuestSendModel4Count','openaiBaseUrl','Repository','metadata','includes','HttpException','baidu','forEach','isAutoOpenNotice','map','error_description','clientHomePath','catch','queryPayType','pushLog','__param','../../config/AppConfig','registerBaseUrl','kaifa.qumao518.vip','chatGptKey:','theme','invitedGuestSendModel3Count','setConfigCustom','&type=jsapi','https://api.weixin.qq.com/cgi-bin/ticket/getticket?access_token=','hupi','12593020HyNCXd','fetchBaseAccessToken','check','modelsService','getAllKey','InjectRepository','configEntity','../../common/utils','authorization','ISDEV','签到功能暂未开放!','POST','Logger','ali','mpay','some','save','20PKSWWw','getAuthInfo','initGetAllConfig','lockchatlog','./../chatLog/chatLog.entity','payHupiStatus','update','@nestjs/common','delete','queryNotice','374976BaDpuP','function','design:paramtypes','typeorm','epay','chatGptKey','NAMESPACE','icpUrl','signInMjDrawToken','gomaxAiToken','baiduTextAccessToken','非超级管理员无权操作！','phoneRegisterStatus','decrypt','setTheme','robotAvatar','defineProperty','mjProxy','wechatOfficialAppSecret','baiduTextStatus','&client_secret=','342288EMNZON','inviteGiveSendModel3Count','refresh','手机验证码功能暂未开放!','toString','mjProxyImgUrl','Jo11+muNwqhwlG7g1MeeGzh3NJ4nu4zHbOVgh/hIo0ZDV7rlji6LO/S+cD95Ru8Q','s4C7QVE7wVqqXCy0zhgwIA==','super','getWechatAccessToken','registerSendStatus','nL4r+L6Sw+2mmD2RZp+C/xu3iXKHIx2CviCHXOzVFdwiUmnj4GGdzXhU1D0zpcN5','payWeChatPublicKey','registerSendDrawMjCount','qqNumber','wechatSilentLoginStatus','filingNumber','firstRregisterSendDrawMjCount','firstRegisterSendStatus','data:image/jpeg;base64,','log','设置配置信息错误！','wechatOfficialAppId','reduce','baiduCode','aliPhoneAccessKeyId','baiduTextSecretKey','Key','chatLogEntity','payEpayStatus','findOne','getGoMaxAiToken','设置完成！','inviteSendStatus','JWT_SECRET','getSensitiveConfig','noticeInfo','isUseWxLogin','请输入正确的公告id','OfficialService','headers','隐私内容、非超级管理员无权查看','XKtFTcm2Z0pruYV30WyjOg==','decorate','every','hideString','buyCramiAddress','push\x20log\x20error','getTheme','find','response','global','baiduTextApiKey','Jo11+muNwqhwlG7g1MeeGzh3NJ4nu4zHbOVgh/hIo0bno5L8H6T5QXXNUvLB6d1U','isShowAppCatIcon','registerSendModel3Count','firstRregisterSendModel4Count','getConfigs','tencent','access_token','policeFilingNumber','notice','configKey','支付功能暂未开放!','aliPhoneAccessKeySecret','length','fetchJsapiTicket','firstRregisterSendModel3Count','wechat\x20refresh\x20access_token\x20\x20==>\x20','signInModel4Count','setConfig','bpgLCZ+EOWPxxfPq8W/uxA==','clientFavoIconPath','Like','policeFilingUrl','post','object','queryGptKeys','vxNumber','configVal','FY6xn9g5Q+I2EM+MWwlsFA==','546918UzFLSg','goMaxAiAuth','wechatRegisterStatus','GOMAXAI_HOST','getConfigByKey','88xQaIaK','settings','error','GlobalConfigService','data','@nestjs/cli/actions','checkDomain','copyrightTitle','LY2oE7tW+26CpDCUVao9QQ==','invitedGuestSendDrawMjCount','PORT','robotAvatar2Base64','get','entries','default','inviteGiveSendDrawMjCount','cos','pay','lockmysql','signInStatus','verify','wechatAccessToken','emailRegisterStatus','initBaiduSensitive','siteName','5066215zZMWxn','sTLucdIBCrh8HO8GOSNcPg==','gpt','../../config/MjConfig','clientLogoPath','../../config/WechatConfig','appMenuHeaderTips','https://aip.baidubce.com/oauth/2.0/token?client_id=','百度敏感词初始化失败，如果需要敏感检测、请前往后台系统配置!','未配置\x20robotAvatar.','wechatJsapiTicket','siteRobotName','wechat','getDiffArray','icpNumber','base64','payEpayChannel','getNamespace','registerSendModel4Count','59193tmHtWh','./config.entity','stringify','env','signInModel3Count','domain','ChatLogEntity','158285dGIrGL'];_0x18bb=function(){return _0x15df33;};return _0x18bb();}GlobalConfigService=__decorate([(0x0,common_1['Injectable'])(),__param(0x0,(0x0,typeorm_1[_0x2bb4e9(0x17f)])(config_entity_1[_0x2bb4e9(0x236)])),__param(0x1,(0x0,typeorm_1['InjectRepository'])(chatLog_entity_1[_0x2bb4e9(0x232)])),__metadata(_0x2bb4e9(0x197),[typeorm_2[_0x2bb4e9(0x162)],typeorm_2[_0x2bb4e9(0x162)],models_service_1['ModelsService']])],GlobalConfigService),exports[_0x2bb4e9(0x203)]=GlobalConfigService;