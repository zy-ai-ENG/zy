'use strict';const _0x4a17c5=_0x190a;function _0x190a(_0x5d3bc8,_0x56a364){const _0x5ea1ab=_0x5ea1();return _0x190a=function(_0x190ac9,_0x1f8e23){_0x190ac9=_0x190ac9-0x90;let _0x17d900=_0x5ea1ab[_0x190ac9];return _0x17d900;},_0x190a(_0x5d3bc8,_0x56a364);}(function(_0x37227f,_0x2df44a){const _0x26c657=_0x190a,_0x396a6c=_0x37227f();while(!![]){try{const _0x4785da=parseInt(_0x26c657(0xdf))/0x1*(-parseInt(_0x26c657(0xa4))/0x2)+parseInt(_0x26c657(0xb0))/0x3+parseInt(_0x26c657(0xf2))/0x4*(-parseInt(_0x26c657(0xec))/0x5)+-parseInt(_0x26c657(0x9d))/0x6+parseInt(_0x26c657(0xa6))/0x7+-parseInt(_0x26c657(0xbc))/0x8*(parseInt(_0x26c657(0xb5))/0x9)+-parseInt(_0x26c657(0x92))/0xa;if(_0x4785da===_0x2df44a)break;else _0x396a6c['push'](_0x396a6c['shift']());}catch(_0x1dff11){_0x396a6c['push'](_0x396a6c['shift']());}}}(_0x5ea1,0x32651));var __decorate=this&&this['__decorate']||function(_0x22bfbc,_0x3aea8a,_0x79ca1f,_0x48a502){const _0x5bbfbe=_0x190a;var _0x583121=arguments[_0x5bbfbe(0xf3)],_0xe58b72=_0x583121<0x3?_0x3aea8a:_0x48a502===null?_0x48a502=Object[_0x5bbfbe(0xc0)](_0x3aea8a,_0x79ca1f):_0x48a502,_0x43f325;if(typeof Reflect===_0x5bbfbe(0xba)&&typeof Reflect[_0x5bbfbe(0xa5)]==='function')_0xe58b72=Reflect[_0x5bbfbe(0xa5)](_0x22bfbc,_0x3aea8a,_0x79ca1f,_0x48a502);else{for(var _0x3aad2b=_0x22bfbc[_0x5bbfbe(0xf3)]-0x1;_0x3aad2b>=0x0;_0x3aad2b--)if(_0x43f325=_0x22bfbc[_0x3aad2b])_0xe58b72=(_0x583121<0x3?_0x43f325(_0xe58b72):_0x583121>0x3?_0x43f325(_0x3aea8a,_0x79ca1f,_0xe58b72):_0x43f325(_0x3aea8a,_0x79ca1f))||_0xe58b72;}return _0x583121>0x3&&_0xe58b72&&Object['defineProperty'](_0x3aea8a,_0x79ca1f,_0xe58b72),_0xe58b72;},__metadata=this&&this['__metadata']||function(_0x16a1c3,_0x4cf8fe){const _0x497182=_0x190a;if(typeof Reflect===_0x497182(0xba)&&typeof Reflect[_0x497182(0xe8)]===_0x497182(0x98))return Reflect['metadata'](_0x16a1c3,_0x4cf8fe);},__param=this&&this[_0x4a17c5(0xab)]||function(_0x3010c2,_0x40623c){return function(_0x2c1b4d,_0x1a570b){_0x40623c(_0x2c1b4d,_0x1a570b,_0x3010c2);};};Object[_0x4a17c5(0xed)](exports,_0x4a17c5(0x94),{'value':!![]}),exports[_0x4a17c5(0xf6)]=void 0x0;const common_1=require(_0x4a17c5(0xd7)),swagger_1=require(_0x4a17c5(0xc3)),jwtAuth_guard_1=require(_0x4a17c5(0x93)),official_service_1=require(_0x4a17c5(0xd3)),axios_1=require('axios'),getQrCode_dto_1=require(_0x4a17c5(0xa2)),getQrSceneStr_dto_1=require(_0x4a17c5(0xaa)),Login_vo_1=require(_0x4a17c5(0xc7));let OfficialController=class OfficialController{constructor(_0x9d4244){const _0x59094e=_0x4a17c5;this[_0x59094e(0x96)]=_0x9d4244;}async[_0x4a17c5(0xb8)](_0x698915,_0x5ac393,_0x1e1ec1){const _0x1ffdaa=_0x4a17c5;console[_0x1ffdaa(0xd9)](_0x1ffdaa(0xd8),_0x5ac393,_0x1e1ec1);const _0x2db303=await this[_0x1ffdaa(0x96)]['verify'](_0x5ac393[_0x1ffdaa(0xea)],_0x5ac393['nonce'],_0x5ac393[_0x1ffdaa(0xb2)]);return _0x2db303?_0x5ac393[_0x1ffdaa(0xe6)]:'';}async[_0x4a17c5(0xeb)](_0x47dede,_0x4bff1c,_0x2262e9,_0x25f79b){const _0x49aece=_0x4a17c5,{xml:_0x333de6}=_0x2262e9;console['log'](_0x49aece(0xbf),_0x333de6);const _0x2cc140=process[_0x49aece(0xb6)][_0x49aece(0xd4)];_0x2cc140===_0x49aece(0xe2)&&((0x0,axios_1[_0x49aece(0xa8)])({'url':'https://kaifa.qumao518.vip/api/official/notify','data':_0x2262e9,'method':_0x49aece(0x9a),'headers':{'Content-Type':_0x49aece(0xda)}}),(0x0,axios_1[_0x49aece(0xa8)])({'url':_0x49aece(0xfc),'data':_0x2262e9,'method':_0x49aece(0x9a),'headers':{'Content-Type':_0x49aece(0xda)}}));if(_0x333de6['msgtype'][0x0]==_0x49aece(0xdd)){if(_0x333de6[_0x49aece(0xdd)][0x0]==_0x49aece(0x90)||_0x333de6['event'][0x0]==_0x49aece(0xcb))return _0x25f79b['status'](0xc8)['send']('');if(_0x333de6['event'][0x0]==_0x49aece(0xc4)){console[_0x49aece(0xd9)]('扫码');const _0x1b35c=_0x333de6[_0x49aece(0xcc)][0x0];if(_0x1b35c[_0x49aece(0xd0)]('/')){this[_0x49aece(0x96)][_0x49aece(0xf4)](_0x333de6[_0x49aece(0xd2)][0x0],_0x1b35c);const _0x2516ae=await this['officialService']['genXmlMsgByConfig'](_0x333de6,'officialBindAccountText');return _0x25f79b[_0x49aece(0xdb)](0xc8)[_0x49aece(0x9c)](_0x2516ae);}this[_0x49aece(0x96)][_0x49aece(0xbe)](_0x333de6['fromusername'][0x0],_0x1b35c);const _0x533138=await this[_0x49aece(0x96)][_0x49aece(0xf1)](_0x333de6,_0x49aece(0xe1));return _0x25f79b[_0x49aece(0xdb)](0xc8)[_0x49aece(0x9c)](_0x533138);}if(_0x333de6[_0x49aece(0xdd)][0x0]==_0x49aece(0xac)){console[_0x49aece(0xd9)]('订阅',_0x333de6['eventkey'][0x0]);const _0x3335ff=_0x333de6[_0x49aece(0xcc)][0x0][_0x49aece(0xbb)](_0x49aece(0x95))[0x1];console[_0x49aece(0xd9)](_0x49aece(0xa9),_0x3335ff);if(!_0x3335ff){const _0x1d5ef0=await this[_0x49aece(0x96)][_0x49aece(0xf1)](_0x333de6,'officialSubscribeText');return _0x25f79b[_0x49aece(0xdb)](0xc8)[_0x49aece(0x9c)](_0x1d5ef0);}if(_0x3335ff[_0x49aece(0xd0)]('/')){this[_0x49aece(0x96)][_0x49aece(0xf4)](_0x333de6['fromusername'][0x0],_0x3335ff);const _0x4b7373=await this['officialService'][_0x49aece(0xf1)](_0x333de6,_0x49aece(0xa1));return _0x25f79b[_0x49aece(0xdb)](0xc8)['send'](_0x4b7373);}this[_0x49aece(0x96)][_0x49aece(0xbe)](_0x333de6[_0x49aece(0xd2)][0x0],_0x3335ff);const _0x50c716=await this[_0x49aece(0x96)]['genXmlMsgByConfig'](_0x333de6,_0x49aece(0xb4));return _0x25f79b[_0x49aece(0xdb)](0xc8)[_0x49aece(0x9c)](_0x50c716);}if(_0x333de6[_0x49aece(0xdd)][0x0]==_0x49aece(0xca))return _0x25f79b[_0x49aece(0xdb)](0xc8)[_0x49aece(0x9c)]('');}if(_0x333de6[_0x49aece(0xa3)][0x0]==_0x49aece(0xd1)){console[_0x49aece(0xd9)](_0x49aece(0x9f));const _0x4e920c=await this[_0x49aece(0x96)]['aotoPlay'](_0x333de6[_0x49aece(0xe3)][0x0]),_0x446d5b=await this[_0x49aece(0x96)][_0x49aece(0x101)](_0x333de6,_0x4e920c);return _0x25f79b[_0x49aece(0xdb)](0xc8)[_0x49aece(0x9c)](_0x446d5b);}return _0x49aece(0xef);}async[_0x4a17c5(0xee)](_0x297cb2){const _0x4d787f=_0x4a17c5;return this[_0x4d787f(0x96)][_0x4d787f(0xee)](_0x297cb2);}async[_0x4a17c5(0x97)](_0x517d36){const _0x3fb250=_0x4a17c5;return this[_0x3fb250(0x96)]['getQRSceneStrByBind'](_0x517d36);}async[_0x4a17c5(0xf5)](_0x18a53e){const _0x1e7dae=_0x4a17c5,_0x49e26a=await this['officialService']['getQRCodeTicket'](_0x18a53e[_0x1e7dae(0xc2)]);return common_1[_0x1e7dae(0xb3)]['log'](_0x49e26a,_0x1e7dae(0xd6)),_0x1e7dae(0xc1)+encodeURIComponent(_0x49e26a);}async['loginBySceneStr'](_0x4b53a9,_0x36375c){const _0x46cc68=_0x4a17c5;return this[_0x46cc68(0x96)][_0x46cc68(0xe0)](_0x4b53a9,_0x36375c['sceneStr']);}async[_0x4a17c5(0xfe)](_0x48742e,_0x942f70){const _0x4322b9=_0x4a17c5;return this[_0x4322b9(0x96)]['bindWxBySceneStr'](_0x48742e,_0x942f70[_0x4322b9(0xc2)]);}async[_0x4a17c5(0xfd)](_0x25f796){const _0x4fe109=_0x4a17c5;return this[_0x4fe109(0x96)][_0x4fe109(0xfd)](_0x25f796['url']);}async[_0x4a17c5(0xbd)](_0xecfbc6){const _0x13e626=_0x4a17c5;return this[_0x13e626(0x96)][_0x13e626(0xbd)](_0xecfbc6[_0x13e626(0xe5)]);}async['loginByCode'](_0x41b8b2,_0x3d02cc){const _0x30c232=_0x4a17c5;return this[_0x30c232(0x96)][_0x30c232(0x9b)](_0x41b8b2,_0x3d02cc[_0x30c232(0xcd)]);}async['getAccessToken'](_0x367921,_0x1d0763){const _0x41097d=_0x4a17c5;return this[_0x41097d(0x96)][_0x41097d(0xad)](_0x367921,_0x1d0763);}};function _0x5ea1(){const _0x14b7db=['offical\x20getQRCode','@nestjs/common','get\x20通知>>>','log','application/json','status','获取绑定二维码的sceneStr','event','公众号通知接口GET','71eLPtQZ','loginBySceneStr','officialScanLoginText','gomaxai.qumao518.vip','content','UseGuards','url','echostr','OfficialService','metadata','扫码绑定轮询查询','signature','notifyPost','2545hMXJcP','defineProperty','getQRSceneStr','success','design:returntype','genXmlMsgByConfig','236Zapsxu','length','scanBindWx','getQRCode','OfficialController','GetQrCodeDto','Query','ApiOperation','获取二维码','official','https://ceshi.qumao518.vip/api/official/notify','getRedirectUrl','bindWxBySceneStr','Req','prototype','genXmlMsg','VIEW','type','924350XdDyjh','../../common/auth/jwtAuth.guard','__esModule','qrscene_','officialService','getQRSceneStrByBind','function','design:type','POST','loginByCode','send','1063242QalLzt','Body','客户端发送了文字消息','获取登录跳转地址','officialBindAccountText','./dto/getQrCode.dto','msgtype','926zNpMQP','decorate','2748627fcVjgb','Get','default','sceneStr:\x20','./dto/getQrSceneStr.dto','__param','subscribe','getAccessToken','Res','JwtAuthGuard','1204428wbfVkW','Post','timestamp','Logger','officialSubscribeText','54cTOxyB','env','ApiTags','notify','Controller','object','split','340232lmuvZy','getJsapiTicket','scan','xml:\x20','getOwnPropertyDescriptor','https://mp.weixin.qq.com/cgi-bin/showqrcode?ticket=','sceneStr','@nestjs/swagger','SCAN','公众号通知接口POST','OfficialLoginVO','./vo/Login.vo','获取登录二维码sceneStr','扫码登录轮询查询','unsubscribe','CLICK','eventkey','code','ApiResponse','GetQrSceneStrDto','includes','text','fromusername','./official.service','GOMAXAI_HOST','design:paramtypes'];_0x5ea1=function(){return _0x14b7db;};return _0x5ea1();}__decorate([(0x0,common_1['Get'])(_0x4a17c5(0xb8)),(0x0,swagger_1[_0x4a17c5(0xf9)])({'summary':_0x4a17c5(0xde)}),__param(0x0,(0x0,common_1['Req'])()),__param(0x1,(0x0,common_1[_0x4a17c5(0xf8)])()),__param(0x2,(0x0,common_1[_0x4a17c5(0x9e)])()),__metadata(_0x4a17c5(0x99),Function),__metadata(_0x4a17c5(0xd5),[Object,Object,Object]),__metadata('design:returntype',Promise)],OfficialController['prototype'],'notify',null),__decorate([(0x0,common_1[_0x4a17c5(0xb1)])(_0x4a17c5(0xb8)),(0x0,swagger_1[_0x4a17c5(0xf9)])({'summary':_0x4a17c5(0xc5)}),__param(0x0,(0x0,common_1[_0x4a17c5(0xff)])()),__param(0x1,(0x0,common_1['Query'])()),__param(0x2,(0x0,common_1['Body'])()),__param(0x3,(0x0,common_1[_0x4a17c5(0xae)])()),__metadata(_0x4a17c5(0x99),Function),__metadata(_0x4a17c5(0xd5),[Object,Object,Object,Object]),__metadata('design:returntype',Promise)],OfficialController[_0x4a17c5(0x100)],_0x4a17c5(0xeb),null),__decorate([(0x0,common_1[_0x4a17c5(0xb1)])(_0x4a17c5(0xee)),(0x0,swagger_1[_0x4a17c5(0xf9)])({'summary':_0x4a17c5(0xc8)}),__param(0x0,(0x0,common_1[_0x4a17c5(0x9e)])()),__metadata(_0x4a17c5(0x99),Function),__metadata(_0x4a17c5(0xd5),[getQrSceneStr_dto_1[_0x4a17c5(0xcf)]]),__metadata(_0x4a17c5(0xf0),Promise)],OfficialController[_0x4a17c5(0x100)],_0x4a17c5(0xee),null),__decorate([(0x0,common_1[_0x4a17c5(0xb1)])(_0x4a17c5(0x97)),(0x0,swagger_1[_0x4a17c5(0xf9)])({'summary':_0x4a17c5(0xdc)}),(0x0,common_1[_0x4a17c5(0xe4)])(jwtAuth_guard_1[_0x4a17c5(0xaf)]),__param(0x0,(0x0,common_1[_0x4a17c5(0xff)])()),__metadata(_0x4a17c5(0x99),Function),__metadata('design:paramtypes',[Object]),__metadata(_0x4a17c5(0xf0),Promise)],OfficialController[_0x4a17c5(0x100)],_0x4a17c5(0x97),null),__decorate([(0x0,common_1[_0x4a17c5(0xa7)])(_0x4a17c5(0xf5)),(0x0,swagger_1[_0x4a17c5(0xf9)])({'summary':_0x4a17c5(0xfa)}),__param(0x0,(0x0,common_1[_0x4a17c5(0xf8)])()),__metadata(_0x4a17c5(0x99),Function),__metadata(_0x4a17c5(0xd5),[getQrCode_dto_1[_0x4a17c5(0xf7)]]),__metadata('design:returntype',Promise)],OfficialController[_0x4a17c5(0x100)],_0x4a17c5(0xf5),null),__decorate([(0x0,common_1[_0x4a17c5(0xb1)])('loginBySceneStr'),(0x0,swagger_1[_0x4a17c5(0xf9)])({'summary':_0x4a17c5(0xc9)}),__param(0x0,(0x0,common_1['Req'])()),__param(0x1,(0x0,common_1[_0x4a17c5(0x9e)])()),__metadata(_0x4a17c5(0x99),Function),__metadata(_0x4a17c5(0xd5),[Object,getQrCode_dto_1['GetQrCodeDto']]),__metadata(_0x4a17c5(0xf0),Promise)],OfficialController[_0x4a17c5(0x100)],'loginBySceneStr',null),__decorate([(0x0,common_1[_0x4a17c5(0xb1)])(_0x4a17c5(0xfe)),(0x0,swagger_1[_0x4a17c5(0xf9)])({'summary':_0x4a17c5(0xe9)}),(0x0,common_1['UseGuards'])(jwtAuth_guard_1[_0x4a17c5(0xaf)]),__param(0x0,(0x0,common_1[_0x4a17c5(0xff)])()),__param(0x1,(0x0,common_1[_0x4a17c5(0x9e)])()),__metadata('design:type',Function),__metadata('design:paramtypes',[Object,getQrCode_dto_1[_0x4a17c5(0xf7)]]),__metadata('design:returntype',Promise)],OfficialController['prototype'],_0x4a17c5(0xfe),null),__decorate([(0x0,common_1[_0x4a17c5(0xb1)])(_0x4a17c5(0xfd)),(0x0,swagger_1[_0x4a17c5(0xf9)])({'summary':_0x4a17c5(0xa0)}),__param(0x0,(0x0,common_1[_0x4a17c5(0x9e)])()),__metadata(_0x4a17c5(0x99),Function),__metadata('design:paramtypes',[Object]),__metadata('design:returntype',Promise)],OfficialController['prototype'],_0x4a17c5(0xfd),null),__decorate([(0x0,common_1[_0x4a17c5(0xb1)])('getJsapiTicket'),(0x0,swagger_1[_0x4a17c5(0xf9)])({'summary':'获取注册配置'}),__param(0x0,(0x0,common_1['Body'])()),__metadata('design:type',Function),__metadata(_0x4a17c5(0xd5),[Object]),__metadata(_0x4a17c5(0xf0),Promise)],OfficialController[_0x4a17c5(0x100)],'getJsapiTicket',null),__decorate([(0x0,common_1['Post'])(_0x4a17c5(0x9b)),(0x0,swagger_1[_0x4a17c5(0xf9)])({'summary':'公众号静默登录'}),(0x0,swagger_1[_0x4a17c5(0xce)])({'type':Login_vo_1[_0x4a17c5(0xc6)]}),__param(0x0,(0x0,common_1[_0x4a17c5(0xff)])()),__param(0x1,(0x0,common_1['Body'])()),__metadata('design:type',Function),__metadata('design:paramtypes',[Object,Object]),__metadata(_0x4a17c5(0xf0),Promise)],OfficialController['prototype'],_0x4a17c5(0x9b),null),__decorate([(0x0,common_1['Get'])(_0x4a17c5(0xad)),__param(0x0,(0x0,common_1[_0x4a17c5(0xff)])()),__param(0x1,(0x0,common_1['Query'])(_0x4a17c5(0x91))),__metadata('design:type',Function),__metadata('design:paramtypes',[Object,String]),__metadata('design:returntype',Promise)],OfficialController['prototype'],_0x4a17c5(0xad),null),OfficialController=__decorate([(0x0,swagger_1[_0x4a17c5(0xb7)])(_0x4a17c5(0xfb)),(0x0,common_1[_0x4a17c5(0xb9)])(_0x4a17c5(0xfb)),__metadata('design:paramtypes',[official_service_1[_0x4a17c5(0xe7)]])],OfficialController),exports['OfficialController']=OfficialController;