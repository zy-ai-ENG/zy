'use strict';const _0x2c0186=_0x12b4;(function(_0x4aaba4,_0x3582a4){const _0x89ddb0=_0x12b4,_0x44bd58=_0x4aaba4();while(!![]){try{const _0x47e3f1=parseInt(_0x89ddb0(0x1d8))/0x1*(-parseInt(_0x89ddb0(0x1ff))/0x2)+-parseInt(_0x89ddb0(0x20e))/0x3*(parseInt(_0x89ddb0(0x203))/0x4)+parseInt(_0x89ddb0(0x205))/0x5+-parseInt(_0x89ddb0(0x22f))/0x6+-parseInt(_0x89ddb0(0x1cb))/0x7+parseInt(_0x89ddb0(0x1c6))/0x8+parseInt(_0x89ddb0(0x204))/0x9;if(_0x47e3f1===_0x3582a4)break;else _0x44bd58['push'](_0x44bd58['shift']());}catch(_0x1e5a16){_0x44bd58['push'](_0x44bd58['shift']());}}}(_0x32fd,0x1dcac));function _0x32fd(){const _0x495b40=['delMineApp','getOwnPropertyDescriptor','1458816CfAGQS','updateAppCats','role','./userApps.entity','collect','75845DmpCjU','__esModule','******','findAndCount','appName','count','super','catName','./appCats.entity','log','\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20AND\x20gm.id\x20IS\x20NOT\x20NULL\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20ORDER\x20BY\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20ua.createdAt\x20DESC\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LIMIT\x20','修改App信息成功','message','1847OPNFrw','GptsModelEntity','appCatsEntity','appCount','decorate','appId','catch','@nestjs/typeorm','update','该分类名称已存在！','您正在编辑一个不存在的应用！','AppService','map','gptsModelEntity','__param','InjectRepository','IsNull','affected','length','appDes','groupId','\x0a\x20\x20\x20\x20\x20\x20','findOne','Injectable','HttpStatus','createApp','frontAppList','该分类不存在！','Like','demoData','修改成功','\x20OFFSET\x20','HttpException','BAD_REQUEST','defineProperty','mineApps','query','操作失败！','name','4IqaTie','catId','@nestjs/common','forEach','68LkeZBA','872154JRCmbE','387135khwfXs','find','该应用名称已存在！','appList','delete','createAppCat','includes','AppCatsEntity','mineAppsV3','27057Xwjenz','删除成功','该应用不存在！','已将应用移除我的应用!','user','metadata','save','删除App失败！','该应用已被用户关联使用中，不可删除！','collectCount','__metadata','customApp','connection','preset','appEntity','__decorate','删除应用成功！','MoreThan','AppEntity','coverImg','object','修改失败！','\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20AND\x20gm.id\x20IS\x20NOT\x20NULL\x20\x0a\x20\x20\x20\x20\x20\x20','Not','userAppsEntity','function','typeorm','status','Repository','Logger','您正在操作一个不存在的资源！','已将应用添加到我的应用！','delAppCat','400830sGzicF','删除App成功','该分类下存在App，不可删除！','system','DESC'];_0x32fd=function(){return _0x495b40;};return _0x32fd();}function _0x12b4(_0x37fd32,_0x6fbe8f){const _0x32fd97=_0x32fd();return _0x12b4=function(_0x12b40f,_0x4a20a8){_0x12b40f=_0x12b40f-0x1c5;let _0x12f4fd=_0x32fd97[_0x12b40f];return _0x12f4fd;},_0x12b4(_0x37fd32,_0x6fbe8f);}var __decorate=this&&this[_0x2c0186(0x21d)]||function(_0x548455,_0x300559,_0x107146,_0x3b4301){const _0x456add=_0x2c0186;var _0x5614ae=arguments[_0x456add(0x1ea)],_0x5c1829=_0x5614ae<0x3?_0x300559:_0x3b4301===null?_0x3b4301=Object[_0x456add(0x1c5)](_0x300559,_0x107146):_0x3b4301,_0x4594b2;if(typeof Reflect===_0x456add(0x222)&&typeof Reflect['decorate']===_0x456add(0x227))_0x5c1829=Reflect[_0x456add(0x1dc)](_0x548455,_0x300559,_0x107146,_0x3b4301);else{for(var _0x49a431=_0x548455[_0x456add(0x1ea)]-0x1;_0x49a431>=0x0;_0x49a431--)if(_0x4594b2=_0x548455[_0x49a431])_0x5c1829=(_0x5614ae<0x3?_0x4594b2(_0x5c1829):_0x5614ae>0x3?_0x4594b2(_0x300559,_0x107146,_0x5c1829):_0x4594b2(_0x300559,_0x107146))||_0x5c1829;}return _0x5614ae>0x3&&_0x5c1829&&Object[_0x456add(0x1fa)](_0x300559,_0x107146,_0x5c1829),_0x5c1829;},__metadata=this&&this[_0x2c0186(0x218)]||function(_0x396ed2,_0x313f1d){const _0x1244ed=_0x2c0186;if(typeof Reflect==='object'&&typeof Reflect[_0x1244ed(0x213)]===_0x1244ed(0x227))return Reflect[_0x1244ed(0x213)](_0x396ed2,_0x313f1d);},__param=this&&this[_0x2c0186(0x1e6)]||function(_0x55cc7f,_0x29377f){return function(_0x1d0bda,_0x1a6e84){_0x29377f(_0x1d0bda,_0x1a6e84,_0x55cc7f);};};Object['defineProperty'](exports,_0x2c0186(0x1cc),{'value':!![]}),exports[_0x2c0186(0x1e3)]=void 0x0;const common_1=require(_0x2c0186(0x201)),appCats_entity_1=require(_0x2c0186(0x1d3)),typeorm_1=require(_0x2c0186(0x228)),typeorm_2=require(_0x2c0186(0x1df)),app_entity_1=require('./app.entity'),userApps_entity_1=require(_0x2c0186(0x1c9)),gpts_model_entity_1=require('../gpts/gpts.model.entity');let AppService=class AppService{constructor(_0x239044,_0x3757bb,_0x50d693,_0x9817d9,_0x45751a){const _0x2d450a=_0x2c0186;this[_0x2d450a(0x1da)]=_0x239044,this['appEntity']=_0x3757bb,this[_0x2d450a(0x1e5)]=_0x50d693,this[_0x2d450a(0x226)]=_0x9817d9,this[_0x2d450a(0x21a)]=_0x45751a;}async[_0x2c0186(0x20a)](_0x190bfe){const _0x461975=_0x2c0186,{name:_0x2805a7}=_0x190bfe,_0x74aa3a=await this[_0x461975(0x1da)][_0x461975(0x1ee)]({'where':{'name':_0x2805a7}});if(_0x74aa3a)throw new common_1[(_0x461975(0x1f8))](_0x461975(0x1e1),common_1[_0x461975(0x1f0)][_0x461975(0x1f9)]);return await this[_0x461975(0x1da)][_0x461975(0x214)](_0x190bfe);}async[_0x2c0186(0x22e)](_0x52db4c){const _0x63981c=_0x2c0186,{id:_0x5d99bd}=_0x52db4c,_0x1cb7d2=await this[_0x63981c(0x1da)][_0x63981c(0x1ee)]({'where':{'id':_0x5d99bd}});if(!_0x1cb7d2)throw new common_1['HttpException'](_0x63981c(0x1f3),common_1['HttpStatus'][_0x63981c(0x1f9)]);const _0x3f177c=await this[_0x63981c(0x21c)][_0x63981c(0x1d0)]({'where':{'catId':_0x5d99bd}});if(_0x3f177c>0x0)throw new common_1['HttpException'](_0x63981c(0x231),common_1[_0x63981c(0x1f0)][_0x63981c(0x1f9)]);const _0x35bc87=await this[_0x63981c(0x1da)][_0x63981c(0x209)](_0x5d99bd);if(_0x35bc87['affected']>0x0)return _0x63981c(0x20f);throw new common_1['HttpException']('删除失败！',common_1[_0x63981c(0x1f0)][_0x63981c(0x1f9)]);}async[_0x2c0186(0x1c7)](_0x13d3c0){const _0x300b60=_0x2c0186,{id:_0x3f7112,name:_0x5a1509}=_0x13d3c0,_0x3ac750=await this[_0x300b60(0x1da)][_0x300b60(0x1ee)]({'where':{'name':_0x5a1509,'id':(0x0,typeorm_1['Not'])(_0x3f7112)}});if(_0x3ac750)throw new common_1[(_0x300b60(0x1f8))](_0x300b60(0x1e1),common_1['HttpStatus'][_0x300b60(0x1f9)]);const _0x5c9c03=await this[_0x300b60(0x1da)]['update']({'id':_0x3f7112},_0x13d3c0);if(_0x5c9c03[_0x300b60(0x1e9)]>0x0)return _0x300b60(0x1f6);throw new common_1[(_0x300b60(0x1f8))](_0x300b60(0x223),common_1[_0x300b60(0x1f0)]['BAD_REQUEST']);}async['appCatsList'](_0x3c548a){const _0x4613f5=_0x2c0186,{page:page=0x1,size:size=0xa,name:_0x1698a9,status:_0x10d221}=_0x3c548a,_0x1825da={};_0x1698a9&&(_0x1825da['name']=(0x0,typeorm_1['Like'])('%'+_0x1698a9+'%')),[0x0,0x1,'0','1'][_0x4613f5(0x20b)](_0x10d221)&&(_0x1825da[_0x4613f5(0x229)]=_0x10d221);const [_0x4d1b59,_0x220c7b]=await this[_0x4613f5(0x1da)][_0x4613f5(0x1ce)]({'where':_0x1825da,'order':{'order':_0x4613f5(0x233)},'skip':(page-0x1)*size,'take':size}),_0x5ba290=_0x4d1b59[_0x4613f5(0x1e4)](_0x555cd0=>_0x555cd0['id']),_0x419457=await this[_0x4613f5(0x21c)][_0x4613f5(0x206)]({'where':{'catId':(0x0,typeorm_1['In'])(_0x5ba290)}}),_0x259f00={};return _0x419457[_0x4613f5(0x202)](_0x3cb362=>{const _0x5bcde7=_0x4613f5;_0x259f00[_0x3cb362[_0x5bcde7(0x200)]]?_0x259f00[_0x3cb362[_0x5bcde7(0x200)]]+=0x1:_0x259f00[_0x3cb362[_0x5bcde7(0x200)]]=0x1;}),_0x4d1b59['forEach'](_0x12944a=>_0x12944a[_0x4613f5(0x1db)]=_0x259f00[_0x12944a['id']]||0x0),{'rows':_0x4d1b59,'count':_0x220c7b};}async[_0x2c0186(0x208)](_0x5e14ce,_0x3cf717,_0x405841='id'){const _0x4b0bb6=_0x2c0186;console['log'](_0x3cf717);const {page:page=0x1,size:size=0xa,name:_0x43d313,status:_0xf6bb62,catId:_0xad95db,role:_0x22b93a}=_0x3cf717,_0x47c5ea={};_0x43d313&&(_0x47c5ea['name']=(0x0,typeorm_1[_0x4b0bb6(0x1f4)])('%'+_0x43d313+'%')),_0xad95db&&(_0x47c5ea[_0x4b0bb6(0x200)]=_0xad95db),_0x22b93a&&(_0x47c5ea['role']=_0x22b93a),_0xf6bb62&&(_0x47c5ea[_0x4b0bb6(0x229)]=_0xf6bb62);const [_0x3b6347,_0x227fdb]=await this['appEntity'][_0x4b0bb6(0x1ce)]({'where':_0x47c5ea,'order':{[_0x405841]:_0x4b0bb6(0x233)},'skip':(page-0x1)*size,'take':size}),_0x365a0f=_0x3b6347[_0x4b0bb6(0x1e4)](_0xb4fa7=>_0xb4fa7['catId']),_0x387411=await this[_0x4b0bb6(0x1da)][_0x4b0bb6(0x206)]({'where':{'id':(0x0,typeorm_1['In'])(_0x365a0f)}});return _0x3b6347['forEach'](_0x3c5337=>{const _0x182237=_0x4b0bb6,_0x264920=_0x387411['find'](_0x344b70=>_0x344b70['id']===_0x3c5337['catId']);_0x3c5337['catName']=_0x264920?_0x264920[_0x182237(0x1fe)]:'';}),_0x5e14ce?.[_0x4b0bb6(0x212)]?.['role']!==_0x4b0bb6(0x1d1)&&_0x3b6347[_0x4b0bb6(0x202)](_0x5a82a3=>{delete _0x5a82a3['preset'];}),{'rows':_0x3b6347,'count':_0x227fdb};}async[_0x2c0186(0x1f2)](_0x5014f1,_0x54f23e,_0x143c33='id'){const _0x1ef0ea=_0x2c0186,{page:page=0x1,size:size=0x64,name:_0x30660d,catId:_0x44e6f2,role:_0x4b0ba0}=_0x54f23e,_0x1865a6=[{'status':(0x0,typeorm_1['In'])([0x1,0x4]),'userId':(0x0,typeorm_1[_0x1ef0ea(0x1e8)])(),'public':![]},{'userId':(0x0,typeorm_1[_0x1ef0ea(0x21f)])(0x0),'public':!![]}],[_0x4a484f,_0x1d1b57]=await this[_0x1ef0ea(0x21c)][_0x1ef0ea(0x1ce)]({'where':_0x1865a6,'order':{'order':_0x1ef0ea(0x233)},'skip':(page-0x1)*size,'take':size}),_0x46afb3=_0x4a484f[_0x1ef0ea(0x1e4)](_0x8f6de9=>_0x8f6de9[_0x1ef0ea(0x200)]),_0xc0e017=await this[_0x1ef0ea(0x1da)][_0x1ef0ea(0x206)]({'where':{'id':(0x0,typeorm_1['In'])(_0x46afb3)}});return _0x4a484f[_0x1ef0ea(0x202)](_0x1d26ce=>{const _0xc6c294=_0x1ef0ea,_0x4c6e9d=_0xc0e017[_0xc6c294(0x206)](_0x160285=>_0x160285['id']===_0x1d26ce['catId']);_0x1d26ce[_0xc6c294(0x1d2)]=_0x4c6e9d?_0x4c6e9d[_0xc6c294(0x1fe)]:'';}),_0x5014f1?.[_0x1ef0ea(0x212)]?.[_0x1ef0ea(0x1c8)]!==_0x1ef0ea(0x1d1)&&_0x4a484f[_0x1ef0ea(0x202)](_0x58f310=>{const _0x3091c3=_0x1ef0ea;delete _0x58f310[_0x3091c3(0x21b)];}),{'rows':_0x4a484f,'count':_0x1d1b57};}async[_0x2c0186(0x1f1)](_0x573242){const _0x2a82a0=_0x2c0186,{name:_0x8c902f,catId:_0x2db676}=_0x573242;_0x573242[_0x2a82a0(0x1c8)]=_0x2a82a0(0x232);const _0x15ec8d=await this['appEntity'][_0x2a82a0(0x1ee)]({'where':{'name':_0x8c902f}});if(_0x15ec8d)throw new common_1[(_0x2a82a0(0x1f8))](_0x2a82a0(0x207),common_1['HttpStatus'][_0x2a82a0(0x1f9)]);const _0x236fa2=await this['appCatsEntity']['findOne']({'where':{'id':_0x2db676}});if(!_0x236fa2)throw new common_1['HttpException']('该分类不存在！',common_1[_0x2a82a0(0x1f0)][_0x2a82a0(0x1f9)]);return await this['appEntity']['save'](_0x573242);}async[_0x2c0186(0x219)](_0x162e78,_0x1bd0fb){const _0x599645=_0x2c0186,{id:_0xb1063d}=_0x1bd0fb[_0x599645(0x212)],{name:_0x1f785f,catId:_0x29cd58,des:_0x1d9086,preset:_0x2eb527,coverImg:_0x4466b1,demoData:_0x1b254c,public:_0x345e64,appId:_0x3dcd10}=_0x162e78;if(_0x3dcd10){const _0x471e09=await this[_0x599645(0x21c)][_0x599645(0x1ee)]({'where':{'id':_0x3dcd10,'userId':_0xb1063d}});if(!_0x471e09)throw new common_1[(_0x599645(0x1f8))](_0x599645(0x1e2),common_1[_0x599645(0x1f0)][_0x599645(0x1f9)]);const _0x4e9c2b={'name':_0x1f785f,'catId':_0x29cd58,'des':_0x1d9086,'preset':_0x2eb527,'coverImg':_0x4466b1,'demoData':_0x1b254c,'public':_0x345e64,'status':_0x345e64?0x3:0x1},_0x10facb=await this[_0x599645(0x21c)][_0x599645(0x1e0)]({'id':_0x3dcd10,'userId':_0xb1063d},_0x4e9c2b);if(_0x10facb[_0x599645(0x1e9)])return _0x599645(0x1f6);else throw new common_1[(_0x599645(0x1f8))]('修改失败！',common_1[_0x599645(0x1f0)][_0x599645(0x1f9)]);}if(!_0x3dcd10){const _0x208d4c=await this[_0x599645(0x1da)][_0x599645(0x1ee)]({'where':{'id':_0x29cd58}});if(!_0x208d4c)throw new common_1[(_0x599645(0x1f8))](_0x599645(0x1f3),common_1['HttpStatus'][_0x599645(0x1f9)]);const _0x5d1c4f=await this[_0x599645(0x21c)][_0x599645(0x1ee)]({'where':{'name':_0x1f785f}});if(_0x5d1c4f)throw new common_1[(_0x599645(0x1f8))](_0x599645(0x207),common_1[_0x599645(0x1f0)][_0x599645(0x1f9)]);const _0x484f4f={'name':_0x1f785f,'catId':_0x29cd58,'des':_0x1d9086,'preset':_0x2eb527,'coverImg':_0x4466b1,'status':_0x345e64?0x3:0x1,'demoData':_0x1b254c,'public':_0x345e64,'role':_0x599645(0x212),'userId':_0xb1063d},_0x3ca912=await this[_0x599645(0x21c)][_0x599645(0x214)](_0x484f4f),_0x2e2c6d={'appId':_0x3ca912['id'],'userId':_0xb1063d,'appType':'user','public':_0x345e64,'status':_0x345e64?0x3:0x1,'catId':_0x29cd58};return this[_0x599645(0x226)][_0x599645(0x214)](_0x2e2c6d);}}async['updateApp'](_0x597fd6){const _0x5a7afc=_0x2c0186,{id:_0x57f7f9,name:_0x3286f2,catId:_0x2bbd20,status:_0x144ca2}=_0x597fd6,_0x309446=await this['appEntity'][_0x5a7afc(0x1ee)]({'where':{'name':_0x3286f2,'id':(0x0,typeorm_1[_0x5a7afc(0x225)])(_0x57f7f9)}});if(_0x309446)throw new common_1[(_0x5a7afc(0x1f8))]('该应用名称已存在！',common_1['HttpStatus'][_0x5a7afc(0x1f9)]);const _0x41df57=await this[_0x5a7afc(0x1da)][_0x5a7afc(0x1ee)]({'where':{'id':_0x2bbd20}});if(!_0x41df57)throw new common_1[(_0x5a7afc(0x1f8))](_0x5a7afc(0x1f3),common_1[_0x5a7afc(0x1f0)]['BAD_REQUEST']);const _0x231a41=await this['appEntity']['findOne']({'where':{'id':_0x57f7f9}});_0x231a41[_0x5a7afc(0x229)]!==_0x597fd6['status']&&await this[_0x5a7afc(0x226)][_0x5a7afc(0x1e0)]({'appId':_0x57f7f9},{'status':_0x144ca2});const _0x58596f=await this['appEntity']['update']({'id':_0x57f7f9},_0x597fd6);if(_0x58596f['affected']>0x0)return _0x5a7afc(0x1d6);throw new common_1[(_0x5a7afc(0x1f8))]('修改App信息失败！',common_1[_0x5a7afc(0x1f0)][_0x5a7afc(0x1f9)]);}async['delApp'](_0x1e181f){const _0x2cf024=_0x2c0186,{id:_0x2012e2}=_0x1e181f,_0x2cd765=await this[_0x2cf024(0x21c)][_0x2cf024(0x1ee)]({'where':{'id':_0x2012e2}});if(!_0x2cd765)throw new common_1[(_0x2cf024(0x1f8))](_0x2cf024(0x210),common_1[_0x2cf024(0x1f0)][_0x2cf024(0x1f9)]);const _0x46210f=await this[_0x2cf024(0x226)][_0x2cf024(0x1d0)]({'where':{'appId':_0x2012e2}});if(_0x46210f>0x0)throw new common_1['HttpException'](_0x2cf024(0x216),common_1[_0x2cf024(0x1f0)][_0x2cf024(0x1f9)]);const _0x53b01d=await this[_0x2cf024(0x21c)][_0x2cf024(0x209)](_0x2012e2);if(_0x53b01d['affected']>0x0)return _0x2cf024(0x230);throw new common_1[(_0x2cf024(0x1f8))](_0x2cf024(0x215),common_1['HttpStatus'][_0x2cf024(0x1f9)]);}async['auditPass'](_0x523321){const _0x273df6=_0x2c0186,{id:_0x3d5a9d}=_0x523321,_0x161ca7=await this[_0x273df6(0x21c)][_0x273df6(0x1ee)]({'where':{'id':_0x3d5a9d,'status':0x3}});if(!_0x161ca7)throw new common_1[(_0x273df6(0x1f8))]('该应用不存在！',common_1[_0x273df6(0x1f0)][_0x273df6(0x1f9)]);return await this[_0x273df6(0x21c)]['update']({'id':_0x3d5a9d},{'status':0x4}),await this[_0x273df6(0x226)]['update']({'appId':_0x3d5a9d},{'status':0x4}),'应用审核通过';}async['auditFail'](_0x1674d5){const _0x29b58a=_0x2c0186,{id:_0x3d0467}=_0x1674d5,_0x32fcdd=await this[_0x29b58a(0x21c)][_0x29b58a(0x1ee)]({'where':{'id':_0x3d0467,'status':0x3}});if(!_0x32fcdd)throw new common_1['HttpException'](_0x29b58a(0x210),common_1['HttpStatus']['BAD_REQUEST']);return await this['appEntity'][_0x29b58a(0x1e0)]({'id':_0x3d0467},{'status':0x5}),await this[_0x29b58a(0x226)][_0x29b58a(0x1e0)]({'appId':_0x3d0467},{'status':0x5}),'应用审核拒绝完成';}async[_0x2c0186(0x234)](_0x2f770a,_0x4a0a00){const _0x42ede7=_0x2c0186,{id:_0x3dcd88}=_0x2f770a,_0x702fcf=await this[_0x42ede7(0x21c)][_0x42ede7(0x1ee)]({'where':{'id':_0x3dcd88,'userId':_0x4a0a00['user']['id']}});if(!_0x702fcf)throw new common_1[(_0x42ede7(0x1f8))](_0x42ede7(0x22c),common_1[_0x42ede7(0x1f0)][_0x42ede7(0x1f9)]);return await this[_0x42ede7(0x21c)][_0x42ede7(0x209)](_0x3dcd88),await this[_0x42ede7(0x226)]['delete']({'appId':_0x3dcd88,'userId':_0x4a0a00[_0x42ede7(0x212)]['id']}),_0x42ede7(0x21e);}async[_0x2c0186(0x1ca)](_0x4a8158,_0x2c7587){const _0x170ad3=_0x2c0186,{appId:_0x30bf32}=_0x4a8158,{id:_0xa4f171}=_0x2c7587[_0x170ad3(0x212)];try{const _0x24685c=await this['userAppsEntity'][_0x170ad3(0x1ee)]({'where':{'appId':_0x30bf32,'userId':_0xa4f171}})[_0x170ad3(0x1de)](_0x2bec5b=>{const _0x723cc3=_0x170ad3;common_1[_0x723cc3(0x22b)][_0x723cc3(0x1d4)](_0x2bec5b);});if(_0x24685c){const _0x1ba26a=await this['userAppsEntity'][_0x170ad3(0x209)]({'appId':_0x30bf32,'userId':_0xa4f171})['catch'](_0x2cf311=>{const _0x3f6ca2=_0x170ad3;common_1[_0x3f6ca2(0x22b)][_0x3f6ca2(0x1d4)](_0x2cf311);});if(!_0x1ba26a||_0x1ba26a['affected']<=0x0)throw new common_1[(_0x170ad3(0x1f8))]('取消移除我的应用失败！',common_1['HttpStatus'][_0x170ad3(0x1f9)]);return _0x170ad3(0x211);}const _0x1f036b=await this[_0x170ad3(0x1e5)][_0x170ad3(0x1ee)]({'where':{'id':_0x30bf32}})[_0x170ad3(0x1de)](_0xf68158=>{const _0x429f00=_0x170ad3;common_1['Logger'][_0x429f00(0x1d4)](_0xf68158);});if(!_0x1f036b)throw new common_1[(_0x170ad3(0x1f8))](_0x170ad3(0x1fd),common_1[_0x170ad3(0x1f0)][_0x170ad3(0x1f9)]);const _0x45fe63={'userId':_0xa4f171,'appId':_0x1f036b['id'],'catId':_0x1f036b[_0x170ad3(0x1ec)],'appRole':_0x170ad3(0x232),'public':!![],'status':0x1};return await this['userAppsEntity'][_0x170ad3(0x214)](_0x45fe63)['catch'](_0xb7912f=>{const _0x551165=_0x170ad3;common_1[_0x551165(0x22b)][_0x551165(0x1d4)](_0xb7912f);}),_0x1f036b['collectCount']=_0x1f036b[_0x170ad3(0x217)]+Math['round'](Math['random']()*0xa),await this[_0x170ad3(0x1e5)][_0x170ad3(0x214)](_0x1f036b),_0x170ad3(0x22d);}catch(_0x3362ca){console[_0x170ad3(0x1d4)](_0x3362ca);}}async[_0x2c0186(0x1fb)](_0x5d87f1,_0xbb060b={'page':0x1,'size':0x1e}){const _0x1faefb=_0x2c0186,{id:_0x330149}=_0x5d87f1[_0x1faefb(0x212)],{page:page=0x1,size:size=0x1e}=_0xbb060b,[_0x1c22e2,_0x279a6d]=await this[_0x1faefb(0x226)][_0x1faefb(0x1ce)]({'where':{'userId':_0x330149,'status':(0x0,typeorm_1['In'])([0x1,0x3,0x4,0x5])},'order':{'id':_0x1faefb(0x233)},'skip':(page-0x1)*size,'take':size});if(_0x1c22e2[_0x1faefb(0x1ea)]===0x0)return{'rows':_0x1c22e2,'count':_0x279a6d};const _0x30b4f0=_0x1c22e2[_0x1faefb(0x1e4)](_0x55e614=>_0x55e614[_0x1faefb(0x1dd)]),_0x17852f=await this[_0x1faefb(0x21c)][_0x1faefb(0x206)]({'where':{'id':(0x0,typeorm_1['In'])(_0x30b4f0)}});return _0x1c22e2[_0x1faefb(0x202)](_0x4aeb71=>{const _0x1f2a0f=_0x1faefb,_0x58dac=_0x17852f[_0x1f2a0f(0x206)](_0x3a95d3=>_0x3a95d3['id']===_0x4aeb71[_0x1f2a0f(0x1dd)]);_0x58dac&&(_0x4aeb71[_0x1f2a0f(0x1cf)]=_0x58dac[_0x1f2a0f(0x1fe)]||'',_0x4aeb71[_0x1f2a0f(0x1eb)]=_0x58dac['des']||'',_0x4aeb71['coverImg']=_0x58dac[_0x1f2a0f(0x221)]||'',_0x4aeb71[_0x1f2a0f(0x1f5)]=_0x58dac['demoData']||'',_0x4aeb71['appRole']=_0x58dac[_0x1f2a0f(0x1c8)]||'',_0x4aeb71[_0x1f2a0f(0x21b)]=_0x58dac['userId']===_0x330149?_0x58dac[_0x1f2a0f(0x21b)]:_0x1f2a0f(0x1cd));}),{'rows':_0x1c22e2,'count':_0x279a6d};}async[_0x2c0186(0x20d)](_0x46f09e,_0x520955={'page':0x1,'size':0x1e}){const _0x47f08b=_0x2c0186,{id:_0x336e7b}=_0x46f09e[_0x47f08b(0x212)],{page:page=0x1,size:size=0x1e}=_0x520955;try{const _0x433e4a=await this[_0x47f08b(0x21a)][_0x47f08b(0x1fc)]('\x0a\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20COUNT(*)\x20as\x20count\x0a\x20\x20\x20\x20\x20\x20\x20\x20FROM\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20user_apps\x20ua\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20gpts_models\x20gm\x20ON\x20ua.appId\x20=\x20gm.id\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20gpts_group\x20gg\x20ON\x20gm.groupId\x20=\x20gg.id\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20ua.userId\x20=\x20'+_0x336e7b+_0x47f08b(0x224)),_0x590070=await this['connection'][_0x47f08b(0x1fc)]('\x0a\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20gm.*,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20gg.groupName,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20ua.createdAt\x20AS\x20collectTime\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20FROM\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20user_apps\x20ua\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20gpts_models\x20gm\x20ON\x20ua.appId\x20=\x20gm.id\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20gpts_group\x20gg\x20ON\x20gm.groupId\x20=\x20gg.id\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20ua.userId\x20=\x20'+_0x336e7b+_0x47f08b(0x1d5)+size+_0x47f08b(0x1f7)+(page-0x1)*size+_0x47f08b(0x1ed));return{'rows':_0x590070,'count':Number(_0x433e4a[0x0]?.['count']||0x0)};}catch(_0x42a06c){console[_0x47f08b(0x1d4)](_0x42a06c[_0x47f08b(0x1d7)]);}}};AppService=__decorate([(0x0,common_1[_0x2c0186(0x1ef)])(),__param(0x0,(0x0,typeorm_2[_0x2c0186(0x1e7)])(appCats_entity_1[_0x2c0186(0x20c)])),__param(0x1,(0x0,typeorm_2[_0x2c0186(0x1e7)])(app_entity_1[_0x2c0186(0x220)])),__param(0x2,(0x0,typeorm_2[_0x2c0186(0x1e7)])(gpts_model_entity_1[_0x2c0186(0x1d9)])),__param(0x3,(0x0,typeorm_2[_0x2c0186(0x1e7)])(userApps_entity_1['UserAppsEntity'])),__metadata('design:paramtypes',[typeorm_1[_0x2c0186(0x22a)],typeorm_1[_0x2c0186(0x22a)],typeorm_1[_0x2c0186(0x22a)],typeorm_1[_0x2c0186(0x22a)],typeorm_1['Connection']])],AppService),exports[_0x2c0186(0x1e3)]=AppService;