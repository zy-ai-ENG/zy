'use strict';const _0x355248=_0x2595;(function(_0x1eb6dc,_0x46f515){const _0x471216=_0x2595,_0x2829f9=_0x1eb6dc();while(!![]){try{const _0x7f2ab0=parseInt(_0x471216(0x1dd))/0x1+-parseInt(_0x471216(0x1db))/0x2+parseInt(_0x471216(0x1df))/0x3+parseInt(_0x471216(0x1f2))/0x4+parseInt(_0x471216(0x1f7))/0x5*(-parseInt(_0x471216(0x1e8))/0x6)+-parseInt(_0x471216(0x1c3))/0x7*(-parseInt(_0x471216(0x1d1))/0x8)+-parseInt(_0x471216(0x1be))/0x9*(parseInt(_0x471216(0x1c9))/0xa);if(_0x7f2ab0===_0x46f515)break;else _0x2829f9['push'](_0x2829f9['shift']());}catch(_0x3dc1f9){_0x2829f9['push'](_0x2829f9['shift']());}}}(_0x1193,0xe21ee));var __decorate=this&&this[_0x355248(0x1ef)]||function(_0x1dd365,_0x477eb6,_0x43013b,_0x342828){const _0x2d3b01=_0x355248;var _0x373ff0=arguments[_0x2d3b01(0x1c0)],_0x1ceec2=_0x373ff0<0x3?_0x477eb6:_0x342828===null?_0x342828=Object[_0x2d3b01(0x1d5)](_0x477eb6,_0x43013b):_0x342828,_0x256a48;if(typeof Reflect==='object'&&typeof Reflect[_0x2d3b01(0x1cb)]===_0x2d3b01(0x1bf))_0x1ceec2=Reflect[_0x2d3b01(0x1cb)](_0x1dd365,_0x477eb6,_0x43013b,_0x342828);else{for(var _0x1a3e66=_0x1dd365[_0x2d3b01(0x1c0)]-0x1;_0x1a3e66>=0x0;_0x1a3e66--)if(_0x256a48=_0x1dd365[_0x1a3e66])_0x1ceec2=(_0x373ff0<0x3?_0x256a48(_0x1ceec2):_0x373ff0>0x3?_0x256a48(_0x477eb6,_0x43013b,_0x1ceec2):_0x256a48(_0x477eb6,_0x43013b))||_0x1ceec2;}return _0x373ff0>0x3&&_0x1ceec2&&Object[_0x2d3b01(0x1f3)](_0x477eb6,_0x43013b,_0x1ceec2),_0x1ceec2;},__metadata=this&&this[_0x355248(0x1d6)]||function(_0x528ad9,_0x489943){const _0x4bb79a=_0x355248;if(typeof Reflect===_0x4bb79a(0x1ec)&&typeof Reflect[_0x4bb79a(0x1d4)]===_0x4bb79a(0x1bf))return Reflect[_0x4bb79a(0x1d4)](_0x528ad9,_0x489943);};Object[_0x355248(0x1f3)](exports,_0x355248(0x1eb),{'value':!![]}),exports[_0x355248(0x1c5)]=void 0x0;function _0x2595(_0x3d97b1,_0x22ae8c){const _0x119347=_0x1193();return _0x2595=function(_0x259509,_0x404821){_0x259509=_0x259509-0x1b7;let _0x3bbd18=_0x119347[_0x259509];return _0x3bbd18;},_0x2595(_0x3d97b1,_0x22ae8c);}const redisCache_service_1=require('../../modules/redisCache/redisCache.service'),common_1=require('@nestjs/common'),passport_1=require(_0x355248(0x1ce)),jwt=require(_0x355248(0x1b7)),core_1=require(_0x355248(0x1ba)),globalConfig_service_1=require(_0x355248(0x1e5)),utils_1=require(_0x355248(0x1bb)),auth_service_1=require(_0x355248(0x1c8));function _0x1193(){const _0x50f761=['authorization','jsonwebtoken','extractToken','user','@nestjs/core','../utils','getGoMaxAiToken','copyRightMsg','995769BVGpJd','function','length','authService','HttpStatus','45143WqeBCF','verify','JwtAuthGuard','toString','BAD_REQUEST','../../modules/auth/auth.service','10iCtoay','ModuleRef','decorate','jwt','design:paramtypes','@nestjs/passport','includes','split','552iJsguv','Injectable','err:\x20','metadata','getOwnPropertyDescriptor','__metadata','RedisCacheService','slice','redisCacheService','globalConfigService','795820CUZCbu','AuthGuard','438884YoNCWX','headers','182667InzTBQ','log','handleRequest','validateToken','env','UNAUTHORIZED','../../modules/globalConfig/globalConfig.service','checkTokenAuth','HttpException','2319810brJFKH','role','getRandomItemFromArray','__esModule','object','JWT_SECRET','GlobalConfigService','__decorate','decrypt','moduleRef','3506488YvxuTt','defineProperty','fingerprint','path','id:\x20','5MZamQl','get'];_0x1193=function(){return _0x50f761;};return _0x1193();}let JwtAuthGuard=class JwtAuthGuard extends(0x0,passport_1[_0x355248(0x1dc)])(_0x355248(0x1cc)){constructor(_0x992d26,_0x11f0cf,_0x1370cd,_0x5a6e1a){const _0x5dc056=_0x355248;super(),this[_0x5dc056(0x1d9)]=_0x992d26,this[_0x5dc056(0x1f1)]=_0x11f0cf,this[_0x5dc056(0x1da)]=_0x1370cd,this[_0x5dc056(0x1c1)]=_0x5a6e1a;}async['canActivate'](_0x1f0e60){const _0xf6559b=_0x355248;let _0x436f5b=![];!this['redisCacheService']&&(this[_0xf6559b(0x1d9)]=this[_0xf6559b(0x1f1)][_0xf6559b(0x1f8)](redisCache_service_1['RedisCacheService'],{'strict':![]}));const _0x4fa867=_0x1f0e60['switchToHttp']()['getRequest'](),_0x5e4a18=this[_0xf6559b(0x1b8)](_0x4fa867);_0x4fa867[_0xf6559b(0x1b9)]=this[_0xf6559b(0x1e2)](_0x5e4a18);if(_0x4fa867[_0xf6559b(0x1b9)][_0xf6559b(0x1e9)]==='visitor')throw new common_1[(_0xf6559b(0x1e7))]('亲爱的用户,请登录后继续操作,我们正在等您的到来！',common_1[_0xf6559b(0x1c2)][_0xf6559b(0x1e4)]);const _0x3672ec=this[_0xf6559b(0x1da)][_0xf6559b(0x1bc)]();if(_0x3672ec&&!_0x4fa867[_0xf6559b(0x1f5)][_0xf6559b(0x1cf)]('getInfo')){const _0x3c9497=(0x0,utils_1[_0xf6559b(0x1ea)])(utils_1[_0xf6559b(0x1bd)]);throw new common_1[(_0xf6559b(0x1e7))]((0x0,utils_1[_0xf6559b(0x1f0)])(_0x3c9497),common_1['HttpStatus'][_0xf6559b(0x1c7)]);}else _0x436f5b=!![];return!_0x436f5b&&process['exit'](0x1),await this['redisCacheService'][_0xf6559b(0x1e6)](_0x5e4a18,_0x4fa867),!![];}[_0x355248(0x1b8)](_0x3be220){const _0x5b9e8d=_0x355248;if(!_0x3be220[_0x5b9e8d(0x1de)]['authorization']){if(_0x3be220[_0x5b9e8d(0x1de)]['fingerprint']){let _0x57863c=_0x3be220[_0x5b9e8d(0x1de)][_0x5b9e8d(0x1f4)];return _0x57863c>0x7fffffff&&(_0x57863c=_0x57863c[_0x5b9e8d(0x1c6)]()[_0x5b9e8d(0x1d8)](-0x9),_0x57863c=Number(String(Number(_0x57863c))),console[_0x5b9e8d(0x1e0)](_0x5b9e8d(0x1f6),_0x57863c)),this[_0x5b9e8d(0x1c1)]['createTokenFromFingerprint'](_0x57863c);}return null;}const _0x4cf3f2=_0x3be220[_0x5b9e8d(0x1de)][_0x5b9e8d(0x1f9)][_0x5b9e8d(0x1d0)]('\x20');if(_0x4cf3f2[_0x5b9e8d(0x1c0)]!==0x2||_0x4cf3f2[0x0]!=='Bearer')return null;return _0x4cf3f2[0x1];}[_0x355248(0x1e2)](_0x1a41b5){const _0x5ceb4f=_0x355248;try{return jwt[_0x5ceb4f(0x1c4)](_0x1a41b5,process[_0x5ceb4f(0x1e3)][_0x5ceb4f(0x1ed)]);}catch(_0x450c04){throw new common_1[(_0x5ceb4f(0x1e7))]('亲爱的用户,请登录后继续操作,我们正在等您的到来！',common_1['HttpStatus'][_0x5ceb4f(0x1e4)]);}}[_0x355248(0x1e1)](_0x3eba79,_0x516e14,_0x17fd23){const _0x12d856=_0x355248;if(_0x3eba79||!_0x516e14){console[_0x12d856(0x1e0)](_0x12d856(0x1d3),_0x3eba79);throw _0x3eba79||new common_1['UnauthorizedException']();}return _0x516e14;}};JwtAuthGuard=__decorate([(0x0,common_1[_0x355248(0x1d2)])(),__metadata(_0x355248(0x1cd),[redisCache_service_1[_0x355248(0x1d7)],core_1[_0x355248(0x1ca)],globalConfig_service_1[_0x355248(0x1ee)],auth_service_1['AuthService']])],JwtAuthGuard),exports[_0x355248(0x1c5)]=JwtAuthGuard;